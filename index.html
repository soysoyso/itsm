<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ITSM - IT Service Management</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Apple SD Gothic Neo', sans-serif;
        }
        
        /* Status Badges */
        .status-badge {
            display: inline-flex;
            align-items: center;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            letter-spacing: -0.3px;
        }
        .status-ìš”ì²­ { background: #FEF3C7; color: #92400E; }
        .status-ì ‘ìˆ˜ { background: #DBEAFE; color: #1E40AF; }
        .status-ê²¬ì í™•ì¸ { background: #CFFAFE; color: #155E75; }
        .status-ìŠ¹ì¸ëŒ€ê¸° { background: #CCFBF1; color: #115E59; }
        .status-ì²˜ë¦¬ì¤‘ { background: #E0E7FF; color: #4338CA; }
        .status-ì¬ê²€ìˆ˜ì¤‘ { background: #FCE7F3; color: #9F1239; }
        .status-ê²€ìˆ˜ëŒ€ê¸°,
        .status-ê²€ìˆ˜\ ëŒ€ê¸° { background: #F3E8FF; color: #6B21A8; }
        .status-ì™„ë£Œ { background: #D1FAE5; color: #065F46; }
        .status-ë³´ë¥˜ { background: #FEE2E2; color: #991B1B; }
        .status-ë°˜ë ¤ { background: #F3F4F6; color: #374151; }
        .status-ì·¨ì†Œ { background: #FEE2E2; color: #7F1D1D; }
        
        /* Priority */
        .priority-high { color: #DC2626; }
        .priority-medium { color: #F59E0B; }
        .priority-low { color: #6B7280; }
        
        /* Tabs */
        .nav-tab {
            padding: 12px 24px;
            border-bottom: 3px solid transparent;
            cursor: pointer;
            transition: all 0.2s;
            font-weight: 500;
            color: #6B7280;
        }
        .nav-tab:hover {
            color: #3B82F6;
            background: #F3F4F6;
        }
        .nav-tab.active {
            border-bottom-color: #3B82F6;
            color: #3B82F6;
        }
        
        /* User Role Toggle */
        .role-toggle {
            background: #F3F4F6;
            border-radius: 12px;
            padding: 4px;
            display: inline-flex;
        }
        .role-btn {
            padding: 8px 20px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            font-weight: 600;
            font-size: 14px;
        }
        .role-btn.active {
            background: white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            color: #3B82F6;
        }
        
        /* Table Styles */
        .data-table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
        }
        .data-table thead {
            background: #F9FAFB;
            position: sticky;
            top: 0;
            z-index: 10;
        }
        .data-table th {
            padding: 12px 16px;
            text-align: left;
            font-weight: 600;
            font-size: 13px;
            color: #374151;
            border-bottom: 2px solid #E5E7EB;
        }
        .data-table td {
            padding: 14px 16px;
            border-bottom: 1px solid #F3F4F6;
            font-size: 14px;
        }
        .data-table tbody tr {
            transition: all 0.15s;
            cursor: pointer;
        }
        .data-table tbody tr:hover {
            background: #F9FAFB;
        }
        
        /* Gantt Chart */
        .gantt-container {
            overflow-x: auto;
            position: relative;
        }
        .gantt-row {
            display: flex;
            border-bottom: 1px solid #E5E7EB;
            min-height: 48px;
            align-items: center;
        }
        .gantt-label {
            width: 280px;
            min-width: 280px;
            padding: 12px;
            border-right: 2px solid #E5E7EB;
            background: #FAFAFA;
            font-weight: 500;
        }
        .gantt-timeline {
            flex: 1;
            position: relative;
            min-height: 48px;
            display: flex;
            align-items: center;
            background: white;
        }
        .gantt-bar {
            position: absolute;
            height: 28px;
            border-radius: 6px;
            display: flex;
            align-items: center;
            padding: 0 12px;
            font-size: 12px;
            font-weight: 600;
            color: white;
            cursor: pointer;
            transition: all 0.2s;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .gantt-bar:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        .gantt-bar-main {
            background: linear-gradient(135deg, #667EEA 0%, #764BA2 100%);
            position: relative;
        }
        .gantt-bar-main:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(102, 126, 234, 0.4);
            z-index: 20;
        }
        .gantt-bar-sub {
            background: linear-gradient(135deg, #F093FB 0%, #F5576C 100%);
            height: 24px;
        }
        .gantt-bar-assignee {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            font-size: 12px;
            font-weight: 600;
            box-shadow: 0 2px 8px rgba(240, 147, 251, 0.3);
            border: 2px solid rgba(255, 255, 255, 0.5);
            height: 32px;
        }
        .gantt-today {
            position: absolute;
            top: 0;
            bottom: 0;
            width: 2px;
            background: #EF4444;
            z-index: 5;
        }
        .gantt-date-cell {
            min-width: 60px;
            padding: 8px 4px;
            text-align: center;
            font-size: 11px;
            border-right: 1px solid #F3F4F6;
        }
        
        /* Kanban Board */
        .kanban-column {
            background: #F9FAFB;
            border-radius: 12px;
            padding: 16px;
            min-width: 280px;
            max-width: 320px;
        }
        .kanban-card {
            background: white;
            border-radius: 8px;
            padding: 16px;
            margin-bottom: 12px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            cursor: pointer;
            transition: all 0.2s;
        }
        .kanban-card:hover {
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            transform: translateY(-2px);
        }
        
        /* Modal */
        .modal {
            display: none;
            position: fixed;
            z-index: 50;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            backdrop-filter: blur(4px);
        }
        .modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        /* Animations */
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        .animate-slide-in {
            animation: slideIn 0.3s ease-out;
        }
        
        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #F3F4F6;
        }
        ::-webkit-scrollbar-thumb {
            background: #D1D5DB;
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #9CA3AF;
        }
        
        /* Collapse */
        .collapsible-icon {
            transition: transform 0.2s;
            display: inline-block;
        }
        .collapsible-icon.collapsed {
            transform: rotate(-90deg);
        }
        .collapsed-content {
            display: none;
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Login Screen -->
    <div id="loginScreen" class="min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-500 via-purple-500 to-pink-500 p-4">
        <div class="bg-white rounded-2xl shadow-2xl max-w-md w-full p-8 animate-slide-in">
            <div class="text-center mb-8">
                <div class="w-20 h-20 bg-gradient-to-br from-blue-500 to-purple-600 rounded-2xl flex items-center justify-center mx-auto mb-4">
                    <i class="fas fa-ticket-alt text-white text-4xl"></i>
                </div>
                <h1 class="text-3xl font-bold text-gray-800 mb-2">ITSM</h1>
                <p class="text-gray-600">IT Service Management</p>
            </div>
            
            <form id="loginForm" onsubmit="handleLogin(event); return false;">
                <div class="space-y-4 mb-6">
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">ì•„ì´ë””</label>
                        <input type="text" id="loginId" name="loginId" required 
                            class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                            placeholder="ì•„ì´ë””ë¥¼ ì…ë ¥í•˜ì„¸ìš”">
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">ë¹„ë°€ë²ˆí˜¸</label>
                        <input type="password" id="loginPassword" name="password" required 
                            class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                            placeholder="ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”">
                    </div>
                </div>
                
                <button type="submit" class="w-full bg-gradient-to-r from-blue-600 to-purple-600 text-white py-3 rounded-lg hover:from-blue-700 hover:to-purple-700 transition font-semibold shadow-lg mb-4">
                    <i class="fas fa-sign-in-alt mr-2"></i>ë¡œê·¸ì¸
                </button>
                
                <!-- ë¹ ë¥¸ ë¡œê·¸ì¸ ë²„íŠ¼ ğŸ†• -->
                <div class="grid grid-cols-3 gap-2 mb-6">
                    <button type="button" onclick="quickLogin('user')" class="bg-gray-100 hover:bg-gray-200 text-gray-700 py-2 rounded-lg transition text-sm">
                        <i class="fas fa-user mr-1"></i>ì‚¬ìš©ì
                    </button>
                    <button type="button" onclick="quickLogin('master')" class="bg-purple-100 hover:bg-purple-200 text-purple-700 py-2 rounded-lg transition text-sm font-bold">
                        <i class="fas fa-crown mr-1"></i>ë§ˆìŠ¤í„°
                    </button>
                    <button type="button" onclick="quickLogin('admin')" class="bg-blue-100 hover:bg-blue-200 text-blue-700 py-2 rounded-lg transition text-sm">
                        <i class="fas fa-user-cog mr-1"></i>ì‹¤ë¬´ì
                    </button>
                </div>
                
                <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                    <p class="text-sm text-blue-800 font-semibold mb-2">
                        <i class="fas fa-info-circle mr-2"></i>ë°ëª¨ ê³„ì •
                    </p>
                    <div class="text-sm text-blue-700 space-y-1 mb-3">
                        <p>â€¢ ì¼ë°˜ ì‚¬ìš©ì: <code class="bg-blue-100 px-2 py-1 rounded">user / user123</code></p>
                        <p>â€¢ IT ë§ˆìŠ¤í„°: <code class="bg-purple-100 px-2 py-1 rounded text-purple-700 font-bold">master / master123</code></p>
                        <p>â€¢ IT ì‹¤ë¬´ì: <code class="bg-blue-100 px-2 py-1 rounded">admin / admin123</code></p>
                    </div>
                    <div class="border-t border-blue-200 pt-3 mt-3">
                        <p class="text-xs text-gray-600">
                            <i class="fas fa-crown text-purple-600 mr-1"></i>ë§ˆìŠ¤í„°: ìš”ì²­ ìŠ¹ì¸ ê¶Œí•œ<br>
                            <i class="fas fa-user-cog text-blue-600 mr-1"></i>ì‹¤ë¬´ì: ìŠ¹ì¸ëœ ìš”ì²­ ì²˜ë¦¬
                        </p>
                    </div>
                </div>
            </form>
        </div>
    </div>

    <!-- Main Application (hidden by default) -->
    <div id="mainApp" class="hidden">
    <!-- Header -->
    <header class="bg-white shadow-sm border-b sticky top-0 z-40">
        <div class="max-w-[1600px] mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <div class="flex items-center space-x-3">
                        <div class="w-10 h-10 bg-gradient-to-br from-blue-500 to-purple-600 rounded-lg flex items-center justify-center">
                            <i class="fas fa-ticket-alt text-white text-lg"></i>
                        </div>
                        <div>
                            <h1 class="text-xl font-bold text-gray-800">ITSM</h1>
                            <p class="text-xs text-gray-500">IT Service Management</p>
                        </div>
                    </div>
                    
                    <!-- Role Toggle -->
                    <div class="role-toggle ml-8">
                        <button class="role-btn active" id="user-role-btn" onclick="switchRole('user')">
                            <i class="fas fa-user mr-2"></i>ì‹ ì²­ì
                        </button>
                        <button class="role-btn" id="admin-role-btn" onclick="switchRole('admin')">
                            <i class="fas fa-user-shield mr-2"></i>ITíŒ€
                        </button>
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="text-right">
                        <p class="text-sm font-semibold text-gray-800" id="current-user-name">í™ê¸¸ë™</p>
                        <p class="text-xs text-gray-500" id="current-user-role">ìš´ì˜íŒ€</p>
                    </div>
                    <button onclick="generateBulkDemoTickets()" class="bg-gradient-to-r from-purple-600 to-pink-600 text-white px-4 py-2 rounded-lg hover:from-purple-700 hover:to-pink-700 transition font-semibold shadow-md text-sm" title="ì‹œì—°ìš© í‹°ì¼“ 5ê°œ ìë™ ìƒì„±">
                        <i class="fas fa-magic mr-2"></i>ë°ëª¨ í‹°ì¼“ ìƒì„±
                    </button>
                    <button class="bg-gradient-to-r from-blue-600 to-purple-600 text-white px-5 py-2.5 rounded-lg hover:from-blue-700 hover:to-purple-700 transition font-semibold shadow-md" onclick="openNewTicketModal()">
                        <i class="fas fa-plus mr-2"></i>ìƒˆ í‹°ì¼“ ìš”ì²­
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- User View (ì‹ ì²­ì í™”ë©´) -->
    <div id="user-view" class="max-w-[1600px] mx-auto px-6 py-6">
        <!-- Stats Cards -->
        <div class="grid grid-cols-5 gap-4 mb-6">
            <div class="bg-white rounded-xl shadow-sm border p-5">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-sm text-gray-500 mb-1">ì „ì²´ ìš”ì²­</p>
                        <p class="text-2xl font-bold text-gray-800" id="user-stat-total">0</p>
                    </div>
                    <div class="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center">
                        <i class="fas fa-clipboard-list text-blue-600"></i>
                    </div>
                </div>
            </div>
            <div class="bg-white rounded-xl shadow-sm border p-5">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-sm text-gray-500 mb-1">ì ‘ìˆ˜ ëŒ€ê¸°</p>
                        <p class="text-2xl font-bold text-yellow-600" id="user-stat-pending">0</p>
                    </div>
                    <div class="w-12 h-12 bg-yellow-100 rounded-full flex items-center justify-center">
                        <i class="fas fa-clock text-yellow-600"></i>
                    </div>
                </div>
            </div>
            <div class="bg-white rounded-xl shadow-sm border p-5">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-sm text-gray-500 mb-1">ì²˜ë¦¬ ì¤‘</p>
                        <p class="text-2xl font-bold text-blue-600" id="user-stat-processing">0</p>
                    </div>
                    <div class="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center">
                        <i class="fas fa-spinner text-blue-600"></i>
                    </div>
                </div>
            </div>
            <div class="bg-white rounded-xl shadow-sm border p-5">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-sm text-gray-500 mb-1">ì™„ë£Œ</p>
                        <p class="text-2xl font-bold text-green-600" id="user-stat-completed">0</p>
                    </div>
                    <div class="w-12 h-12 bg-green-100 rounded-full flex items-center justify-center">
                        <i class="fas fa-check-circle text-green-600"></i>
                    </div>
                </div>
            </div>
            <div class="bg-white rounded-xl shadow-sm border p-5">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-sm text-gray-500 mb-1">ë³´ë¥˜/ë°˜ë ¤</p>
                        <p class="text-2xl font-bold text-red-600" id="user-stat-hold">0</p>
                    </div>
                    <div class="w-12 h-12 bg-red-100 rounded-full flex items-center justify-center">
                        <i class="fas fa-pause-circle text-red-600"></i>
                    </div>
                </div>
            </div>
        </div>

        <!-- ì„œë¹„ìŠ¤ ìš”ì²­ (Service Request Cards) ğŸ†• -->
        <div class="mb-8">
            <div class="flex items-center justify-between mb-4">
                <h2 class="text-xl font-bold text-gray-800">
                    <i class="fas fa-th-large text-indigo-500 mr-2"></i>ì„œë¹„ìŠ¤ ìš”ì²­
                </h2>
                <p class="text-sm text-gray-600">ì‹œìŠ¤í…œì„ ì„ íƒí•˜ê³  ìš”ì²­í•˜ì„¸ìš”</p>
            </div>
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                <!-- ì˜¤ì•„ì‹œìŠ¤ -->
                <div onclick="openCategoryModal('ì˜¤ì•„ì‹œìŠ¤')" class="bg-gradient-to-br from-blue-50 to-blue-100 border-2 border-blue-200 rounded-xl p-6 cursor-pointer hover:shadow-lg hover:scale-105 transition-all duration-200 group">
                    <div class="flex items-start justify-between mb-3">
                        <div class="w-12 h-12 bg-blue-500 rounded-lg flex items-center justify-center group-hover:scale-110 transition">
                            <i class="fas fa-water text-white text-xl"></i>
                        </div>
                        <i class="fas fa-arrow-right text-blue-400 group-hover:translate-x-1 transition"></i>
                    </div>
                    <h3 class="text-lg font-bold text-blue-900 mb-2">ì˜¤ì•„ì‹œìŠ¤</h3>
                    <p class="text-xs text-blue-700">ì˜¤ì•„ì‹œìŠ¤ ì‹œìŠ¤í…œ</p>
                </div>

                <!-- GMS -->
                <div onclick="openCategoryModal('GMS')" class="bg-gradient-to-br from-green-50 to-green-100 border-2 border-green-200 rounded-xl p-6 cursor-pointer hover:shadow-lg hover:scale-105 transition-all duration-200 group">
                    <div class="flex items-start justify-between mb-3">
                        <div class="w-12 h-12 bg-green-500 rounded-lg flex items-center justify-center group-hover:scale-110 transition">
                            <i class="fas fa-cogs text-white text-xl"></i>
                        </div>
                        <i class="fas fa-arrow-right text-green-400 group-hover:translate-x-1 transition"></i>
                    </div>
                    <h3 class="text-lg font-bold text-green-900 mb-2">GMS</h3>
                    <p class="text-xs text-green-700">GMS ì‹œìŠ¤í…œ</p>
                </div>

                <!-- ë¶€ë™ì‚° -->
                <div onclick="openCategoryModal('ë¶€ë™ì‚°')" class="bg-gradient-to-br from-orange-50 to-orange-100 border-2 border-orange-200 rounded-xl p-6 cursor-pointer hover:shadow-lg hover:scale-105 transition-all duration-200 group">
                    <div class="flex items-start justify-between mb-3">
                        <div class="w-12 h-12 bg-orange-500 rounded-lg flex items-center justify-center group-hover:scale-110 transition">
                            <i class="fas fa-building text-white text-xl"></i>
                        </div>
                        <i class="fas fa-arrow-right text-orange-400 group-hover:translate-x-1 transition"></i>
                    </div>
                    <h3 class="text-lg font-bold text-orange-900 mb-2">ë¶€ë™ì‚°</h3>
                    <p class="text-xs text-orange-700">ë¶€ë™ì‚° ì‹œìŠ¤í…œ</p>
                </div>

                <!-- ì¸í”„ë¼ -->
                <div onclick="openCategoryModal('ì¸í”„ë¼')" class="bg-gradient-to-br from-purple-50 to-purple-100 border-2 border-purple-200 rounded-xl p-6 cursor-pointer hover:shadow-lg hover:scale-105 transition-all duration-200 group">
                    <div class="flex items-start justify-between mb-3">
                        <div class="w-12 h-12 bg-purple-500 rounded-lg flex items-center justify-center group-hover:scale-110 transition">
                            <i class="fas fa-server text-white text-xl"></i>
                        </div>
                        <i class="fas fa-arrow-right text-purple-400 group-hover:translate-x-1 transition"></i>
                    </div>
                    <h3 class="text-lg font-bold text-purple-900 mb-2">ì¸í”„ë¼</h3>
                    <p class="text-xs text-purple-700">ì¸í”„ë¼ ì‹œìŠ¤í…œ</p>
                </div>

                <!-- ERP -->
                <div onclick="openCategoryModal('ERP')" class="bg-gradient-to-br from-red-50 to-red-100 border-2 border-red-200 rounded-xl p-6 cursor-pointer hover:shadow-lg hover:scale-105 transition-all duration-200 group">
                    <div class="flex items-start justify-between mb-3">
                        <div class="w-12 h-12 bg-red-500 rounded-lg flex items-center justify-center group-hover:scale-110 transition">
                            <i class="fas fa-chart-line text-white text-xl"></i>
                        </div>
                        <i class="fas fa-arrow-right text-red-400 group-hover:translate-x-1 transition"></i>
                    </div>
                    <h3 class="text-lg font-bold text-red-900 mb-2">ERP</h3>
                    <p class="text-xs text-red-700">ERP ì‹œìŠ¤í…œ</p>
                </div>

                <!-- HR -->
                <div onclick="openCategoryModal('HR')" class="bg-gradient-to-br from-pink-50 to-pink-100 border-2 border-pink-200 rounded-xl p-6 cursor-pointer hover:shadow-lg hover:scale-105 transition-all duration-200 group">
                    <div class="flex items-start justify-between mb-3">
                        <div class="w-12 h-12 bg-pink-500 rounded-lg flex items-center justify-center group-hover:scale-110 transition">
                            <i class="fas fa-users text-white text-xl"></i>
                        </div>
                        <i class="fas fa-arrow-right text-pink-400 group-hover:translate-x-1 transition"></i>
                    </div>
                    <h3 class="text-lg font-bold text-pink-900 mb-2">HR</h3>
                    <p class="text-xs text-pink-700">HR ì‹œìŠ¤í…œ</p>
                </div>

                <!-- ê¸°íƒ€ -->
                <div onclick="openCategoryModal('ê¸°íƒ€')" class="bg-gradient-to-br from-gray-50 to-gray-100 border-2 border-gray-200 rounded-xl p-6 cursor-pointer hover:shadow-lg hover:scale-105 transition-all duration-200 group">
                    <div class="flex items-start justify-between mb-3">
                        <div class="w-12 h-12 bg-gray-500 rounded-lg flex items-center justify-center group-hover:scale-110 transition">
                            <i class="fas fa-ellipsis-h text-white text-xl"></i>
                        </div>
                        <i class="fas fa-arrow-right text-gray-400 group-hover:translate-x-1 transition"></i>
                    </div>
                    <h3 class="text-lg font-bold text-gray-900 mb-2">ê¸°íƒ€</h3>
                    <p class="text-xs text-gray-700">ê¸°íƒ€ ì„œë¹„ìŠ¤</p>
                </div>

                <!-- ìì‚° ìš”ì²­ ğŸ†• -->
                <div onclick="quickAssetRequest()" class="bg-gradient-to-br from-indigo-50 to-indigo-100 border-2 border-indigo-200 rounded-xl p-6 cursor-pointer hover:shadow-lg hover:scale-105 transition-all duration-200 group">
                    <div class="flex items-start justify-between mb-3">
                        <div class="w-12 h-12 bg-indigo-500 rounded-lg flex items-center justify-center group-hover:scale-110 transition">
                            <i class="fas fa-laptop text-white text-xl"></i>
                        </div>
                        <i class="fas fa-arrow-right text-indigo-400 group-hover:translate-x-1 transition"></i>
                    </div>
                    <h3 class="text-lg font-bold text-indigo-900 mb-2">ìì‚° ìš”ì²­</h3>
                    <p class="text-xs text-indigo-700">HW/SW/í´ë¼ìš°ë“œ</p>
                </div>
                
                <!-- ê²Œì‹œíŒ ğŸ†• -->
                <div onclick="openUserBoardView()" class="bg-gradient-to-br from-teal-50 to-teal-100 border-2 border-teal-200 rounded-xl p-6 cursor-pointer hover:shadow-lg hover:scale-105 transition-all duration-200 group">
                    <div class="flex items-start justify-between mb-3">
                        <div class="w-12 h-12 bg-teal-500 rounded-lg flex items-center justify-center group-hover:scale-110 transition">
                            <i class="fas fa-clipboard-list text-white text-xl"></i>
                        </div>
                        <i class="fas fa-arrow-right text-teal-400 group-hover:translate-x-1 transition"></i>
                    </div>
                    <h3 class="text-lg font-bold text-teal-900 mb-2">ê²Œì‹œíŒ</h3>
                    <p class="text-xs text-teal-700">ë§¤ë‰´ì–¼/ì„¤ì¹˜íŒŒì¼</p>
                </div>
            </div>
        </div>
        
        <!-- ê²Œì‹œíŒ ì„¹ì…˜ ğŸ†• -->
        <div id="user-board-section" style="display: none;">
            <div id="user-board-content"></div>
        </div>

        <!-- ì§„í–‰ ì¤‘ì¸ ìš”ì²­ (Active Requests) -->
        <div id="active-requests-section" class="mb-8" style="display: none;">
            <div class="flex items-center justify-between mb-4">
                <h2 class="text-xl font-bold text-gray-800">
                    <i class="fas fa-running text-blue-500 mr-2"></i>ì§„í–‰ ì¤‘ì¸ ìš”ì²­
                </h2>
            </div>
            <div id="active-requests-container" class="space-y-3"></div>
        </div>

        <!-- Ticket List Table -->
        <div class="bg-white rounded-xl shadow-sm border overflow-hidden">
            <div class="p-6 border-b bg-gradient-to-r from-gray-50 to-white">
                <div class="flex items-center justify-between">
                    <h2 class="text-lg font-bold text-gray-800">
                        <i class="fas fa-history text-gray-500 mr-2"></i>ì „ì²´ ì‹ ì²­ ë‚´ì—­
                    </h2>
                    <div class="flex items-center space-x-3">
                        <select class="border border-gray-300 rounded-lg px-4 py-2 text-sm" id="user-status-filter" onchange="renderUserTickets()">
                            <option value="">ì „ì²´ ìƒíƒœ</option>
                            <option value="ìš”ì²­">ìš”ì²­</option>
                            <option value="ê²¬ì í™•ì¸">ê²¬ì í™•ì¸</option>
                            <option value="ìŠ¹ì¸ëŒ€ê¸°">ìŠ¹ì¸ëŒ€ê¸°</option>
                            <option value="ì ‘ìˆ˜">ì ‘ìˆ˜</option>
                            <option value="ì²˜ë¦¬ì¤‘">ì²˜ë¦¬ì¤‘</option>
                            <option value="ì¬ê²€ìˆ˜ì¤‘">ì¬ê²€ìˆ˜ì¤‘</option>
                            <option value="ê²€ìˆ˜ ëŒ€ê¸°">ê²€ìˆ˜ ëŒ€ê¸°</option>
                            <option value="ì™„ë£Œ">ì™„ë£Œ</option>
                            <option value="ë³´ë¥˜">ë³´ë¥˜</option>
                            <option value="ë°˜ë ¤">ë°˜ë ¤</option>
                            <option value="ì·¨ì†Œ">ì·¨ì†Œ</option>
                        </select>
                    </div>
                </div>
            </div>
            <div class="overflow-x-auto">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th style="width: 80px;">í‹°ì¼“ë²ˆí˜¸</th>
                            <th style="width: 100px;">ìƒíƒœ</th>
                            <th style="width: 60px;">ìš°ì„ ìˆœìœ„</th>
                            <th>ì œëª©</th>
                            <th style="width: 120px;">ìš”ì²­ì¼</th>
                            <th style="width: 120px;">ì˜ˆìƒì™„ë£Œì¼</th>
                            <th style="width: 120px;">ë‹´ë‹¹ì</th>
                            <th style="width: 100px;">ì§„í–‰ë¥ </th>
                        </tr>
                    </thead>
                    <tbody id="user-ticket-list">
                        <!-- User tickets will be rendered here -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Admin View (ITíŒ€ í™”ë©´) -->
    <div id="admin-view" class="max-w-[1600px] mx-auto px-6 py-6 hidden">
        <!-- Navigation Tabs -->
        <div class="bg-white rounded-xl shadow-sm border mb-6">
            <div class="flex border-b">
                <button class="nav-tab active" onclick="switchAdminTab('kanban')">
                    <i class="fas fa-th mr-2"></i>ì¹¸ë°˜ ë³´ë“œ
                </button>
                <button class="nav-tab" onclick="switchAdminTab('list')">
                    <i class="fas fa-list mr-2"></i>í‹°ì¼“ ëª©ë¡
                </button>
                <button class="nav-tab" onclick="switchAdminTab('gantt')">
                    <i class="fas fa-chart-bar mr-2"></i>ê°„íŠ¸ì°¨íŠ¸
                </button>
                <button class="nav-tab" onclick="switchAdminTab('analytics')">
                    <i class="fas fa-chart-pie mr-2"></i>í†µê³„
                </button>
                <button class="nav-tab" onclick="switchAdminTab('workload')">
                    <i class="fas fa-users-cog mr-2"></i>ì—…ë¬´ëŸ‰ ë¶„ì„
                </button>
                <button class="nav-tab" onclick="switchAdminTab('projects')">
                    <i class="fas fa-folder-open mr-2"></i>í”„ë¡œì íŠ¸ ê´€ë¦¬
                </button>
                <button class="nav-tab" onclick="switchAdminTab('assets')">
                    <i class="fas fa-box mr-2"></i>ìì‚° ê´€ë¦¬
                </button>
                <button class="nav-tab" onclick="switchAdminTab('board')">
                    <i class="fas fa-clipboard-list mr-2"></i>ê²Œì‹œíŒ
                </button>
                <button class="nav-tab" id="accountManagementTab" onclick="switchAdminTab('account')" style="display: none;">
                    <i class="fas fa-user-cog mr-2"></i>ê³„ì • ê´€ë¦¬
                </button>
            </div>
        </div>

        <!-- Board Tab ğŸ†• -->
        <div id="admin-board-tab" class="admin-tab-content hidden">
            <div id="board-content"></div>
        </div>

        <!-- Kanban Board Tab -->
        <div id="admin-kanban-tab" class="admin-tab-content">
            <!-- í•„í„° ì¶”ê°€ ğŸ†• -->
            <div class="mb-6 flex items-center justify-between">
                <div class="flex items-center space-x-2">
                    <label class="text-sm font-semibold text-gray-700">í•„í„°:</label>
                    <button onclick="filterKanban('ì „ì²´')" id="kanban-filter-all" 
                            class="px-4 py-2 rounded-lg font-semibold transition bg-blue-600 text-white">
                        ì „ì²´
                    </button>
                    <button onclick="filterKanban('ITSM')" id="kanban-filter-itsm"
                            class="px-4 py-2 rounded-lg font-semibold transition bg-gray-200 text-gray-700 hover:bg-gray-300">
                        ITSM
                    </button>
                    <button onclick="filterKanban('ìì‚°')" id="kanban-filter-asset"
                            class="px-4 py-2 rounded-lg font-semibold transition bg-gray-200 text-gray-700 hover:bg-gray-300">
                        ìì‚°
                    </button>
                </div>
                
                <!-- Admin ê¶Œí•œë³„ í‘œì‹œ ğŸ†• -->
                <div id="admin-view-toggle" style="display:none;">
                    <select onchange="toggleAdminViewScope(this.value)" 
                            class="px-4 py-2 border border-gray-300 rounded-lg font-semibold">
                        <option value="all">ì „ì²´ ë³´ê¸°</option>
                        <option value="own">ë³¸ì¸ ê²ƒë§Œ</option>
                    </select>
                </div>
            </div>
            
            <div class="flex space-x-4 overflow-x-auto pb-4" id="kanban-board">
                <!-- Kanban columns will be rendered here -->
            </div>
        </div>

        <!-- List Tab -->
        <div id="admin-list-tab" class="admin-tab-content hidden">
            <div class="bg-white rounded-xl shadow-sm border overflow-hidden">
                <div class="p-6 border-b">
                    <div class="flex items-center justify-between mb-4">
                        <h2 class="text-lg font-bold text-gray-800">ì „ì²´ í‹°ì¼“ ê´€ë¦¬</h2>
                    </div>
                    
                    <!-- í•„í„° ì¶”ê°€ ğŸ†• -->
                    <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-3">
                            <!-- í‹°ì¼“ ìœ í˜• í•„í„° -->
                            <div class="flex items-center space-x-2">
                                <label class="text-sm font-semibold text-gray-700">ìœ í˜•:</label>
                                <button onclick="filterTicketList('ì „ì²´')" id="list-filter-all" 
                                        class="px-3 py-1.5 rounded-lg text-sm font-semibold transition bg-blue-600 text-white">
                                    ì „ì²´
                                </button>
                                <button onclick="filterTicketList('ITSM')" id="list-filter-itsm"
                                        class="px-3 py-1.5 rounded-lg text-sm font-semibold transition bg-gray-200 text-gray-700 hover:bg-gray-300">
                                    ITSM
                                </button>
                                <button onclick="filterTicketList('ìì‚°')" id="list-filter-asset"
                                        class="px-3 py-1.5 rounded-lg text-sm font-semibold transition bg-gray-200 text-gray-700 hover:bg-gray-300">
                                    ìì‚°
                                </button>
                            </div>
                            
                            <input type="text" placeholder="í‹°ì¼“ ê²€ìƒ‰..." class="border rounded-lg px-4 py-2 text-sm" id="admin-search" oninput="renderAdminTickets()">
                            <select class="border rounded-lg px-4 py-2 text-sm" id="admin-status-filter" onchange="renderAdminTickets()">
                                <option value="">ì „ì²´ ìƒíƒœ</option>
                                <option value="ìš”ì²­">ìš”ì²­</option>
                                <option value="ê²¬ì í™•ì¸">ê²¬ì í™•ì¸</option>
                                <option value="ìŠ¹ì¸ëŒ€ê¸°">ìŠ¹ì¸ëŒ€ê¸°</option>
                                <option value="ì ‘ìˆ˜">ì ‘ìˆ˜</option>
                                <option value="ì²˜ë¦¬ì¤‘">ì²˜ë¦¬ì¤‘</option>
                                <option value="ì¬ê²€ìˆ˜ì¤‘">ì¬ê²€ìˆ˜ì¤‘</option>
                                <option value="ê²€ìˆ˜ ëŒ€ê¸°">ê²€ìˆ˜ ëŒ€ê¸°</option>
                                <option value="ì™„ë£Œ">ì™„ë£Œ</option>
                                <option value="ë³´ë¥˜">ë³´ë¥˜</option>
                                <option value="ë°˜ë ¤">ë°˜ë ¤</option>
                                <option value="ì·¨ì†Œ">ì·¨ì†Œ</option>
                            </select>
                            <select class="border rounded-lg px-4 py-2 text-sm" id="admin-categoryMain-filter" onchange="renderAdminTickets()">
                                <option value="">ì „ì²´ ëŒ€ë¶„ë¥˜</option>
                                <option value="ì˜¤ì•„ì‹œìŠ¤">ì˜¤ì•„ì‹œìŠ¤</option>
                                <option value="ì¸í”„ë¼">ì¸í”„ë¼</option>
                                <option value="í™˜ê²½">í™˜ê²½</option>
                                <option value="ë¶€ë™ì‚°">ë¶€ë™ì‚°</option>
                                <option value="ê¸°íƒ€">ê¸°íƒ€</option>
                            </select>
                            <select class="border rounded-lg px-4 py-2 text-sm" id="admin-categoryMiddle-filter" onchange="renderAdminTickets()">
                                <option value="">ì „ì²´ ì¤‘ë¶„ë¥˜</option>
                                <option value="ê°œë°œìš”ì²­">ê°œë°œìš”ì²­</option>
                                <option value="ìš´ì˜ê´€ë¦¬">ìš´ì˜ê´€ë¦¬</option>
                                <option value="ì¥ì• ">ì¥ì• </option>
                            </select>
                            <select class="border rounded-lg px-4 py-2 text-sm" id="admin-categorySub-filter" onchange="renderAdminTickets()">
                                <option value="">ì „ì²´ ì†Œë¶„ë¥˜</option>
                                <option value="ì‹ ê·œ">ì‹ ê·œ</option>
                                <option value="ê°œì„ (ë³€ê²½)">ê°œì„ (ë³€ê²½)</option>
                                <option value="ì¥ì• ">ì¥ì• </option>
                                <option value="ê¸°ëŠ¥ì¶”ê°€">ê¸°ëŠ¥ì¶”ê°€</option>
                                <option value="ê³„ì •ì¶”ê°€">ê³„ì •ì¶”ê°€</option>
                                <option value="ê¶Œí•œìš”ì²­">ê¶Œí•œìš”ì²­</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="overflow-x-auto">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th style="width: 80px;">í‹°ì¼“ë²ˆí˜¸</th>
                                <th style="width: 100px;">ìƒíƒœ</th>
                                <th style="width: 60px;">ìš°ì„ ìˆœìœ„</th>
                                <th style="width: 100px;">ì¹´í…Œê³ ë¦¬</th>
                                <th>ì œëª©</th>
                                <th style="width: 100px;">ìš”ì²­ì</th>
                                <th style="width: 120px;">ìš”ì²­ì¼</th>
                                <th style="width: 120px;">ë‹´ë‹¹ì</th>
                                <th style="width: 100px;">í•˜ìœ„ì—…ë¬´</th>
                                <th style="width: 110px;">ì—°ê²° í‹°ì¼“</th>
                                <th style="width: 100px;">ì§„í–‰ë¥ </th>
                                <th style="width: 80px;">ì‘ì—…</th>
                            </tr>
                        </thead>
                        <tbody id="admin-ticket-list">
                            <!-- Admin tickets will be rendered here -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Gantt Tab -->
        <div id="admin-gantt-tab" class="admin-tab-content hidden">
            <div class="bg-white rounded-xl shadow-sm border overflow-hidden">
                <div class="p-6 border-b">
                    <div class="flex items-center justify-between">
                        <h2 class="text-lg font-bold text-gray-800">í”„ë¡œì íŠ¸ íƒ€ì„ë¼ì¸</h2>
                        <div class="flex items-center space-x-3">
                            <select class="border rounded-lg px-4 py-2 text-sm" id="gantt-group-by" onchange="renderGantt()">
                                <option value="ticket">í‹°ì¼“ë³„ ë³´ê¸°</option>
                                <option value="assignee">ë‹´ë‹¹ìë³„ ë³´ê¸°</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div id="gantt-container">
                    <!-- Gantt chart will be rendered here -->
                </div>
            </div>
        </div>

        <!-- Analytics Tab -->
        <div id="admin-analytics-tab" class="admin-tab-content hidden">
            <div class="grid grid-cols-4 gap-6 mb-6">
                <div class="bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl shadow-lg p-6 text-white">
                    <div class="flex items-center justify-between mb-4">
                        <div class="w-12 h-12 bg-white bg-opacity-20 rounded-lg flex items-center justify-center">
                            <i class="fas fa-ticket-alt text-2xl"></i>
                        </div>
                    </div>
                    <p class="text-sm opacity-90 mb-1">ì „ì²´ í‹°ì¼“</p>
                    <p class="text-3xl font-bold" id="admin-stat-total">0</p>
                </div>
                <div class="bg-gradient-to-br from-yellow-500 to-yellow-600 rounded-xl shadow-lg p-6 text-white">
                    <div class="flex items-center justify-between mb-4">
                        <div class="w-12 h-12 bg-white bg-opacity-20 rounded-lg flex items-center justify-center">
                            <i class="fas fa-hourglass-half text-2xl"></i>
                        </div>
                    </div>
                    <p class="text-sm opacity-90 mb-1">ëŒ€ê¸° ì¤‘</p>
                    <p class="text-3xl font-bold" id="admin-stat-waiting">0</p>
                </div>
                <div class="bg-gradient-to-br from-purple-500 to-purple-600 rounded-xl shadow-lg p-6 text-white">
                    <div class="flex items-center justify-between mb-4">
                        <div class="w-12 h-12 bg-white bg-opacity-20 rounded-lg flex items-center justify-center">
                            <i class="fas fa-tasks text-2xl"></i>
                        </div>
                    </div>
                    <p class="text-sm opacity-90 mb-1">ì§„í–‰ ì¤‘</p>
                    <p class="text-3xl font-bold" id="admin-stat-progress">0</p>
                </div>
                <div class="bg-gradient-to-br from-green-500 to-green-600 rounded-xl shadow-lg p-6 text-white">
                    <div class="flex items-center justify-between mb-4">
                        <div class="w-12 h-12 bg-white bg-opacity-20 rounded-lg flex items-center justify-center">
                            <i class="fas fa-check-double text-2xl"></i>
                        </div>
                    </div>
                    <p class="text-sm opacity-90 mb-1">ì™„ë£Œ</p>
                    <p class="text-3xl font-bold" id="admin-stat-done">0</p>
                </div>
            </div>

            <!-- Real-time Status & Monthly Stats -->
            <div class="grid grid-cols-2 gap-6 mb-6">
                <div class="bg-white rounded-xl shadow-sm border p-6">
                    <h3 class="text-lg font-bold mb-4">ì‹¤ì‹œê°„ í˜„í™© (ìƒíƒœë³„)</h3>
                    <div class="space-y-4" id="realtime-status">
                        <!-- Real-time status will be rendered here -->
                    </div>
                </div>
                <div class="bg-white rounded-xl shadow-sm border p-6">
                    <h3 class="text-lg font-bold mb-4">ì›”ë³„ ì™„ë£Œìœ¨</h3>
                    <div class="space-y-3" id="monthly-completion">
                        <!-- Monthly completion will be rendered here -->
                    </div>
                </div>
            </div>

            <!-- Assignee Real-time Status -->
            <div class="bg-white rounded-xl shadow-sm border p-6 mb-6">
                <h3 class="text-lg font-bold mb-4">ë‹´ë‹¹ìë³„ ì‹¤ì‹œê°„ í˜„í™©</h3>
                <div class="grid grid-cols-5 gap-4" id="assignee-realtime-status">
                    <!-- Assignee real-time status will be rendered here -->
                </div>
            </div>

            <!-- Team Performance -->
            <div class="bg-white rounded-xl shadow-sm border p-6">
                <h3 class="text-lg font-bold mb-4">íŒ€ì›ë³„ ì—…ë¬´ ì„±ê³¼ (ìµœê·¼ 2ê°œì›”)</h3>
                <div class="overflow-x-auto">
                    <table class="w-full">
                        <thead class="bg-gray-50 border-b-2 border-gray-200">
                            <tr>
                                <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">ë‹´ë‹¹ì</th>
                                <th class="px-4 py-3 text-center text-sm font-semibold text-gray-700">í• ë‹¹ëœ ì—…ë¬´</th>
                                <th class="px-4 py-3 text-center text-sm font-semibold text-gray-700">ì™„ë£Œ</th>
                                <th class="px-4 py-3 text-center text-sm font-semibold text-gray-700">ì§„í–‰ì¤‘</th>
                                <th class="px-4 py-3 text-center text-sm font-semibold text-gray-700">ì™„ë£Œìœ¨</th>
                                <th class="px-4 py-3 text-center text-sm font-semibold text-gray-700">í‰ê·  ì²˜ë¦¬ì‹œê°„</th>
                            </tr>
                        </thead>
                        <tbody id="team-performance">
                            <!-- Team performance will be rendered here -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Workload Analysis Tab -->
        <div id="admin-workload-tab" class="admin-tab-content hidden">
            <div class="mb-6">
                <h2 class="text-2xl font-bold text-gray-800 mb-2">
                    <i class="fas fa-users-cog text-purple-600 mr-2"></i>
                    ì—…ë¬´ëŸ‰ & ë¹„ìš© ë¶„ì„
                </h2>
                <p class="text-gray-600">ì‹¤ë¬´ìë³„ ì—…ë¬´ í˜„í™©ê³¼ ë§¨ë°ì´ ê¸°ë°˜ ë¹„ìš©ì„ í™•ì¸í•©ë‹ˆë‹¤</p>
            </div>
            
            <div id="workload-grid" class="grid grid-cols-1 gap-4">
                <!-- Workload cards will be rendered here -->
            </div>
        </div>

        <!-- Projects Tab -->
        <div id="admin-projects-tab" class="admin-tab-content hidden">
            <div class="mb-6 flex justify-between items-center">
                <h2 class="text-2xl font-bold text-gray-800">í”„ë¡œì íŠ¸ ê´€ë¦¬</h2>
                <button onclick="openNewProjectModal()" class="px-6 py-3 bg-gradient-to-r from-purple-600 to-pink-600 text-white rounded-lg hover:from-purple-700 hover:to-pink-700 transition font-semibold shadow-lg">
                    <i class="fas fa-plus mr-2"></i>ìƒˆ í”„ë¡œì íŠ¸ ìƒì„±
                </button>
            </div>

            <!-- Projects Grid -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="projects-grid">
                <!-- Projects will be rendered here -->
            </div>
        </div>

        <!-- Account Management Tab (Master Only) -->
        <div id="admin-account-tab" class="admin-tab-content hidden">
            <div class="mb-6">
                <div class="flex items-center justify-between mb-4">
                    <div>
                        <h2 class="text-2xl font-bold text-gray-800">
                            <i class="fas fa-user-cog text-blue-600 mr-2"></i>IT ì§ì› ê³„ì • ê´€ë¦¬
                        </h2>
                        <p class="text-sm text-gray-600 mt-1">ë“±ê¸‰, ëŒ€ë¶„ë¥˜ ë‹´ë‹¹, ìš”ìœ¨ ì •ë³´ë¥¼ ê´€ë¦¬í•©ë‹ˆë‹¤</p>
                    </div>
                    <button onclick="openAddStaffModal()" class="px-6 py-3 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-lg hover:from-blue-700 hover:to-purple-700 transition font-semibold shadow-lg">
                        <i class="fas fa-user-plus mr-2"></i>ì§ì› ì¶”ê°€
                    </button>
                </div>

                <!-- ë“±ê¸‰ë³„ ê¸°ì¤€ ë‹¨ê°€ ì•ˆë‚´ -->
                <div class="bg-gradient-to-r from-blue-50 to-purple-50 border border-blue-200 rounded-xl p-6 mb-6">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="font-bold text-gray-800 flex items-center">
                            <i class="fas fa-coins text-yellow-500 mr-2"></i>ë“±ê¸‰ë³„ ê¸°ì¤€ ë‹¨ê°€
                        </h3>
                        <div class="flex space-x-2">
                            <button onclick="openRateHistoryModal()" 
                                class="px-4 py-2 bg-white border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition text-sm font-semibold">
                                <i class="fas fa-history mr-2"></i>ë³€ê²½ ì´ë ¥
                            </button>
                            <button onclick="openEditRatesModal()" 
                                class="px-4 py-2 bg-gradient-to-r from-yellow-500 to-orange-500 text-white rounded-lg hover:from-yellow-600 hover:to-orange-600 transition text-sm font-semibold shadow-md">
                                <i class="fas fa-edit mr-2"></i>ë‹¨ê°€ ìˆ˜ì •
                            </button>
                        </div>
                    </div>
                    <div class="grid grid-cols-4 gap-4" id="rates-display"></div>
                </div>

                <!-- ì‹œìŠ¤í…œ ì„¤ì • -->
                <div class="bg-gradient-to-r from-green-50 to-teal-50 border border-green-200 rounded-xl p-6 mb-6">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="font-bold text-gray-800 flex items-center">
                            <i class="fas fa-cog text-green-600 mr-2"></i>ì‹œìŠ¤í…œ ì„¤ì •
                        </h3>
                        <button onclick="openSystemSettingsModal()" 
                            class="px-4 py-2 bg-gradient-to-r from-green-500 to-teal-500 text-white rounded-lg hover:from-green-600 hover:to-teal-600 transition text-sm font-semibold shadow-md">
                            <i class="fas fa-edit mr-2"></i>ì„¤ì • ë³€ê²½
                        </button>
                    </div>
                    <div class="grid grid-cols-2 gap-4">
                        <div class="bg-white rounded-lg p-4 border border-gray-200">
                            <div class="text-sm text-gray-600 mb-1">ê²¬ì  í™•ì¸ í•„ìš” ê¸ˆì•¡</div>
                            <div class="text-2xl font-bold text-green-600" id="threshold-display">
                                â‚©<span id="threshold-amount">5,000,000</span>
                            </div>
                            <div class="text-xs text-gray-500 mt-1">
                                ì´ ê¸ˆì•¡ ì´ìƒì˜ ê²¬ì ì€ ì‹ ì²­ì í™•ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤
                            </div>
                        </div>
                        <div class="bg-white rounded-lg p-4 border border-gray-200">
                            <div class="text-sm text-gray-600 mb-1">ê²¬ì  í™•ì¸ ì¡°ê±´</div>
                            <div class="text-sm text-gray-700 mt-2 space-y-1">
                                <div>âœ“ ê¸ˆì•¡: <span class="font-semibold" id="threshold-amount-2">â‚©5,000,000</span> ì´ìƒ</div>
                                <div>âœ“ ì¹´í…Œê³ ë¦¬: ê°œë°œìš”ì²­</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- IT ì§ì› ëª©ë¡ -->
                <div class="bg-white rounded-xl shadow-sm border overflow-hidden">
                    <div class="overflow-x-auto">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th style="width: 100px;">ì´ë¦„</th>
                                    <th style="width: 150px;">ì—­í• </th>
                                    <th style="width: 80px;">ê²½ë ¥</th>
                                    <th style="width: 100px;">ë“±ê¸‰</th>
                                    <th style="width: 120px;">ì‹œê¸‰</th>
                                    <th style="width: 120px;">ì¼ê¸‰</th>
                                    <th style="width: 120px;">ì›”ê¸‰</th>
                                    <th style="width: 150px;">ëŒ€ë¶„ë¥˜ ë‹´ë‹¹</th>
                                    <th style="width: 150px;">ê´€ë¦¬</th>
                                </tr>
                            </thead>
                            <tbody id="staff-list">
                                <!-- Staff will be rendered here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- Assets Management Tab ğŸ†• -->
        <div id="admin-assets-tab" class="admin-tab-content hidden">
            <div class="mb-6">
                <div class="flex items-center justify-between mb-4">
                    <div>
                        <h2 class="text-2xl font-bold text-gray-800">
                            <i class="fas fa-box text-purple-600 mr-2"></i>IT ìì‚° ê´€ë¦¬
                        </h2>
                        <p class="text-sm text-gray-600 mt-1">í•˜ë“œì›¨ì–´, ì†Œí”„íŠ¸ì›¨ì–´, í´ë¼ìš°ë“œ ìì‚°ì„ ê´€ë¦¬í•©ë‹ˆë‹¤</p>
                    </div>
                    <button onclick="openAddAssetModal()" class="px-6 py-3 bg-gradient-to-r from-purple-600 to-pink-600 text-white rounded-lg hover:from-purple-700 hover:to-pink-700 transition font-semibold shadow-lg">
                        <i class="fas fa-plus mr-2"></i>ìì‚° ë“±ë¡
                    </button>
                </div>

                <!-- í•„í„° & ê²€ìƒ‰ -->
                <div class="bg-white rounded-xl shadow-sm border p-4 mb-6">
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <!-- ì¹´í…Œê³ ë¦¬ í•„í„° -->
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2">ì¹´í…Œê³ ë¦¬</label>
                            <select id="asset-filter-category" onchange="filterAssets()" class="w-full border border-gray-300 rounded-lg px-4 py-2">
                                <option value="">ì „ì²´</option>
                                <option value="í•˜ë“œì›¨ì–´">í•˜ë“œì›¨ì–´</option>
                                <option value="ì†Œí”„íŠ¸ì›¨ì–´">ì†Œí”„íŠ¸ì›¨ì–´</option>
                                <option value="í´ë¼ìš°ë“œ">í´ë¼ìš°ë“œ</option>
                            </select>
                        </div>
                        
                        <!-- ìƒíƒœ í•„í„° -->
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2">ìƒíƒœ</label>
                            <select id="asset-filter-status" onchange="filterAssets()" class="w-full border border-gray-300 rounded-lg px-4 py-2">
                                <option value="">ì „ì²´</option>
                                <option value="ëŒ€ê¸°">ë³´ìœ (ëŒ€ê¸°)</option>
                                <option value="ì‚¬ìš©ì¤‘">ì‚¬ìš©ì¤‘</option>
                                <option value="ê³ ì¥">ê³ ì¥</option>
                                <option value="ìˆ˜ë¦¬ì¤‘">ìˆ˜ë¦¬ì¤‘</option>
                                <option value="ë°˜ë‚©">ë°˜ë‚©</option>
                            </select>
                        </div>
                        
                        <!-- ê²€ìƒ‰ -->
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2">ê²€ìƒ‰</label>
                            <input type="text" id="asset-search" onkeyup="filterAssets()" placeholder="ìì‚°ëª…, ì½”ë“œ, ì‚¬ìš©ì..."
                                   class="w-full border border-gray-300 rounded-lg px-4 py-2">
                        </div>
                    </div>
                </div>

                <!-- ìì‚° ëª©ë¡ í…Œì´ë¸” -->
                <div class="bg-white rounded-xl shadow-sm border overflow-hidden">
                    <div class="overflow-x-auto">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th style="width: 100px;">ìì‚°ì½”ë“œ</th>
                                    <th style="width: 80px;">ì¹´í…Œê³ ë¦¬</th>
                                    <th style="width: 150px;">ìì‚°ëª…</th>
                                    <th style="width: 120px;">ì œì¡°ì‚¬/ê°œë°œì‚¬</th>
                                    <th style="width: 100px;">êµ¬ë§¤ë…„ë„</th>
                                    <th style="width: 120px;">ê¸ˆì•¡ì •ë³´</th>
                                    <th style="width: 100px;">ìƒíƒœ</th>
                                    <th style="width: 120px;">ì‚¬ìš©ì</th>
                                    <th style="width: 150px;">ê´€ë¦¬</th>
                                </tr>
                            </thead>
                            <tbody id="assets-list">
                                <!-- Assets will be rendered here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- New Ticket Modal -->
    <div id="newTicketModal" class="modal">
        <div class="bg-white rounded-2xl shadow-2xl max-w-2xl w-full mx-4 p-8 animate-slide-in">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-2xl font-bold text-gray-800">ìƒˆ í‹°ì¼“ ìš”ì²­</h3>
                <div class="flex items-center space-x-2">
                    <button type="button" onclick="fillDemoTicketData()" class="text-sm text-blue-600 hover:text-blue-700 font-semibold">
                        <i class="fas fa-magic mr-1"></i>ë°ëª¨ ë°ì´í„° ì±„ìš°ê¸°
                    </button>
                    <button onclick="closeModal('newTicketModal')" class="text-gray-400 hover:text-gray-600 transition">
                        <i class="fas fa-times text-2xl"></i>
                    </button>
                </div>
            </div>
            <form id="newTicketForm" onsubmit="submitTicket(event)">
                <div class="space-y-5">
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">ì œëª© *</label>
                        <input type="text" name="title" required class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="ìš”ì²­í•˜ì‹¤ ë‚´ìš©ì„ ê°„ë‹¨íˆ ì…ë ¥í•´ì£¼ì„¸ìš”">
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">ìƒì„¸ ë‚´ìš© *</label>
                        <textarea name="description" required rows="5" class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="ìš”ì²­ ë‚´ìš©ì„ ìì„¸íˆ ì„¤ëª…í•´ì£¼ì„¸ìš”"></textarea>
                    </div>
                    
                    <!-- ì¹´í…Œê³ ë¦¬ 3ë‹¨ê³„ ë¶„ë¥˜ -->
                    <div class="grid grid-cols-3 gap-4">
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2">
                                ëŒ€ë¶„ë¥˜ <span class="text-red-500">*</span>
                            </label>
                            <select id="ticket-main-category" name="categoryMain" required 
                                    class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                <option value="">ì„ íƒ</option>
                                <option value="ì˜¤ì•„ì‹œìŠ¤">ì˜¤ì•„ì‹œìŠ¤</option>
                                <option value="GMS">GMS</option>
                                <option value="ë¶€ë™ì‚°">ë¶€ë™ì‚°</option>
                                <option value="ì¸í”„ë¼">ì¸í”„ë¼</option>
                                <option value="ERP">ERP</option>
                                <option value="HR">HR</option>
                                <option value="ê¸°íƒ€">ê¸°íƒ€</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2">
                                ì¤‘ë¶„ë¥˜ <span class="text-red-500">*</span>
                            </label>
                            <select id="ticket-category" name="categoryMiddle" required onchange="onCategoryChange()"
                                    class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                <option value="">ì„ íƒ</option>
                                <option value="ì¥ì• ì‹ ê³ ">ì¥ì• ì‹ ê³ </option>
                                <option value="ê°œë°œìš”ì²­">ê°œë°œìš”ì²­</option>
                                <option value="ìš´ì˜/ë³€ê²½ìš”ì²­">ìš´ì˜/ë³€ê²½ìš”ì²­</option>
                                <option value="í”„ë¡œì íŠ¸">í”„ë¡œì íŠ¸</option>
                                <option value="ì§€ì›ë¬¸ì˜">ì§€ì›ë¬¸ì˜</option>
                                <option value="ë””ìì¸ìš”ì²­">ë””ìì¸ìš”ì²­</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2">
                                ì†Œë¶„ë¥˜ <span class="text-red-500">*</span>
                            </label>
                            <select id="ticket-subcategory" name="categorySub" required 
                                    class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                <option value="">ë¨¼ì € ì¤‘ë¶„ë¥˜ë¥¼ ì„ íƒí•˜ì„¸ìš”</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2">ìš°ì„ ìˆœìœ„</label>
                            <select name="priority" class="w-full border border-gray-300 rounded-lg px-4 py-3">
                                <option value="ë‚®ìŒ">ë‚®ìŒ - ì¼ë°˜ ì—…ë¬´</option>
                                <option value="ë³´í†µ" selected>ë³´í†µ - ì¤‘ìš” ì—…ë¬´</option>
                                <option value="ë†’ìŒ">ë†’ìŒ - ê¸´ê¸‰ ì—…ë¬´</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2">í¬ë§ ì™„ë£Œì¼</label>
                            <input type="date" name="dueDate" class="w-full border border-gray-300 rounded-lg px-4 py-3">
                        </div>
                    </div>
                </div>
                <div class="flex justify-end space-x-3 mt-8">
                    <button type="button" onclick="closeModal('newTicketModal')" class="px-6 py-3 border border-gray-300 rounded-lg hover:bg-gray-50 transition font-semibold">
                        ì·¨ì†Œ
                    </button>
                    <button type="submit" class="px-6 py-3 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-lg hover:from-blue-700 hover:to-purple-700 transition font-semibold shadow-md">
                        <i class="fas fa-paper-plane mr-2"></i>ìš”ì²­í•˜ê¸°
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Completion Comment Modal -->
    <div id="completionModal" class="modal">
        <div class="bg-white rounded-2xl shadow-2xl max-w-2xl w-full mx-4 p-8 animate-slide-in">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-2xl font-bold text-gray-800">
                    <i class="fas fa-check-circle text-green-600 mr-2"></i>
                    ì‘ì—… ì™„ë£Œ ì²˜ë¦¬
                </h3>
                <button onclick="closeModal('completionModal')" class="text-gray-400 hover:text-gray-600 transition">
                    <i class="fas fa-times text-2xl"></i>
                </button>
            </div>
            
            <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6">
                <div class="flex items-start">
                    <i class="fas fa-info-circle text-blue-600 mt-1 mr-3"></i>
                    <div class="text-sm text-blue-800">
                        <p class="font-semibold mb-1">í‹°ì¼“: <span id="completionTicketNumber"></span></p>
                        <p id="completionTicketTitle"></p>
                        <p class="mt-2 text-blue-700">ì‘ì—… ì™„ë£Œ í›„ ì‚¬ìš©ìì—ê²Œ ê²€ìˆ˜ë¥¼ ìš”ì²­í•©ë‹ˆë‹¤. ì™„ë£Œ ë‚´ìš©ê³¼ ì‚¬ìš© ë°©ë²•ì„ ìƒì„¸íˆ ì‘ì„±í•´ì£¼ì„¸ìš”.</p>
                    </div>
                </div>
            </div>
            
            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-semibold text-gray-700 mb-2">
                        <i class="fas fa-comment-dots text-green-500 mr-1"></i>
                        ì™„ë£Œ ë‚´ìš© ë° ì‚¬ìš© ë°©ë²• <span class="text-red-500">*</span>
                    </label>
                    <textarea id="completionComment" rows="6" required
                        class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-green-500 focus:border-transparent"
                        placeholder="ì˜ˆì‹œ:&#10;&#10;âœ… ì™„ë£Œ ë‚´ìš©:&#10;- ì¸íŠ¸ë¼ë„· ë¡œê·¸ì¸ ì„¸ì…˜ ìœ ì§€ ë¬¸ì œ ìˆ˜ì • ì™„ë£Œ&#10;- Chrome ì¿ í‚¤ ì •ì±… ëŒ€ì‘ ì½”ë“œ ì ìš©&#10;&#10;ğŸ“– ì‚¬ìš© ë°©ë²•:&#10;1. ê¸°ì¡´ ë¸Œë¼ìš°ì € ìºì‹œ ì‚­ì œ (Ctrl+Shift+Del)&#10;2. ì¸íŠ¸ë¼ë„· ì¬ì ‘ì†&#10;3. 'ë¡œê·¸ì¸ ìƒíƒœ ìœ ì§€' ì²´í¬ë°•ìŠ¤ ì„ íƒ&#10;&#10;âš ï¸ ì£¼ì˜ì‚¬í•­:&#10;- Chrome ë²„ì „ 100 ì´ìƒì—ì„œë§Œ ë™ì‘í•©ë‹ˆë‹¤"></textarea>
                </div>
                
                <div>
                    <label class="block text-sm font-semibold text-gray-700 mb-2">
                        <i class="fas fa-link text-blue-500 mr-1"></i>
                        ì°¸ê³  ë§í¬ / ë©”ë‰´ì–¼ (ì„ íƒ)
                    </label>
                    <textarea id="completionLinks" rows="3"
                        class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                        placeholder="ë©”ë‰´ì–¼ ë§í¬, ì°¸ê³  ë¬¸ì„œ, ê´€ë ¨ ìë£Œ URLì„ í•œ ì¤„ì”© ì…ë ¥í•˜ì„¸ìš”&#10;&#10;ì˜ˆì‹œ:&#10;https://wiki.company.com/login-manual&#10;https://drive.google.com/file/d/..."></textarea>
                </div>
            </div>
            
            <div class="mt-8 flex justify-end space-x-3">
                <button type="button" onclick="closeModal('completionModal')" 
                        class="px-6 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition font-semibold">
                    ì·¨ì†Œ
                </button>
                <button type="button" onclick="saveCompletion()" 
                        class="px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition font-semibold shadow-lg">
                    <i class="fas fa-check mr-2"></i>ê²€ìˆ˜ ìš”ì²­
                </button>
            </div>
        </div>
    </div>

    <!-- Ticket Detail Modal -->
    <div id="ticketDetailModal" class="modal">
        <div class="bg-white rounded-2xl shadow-2xl max-w-4xl w-full mx-4 p-8 max-h-[90vh] overflow-y-auto animate-slide-in">
            <div class="flex items-center justify-between mb-6">
                <div>
                    <h3 class="text-2xl font-bold text-gray-800" id="detail-ticket-title"></h3>
                    <p class="text-sm text-gray-500 mt-1" id="detail-ticket-number"></p>
                </div>
                <button onclick="closeModal('ticketDetailModal')" class="text-gray-400 hover:text-gray-600 transition">
                    <i class="fas fa-times text-2xl"></i>
                </button>
            </div>
            <div id="ticket-detail-content">
                <!-- Ticket details will be rendered here -->
            </div>
        </div>
    </div>

    <!-- Edit Ticket Modal -->
    <div id="editTicketModal" class="modal">
        <div class="bg-white rounded-2xl shadow-2xl max-w-2xl w-full mx-4 p-8 animate-slide-in">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-2xl font-bold text-gray-800">
                    <i class="fas fa-edit text-blue-600 mr-2"></i>
                    í‹°ì¼“ ìˆ˜ì •
                </h3>
                <button onclick="closeModal('editTicketModal')" class="text-gray-400 hover:text-gray-600 transition">
                    <i class="fas fa-times text-2xl"></i>
                </button>
            </div>
            
            <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-6">
                <p class="text-sm text-yellow-800">
                    <i class="fas fa-info-circle mr-2"></i>
                    ìš”ì²­ ìƒíƒœì˜ í‹°ì¼“ë§Œ ìˆ˜ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì ‘ìˆ˜ ì´í›„ì—ëŠ” ìˆ˜ì •ì´ ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤.
                </p>
            </div>
            
            <form onsubmit="event.preventDefault(); saveEditedTicket();">
                <input type="hidden" id="edit-ticket-id">
                
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">
                            ì œëª© <span class="text-red-500">*</span>
                        </label>
                        <input type="text" id="edit-ticket-title" required
                            class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                            placeholder="í‹°ì¼“ ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">
                            ìƒì„¸ ë‚´ìš© <span class="text-red-500">*</span>
                        </label>
                        <textarea id="edit-ticket-description" rows="5" required
                            class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                            placeholder="ë¬¸ì œ ìƒí™©, ìš”ì²­ ì‚¬í•­ ë“±ì„ ìƒì„¸íˆ ì‘ì„±í•´ì£¼ì„¸ìš”"></textarea>
                    </div>
                    
                    <!-- ì¹´í…Œê³ ë¦¬ 3ë‹¨ê³„ ë¶„ë¥˜ -->
                    <div class="grid grid-cols-3 gap-4">
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2">
                                ëŒ€ë¶„ë¥˜ <span class="text-red-500">*</span>
                            </label>
                            <select id="edit-ticket-categoryMain" required
                                class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500">
                                <option value="ì˜¤ì•„ì‹œìŠ¤">ì˜¤ì•„ì‹œìŠ¤</option>
                                <option value="ì¸í”„ë¼">ì¸í”„ë¼</option>
                                <option value="í™˜ê²½">í™˜ê²½</option>
                                <option value="ë¶€ë™ì‚°">ë¶€ë™ì‚°</option>
                                <option value="ê¸°íƒ€">ê¸°íƒ€</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2">
                                ì¤‘ë¶„ë¥˜ <span class="text-red-500">*</span>
                            </label>
                            <select id="edit-ticket-categoryMiddle" required
                                class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500">
                                <option value="ê°œë°œìš”ì²­">ê°œë°œìš”ì²­</option>
                                <option value="ìš´ì˜ê´€ë¦¬">ìš´ì˜ê´€ë¦¬</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2">
                                ì†Œë¶„ë¥˜ <span class="text-red-500">*</span>
                            </label>
                            <select id="edit-ticket-categorySub" required
                                class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500">
                                <option value="ì‹ ê·œ">ì‹ ê·œ</option>
                                <option value="ê°œì„ (ë³€ê²½)">ê°œì„ (ë³€ê²½)</option>
                                <option value="ì¥ì• ">ì¥ì• </option>
                                <option value="ê¸°ëŠ¥ì¶”ê°€">ê¸°ëŠ¥ì¶”ê°€</option>
                                <option value="ê³„ì •ì¶”ê°€">ê³„ì •ì¶”ê°€</option>
                                <option value="ê¶Œí•œìš”ì²­">ê¶Œí•œìš”ì²­</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2">
                                ìš°ì„ ìˆœìœ„ <span class="text-red-500">*</span>
                            </label>
                            <select id="edit-ticket-priority" required
                                class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500">
                                <option value="ë†’ìŒ">ë†’ìŒ</option>
                                <option value="ë³´í†µ">ë³´í†µ</option>
                                <option value="ë‚®ìŒ">ë‚®ìŒ</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2">
                                ì˜ˆìƒ ì™„ë£Œì¼
                            </label>
                            <input type="date" id="edit-ticket-dueDate"
                                class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500">
                        </div>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">
                            ì˜ˆìƒ ì™„ë£Œì¼
                        </label>
                        <input type="date" id="edit-ticket-dueDate"
                            class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500">
                    </div>
                </div>
                
                <div class="mt-8 flex justify-end space-x-3">
                    <button type="button" onclick="closeModal('editTicketModal')" 
                            class="px-6 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition font-semibold">
                        ì·¨ì†Œ
                    </button>
                    <button type="submit" 
                            class="px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition font-semibold shadow-lg">
                        <i class="fas fa-save mr-2"></i>ìˆ˜ì • ì™„ë£Œ
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Accept Modal (ì ‘ìˆ˜ ë° ê²¬ì  ì…ë ¥) -->
    <div id="acceptModal" class="modal">
        <div class="bg-white rounded-2xl shadow-2xl max-w-3xl w-full mx-4 p-8 max-h-[90vh] overflow-y-auto animate-slide-in">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-2xl font-bold text-gray-800">
                    <i class="fas fa-clipboard-check text-blue-600 mr-2"></i>í‹°ì¼“ ì²˜ë¦¬
                </h3>
                <button onclick="closeModal('acceptModal')" class="text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times text-2xl"></i>
                </button>
            </div>
            
            <form id="acceptForm" onsubmit="submitAccept(event)">
                <input type="hidden" id="accept-ticket-id">
                
                <!-- í‹°ì¼“ ì •ë³´ ìš”ì•½ -->
                <div class="bg-gray-50 border border-gray-200 rounded-lg p-4 mb-6">
                    <div class="text-sm text-gray-600" id="accept-ticket-summary"></div>
                </div>

                <!-- ì²˜ë¦¬ ë°©ì‹ ì„ íƒ -->
                <div class="bg-gradient-to-r from-blue-50 to-green-50 border-2 border-blue-300 rounded-lg p-5 mb-6">
                    <h4 class="font-bold text-gray-800 mb-3 flex items-center">
                        <i class="fas fa-route text-blue-600 mr-2"></i>ì²˜ë¦¬ ë°©ì‹ ì„ íƒ
                    </h4>
                    <div class="grid grid-cols-2 gap-3">
                        <label class="relative cursor-pointer">
                            <input type="radio" name="process-type" value="simple" 
                                class="peer sr-only" onchange="toggleProcessType()">
                            <div class="border-2 border-gray-300 rounded-lg p-4 peer-checked:border-green-500 peer-checked:bg-green-50 hover:bg-gray-50 transition">
                                <div class="flex items-center justify-between mb-2">
                                    <span class="font-bold text-gray-800">ê°„ë‹¨ ì ‘ìˆ˜</span>
                                    <i class="fas fa-check-circle text-2xl text-gray-300 peer-checked:text-green-500"></i>
                                </div>
                                <div class="text-xs text-gray-600">
                                    â€¢ ê²¬ì  ë¶ˆí•„ìš”<br>
                                    â€¢ ì¦‰ì‹œ ì‘ì—… ê°€ëŠ¥<br>
                                    â€¢ ì¥ì• , ê°„ë‹¨í•œ ìš´ì˜ ì—…ë¬´
                                </div>
                            </div>
                        </label>
                        <label class="relative cursor-pointer">
                            <input type="radio" name="process-type" value="estimate" checked
                                class="peer sr-only" onchange="toggleProcessType()">
                            <div class="border-2 border-gray-300 rounded-lg p-4 peer-checked:border-blue-500 peer-checked:bg-blue-50 hover:bg-gray-50 transition">
                                <div class="flex items-center justify-between mb-2">
                                    <span class="font-bold text-gray-800">ê²¬ì  ì‘ì„±</span>
                                    <i class="fas fa-calculator text-2xl text-gray-300 peer-checked:text-blue-500"></i>
                                </div>
                                <div class="text-xs text-gray-600">
                                    â€¢ ê²¬ì ì„œ í•„ìˆ˜ ì‘ì„±<br>
                                    â€¢ ì„ì› ìŠ¹ì¸ ì—¬ë¶€ ì„ íƒ<br>
                                    â€¢ ê°œë°œ, ì¤‘ìš” ì—…ë¬´
                                </div>
                            </div>
                        </label>
                    </div>
                </div>

                <!-- ì„ì› ìŠ¹ì¸ í•„ìš” ì²´í¬ë°•ìŠ¤ (ê²¬ì  ì‘ì„± ëª¨ë“œì—ì„œë§Œ í‘œì‹œ) -->
                <div id="approval-checkbox-section" class="bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-6">
                    <label class="flex items-start space-x-3 cursor-pointer">
                        <input type="checkbox" id="require-approval" 
                            class="mt-1 rounded w-5 h-5 text-blue-600">
                        <div class="flex-1">
                            <div class="font-semibold text-gray-800 mb-1">
                                <i class="fas fa-user-check text-yellow-600 mr-2"></i>ì„ì› ìŠ¹ì¸ í•„ìš”
                            </div>
                            <div class="text-sm text-gray-600">
                                ì²´í¬ ì‹œ ì„ì› ìŠ¹ì¸ í›„ ì‘ì—… ì§„í–‰ (ìŠ¹ì¸ ëŒ€ê¸° â†’ ì ‘ìˆ˜ â†’ ì²˜ë¦¬ì¤‘)<br>
                                ì²´í¬ í•´ì œ ì‹œ ê²¬ì  ì‘ì„± í›„ ì¦‰ì‹œ ì²˜ë¦¬ì¤‘ ìƒíƒœë¡œ ì´ë™
                            </div>
                        </div>
                    </label>
                </div>

                <!-- ê²¬ì ì„œ ì„¹ì…˜ (ê²¬ì  ì‘ì„± ëª¨ë“œì—ì„œë§Œ í‘œì‹œ) -->
                <div id="estimate-section">
                    <h4 class="font-bold text-gray-800 mb-4 flex items-center">
                        <i class="fas fa-calculator text-green-600 mr-2"></i>ê²¬ì ì„œ ì‘ì„±
                    </h4>

                    <div class="space-y-4 mb-6">
                        <!-- ë“±ê¸‰ë³„ ë§¨ë°ì´ ì…ë ¥ -->
                        <div class="grid grid-cols-4 gap-4">
                            <div class="bg-purple-50 border border-purple-200 rounded-lg p-3">
                                <label class="block text-xs font-semibold text-purple-700 mb-2">íŠ¹ê¸‰ (MD)</label>
                                <input type="number" id="estimate-íŠ¹ê¸‰-md" step="0.1" min="0" value="0"
                                    class="w-full border border-purple-300 rounded px-2 py-1 text-sm"
                                    oninput="calculateEstimate()">
                            </div>
                            <div class="bg-blue-50 border border-blue-200 rounded-lg p-3">
                                <label class="block text-xs font-semibold text-blue-700 mb-2">ê³ ê¸‰ (MD)</label>
                                <input type="number" id="estimate-ê³ ê¸‰-md" step="0.1" min="0" value="0"
                                    class="w-full border border-blue-300 rounded px-2 py-1 text-sm"
                                    oninput="calculateEstimate()">
                            </div>
                            <div class="bg-green-50 border border-green-200 rounded-lg p-3">
                                <label class="block text-xs font-semibold text-green-700 mb-2">ì¤‘ê¸‰ (MD)</label>
                                <input type="number" id="estimate-ì¤‘ê¸‰-md" step="0.1" min="0" value="0"
                                    class="w-full border border-green-300 rounded px-2 py-1 text-sm"
                                    oninput="calculateEstimate()">
                            </div>
                            <div class="bg-gray-50 border border-gray-200 rounded-lg p-3">
                                <label class="block text-xs font-semibold text-gray-700 mb-2">ì´ˆê¸‰ (MD)</label>
                                <input type="number" id="estimate-ì´ˆê¸‰-md" step="0.1" min="0" value="0"
                                    class="w-full border border-gray-300 rounded px-2 py-1 text-sm"
                                    oninput="calculateEstimate()">
                            </div>
                        </div>

                        <!-- ê³„ì‚° ê²°ê³¼ -->
                        <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                            <div class="grid grid-cols-3 gap-4 text-sm">
                                <div>
                                    <span class="text-gray-600">ì´ ë§¨ë°ì´:</span>
                                    <span class="font-bold text-blue-700 ml-2" id="total-mandays">0 MD</span>
                                </div>
                                <div>
                                    <span class="text-gray-600">ì˜ˆìƒ ê¸°ê°„:</span>
                                    <span class="font-bold text-blue-700 ml-2" id="estimated-days">0ì¼</span>
                                </div>
                                <div>
                                    <span class="text-gray-600">ì´ ë¹„ìš©:</span>
                                    <span class="font-bold text-blue-700 ml-2" id="total-cost">â‚©0</span>
                                </div>
                            </div>
                        </div>

                        <!-- ê²¬ì  ê·¼ê±° -->
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2">
                                ê²¬ì  ê·¼ê±° (ì„ íƒ)
                            </label>
                            <textarea id="estimate-note" rows="3" 
                                placeholder="ì˜ˆ: ë¡œê·¸ì¸/íšŒì›ê°€ì… API ê°œë°œ 3MD, í”„ë¡ íŠ¸ì—”ë“œ UI 2MD, í…ŒìŠ¤íŠ¸ 2MD"
                                class="w-full border border-gray-300 rounded-lg px-4 py-3"></textarea>
                        </div>
                    </div>
                </div>

                <div class="flex justify-end space-x-3 mt-8">
                    <button type="button" onclick="closeModal('acceptModal')" 
                        class="px-6 py-3 border border-gray-300 rounded-lg hover:bg-gray-50 transition font-semibold">
                        ì·¨ì†Œ
                    </button>
                    <button type="submit" id="accept-submit-btn"
                        class="px-6 py-3 bg-gradient-to-r from-blue-600 to-green-600 text-white rounded-lg hover:from-blue-700 hover:to-green-700 transition font-semibold shadow-md">
                        <i class="fas fa-calculator mr-2"></i><span id="accept-btn-text">ê²¬ì  ë‚´ê¸°</span>
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Assign Modal (ë‹´ë‹¹ì ë°°ì •) -->
    <div id="assignModal" class="modal">
        <div class="bg-white rounded-2xl shadow-2xl max-w-md w-full mx-4 p-8 animate-slide-in">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-xl font-bold text-gray-800">ë‹´ë‹¹ì ë°°ì •</h3>
                <button onclick="closeModal('assignModal')" class="text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            <form id="assignForm" onsubmit="submitAssignment(event)">
                <input type="hidden" id="assign-ticket-id">
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-3">ë‹´ë‹¹ì ì„ íƒ (ë³µìˆ˜ ì„ íƒ ê°€ëŠ¥)</label>
                        <div class="space-y-2 border rounded-lg p-4 max-h-60 overflow-y-auto">
                            <label class="flex items-center space-x-3 p-2 hover:bg-gray-50 rounded cursor-pointer">
                                <input type="checkbox" name="assignees" value="ê¹€ê°œë°œ" class="rounded w-4 h-4 text-blue-600">
                                <span class="flex-1">ê¹€ê°œë°œ (ë°±ì—”ë“œ)</span>
                            </label>
                            <label class="flex items-center space-x-3 p-2 hover:bg-gray-50 rounded cursor-pointer">
                                <input type="checkbox" name="assignees" value="ì´í”„ë¡ íŠ¸" class="rounded w-4 h-4 text-blue-600">
                                <span class="flex-1">ì´í”„ë¡ íŠ¸ (í”„ë¡ íŠ¸ì—”ë“œ)</span>
                            </label>
                            <label class="flex items-center space-x-3 p-2 hover:bg-gray-50 rounded cursor-pointer">
                                <input type="checkbox" name="assignees" value="ë°•ë””ìì¸" class="rounded w-4 h-4 text-blue-600">
                                <span class="flex-1">ë°•ë””ìì¸ (ë””ìì¸)</span>
                            </label>
                            <label class="flex items-center space-x-3 p-2 hover:bg-gray-50 rounded cursor-pointer">
                                <input type="checkbox" name="assignees" value="ìµœì¸í”„ë¼" class="rounded w-4 h-4 text-blue-600">
                                <span class="flex-1">ìµœì¸í”„ë¼ (ì¸í”„ë¼)</span>
                            </label>
                            <label class="flex items-center space-x-3 p-2 hover:bg-gray-50 rounded cursor-pointer">
                                <input type="checkbox" name="assignees" value="ì •ê¸°íš" class="rounded w-4 h-4 text-blue-600">
                                <span class="flex-1">ì •ê¸°íš (ê¸°íš)</span>
                            </label>
                        </div>
                    </div>
                </div>
                <div class="flex justify-end space-x-3 mt-6">
                    <button type="button" onclick="closeModal('assignModal')" class="px-5 py-2.5 border border-gray-300 rounded-lg hover:bg-gray-50 transition font-semibold">
                        ì·¨ì†Œ
                    </button>
                    <button type="submit" class="px-5 py-2.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition font-semibold">
                        ë°°ì •í•˜ê¸°
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Subtask Modal -->
    <div id="addSubtaskModal" class="modal">
        <div class="bg-white rounded-2xl shadow-2xl max-w-2xl w-full mx-4 p-8 animate-slide-in">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-xl font-bold text-gray-800">í•˜ìœ„ ì—…ë¬´ ì¶”ê°€</h3>
                <div class="flex items-center space-x-2">
                    <button type="button" onclick="fillDemoSubtaskData()" class="text-sm text-blue-600 hover:text-blue-700 font-semibold">
                        <i class="fas fa-magic mr-1"></i>ë°ëª¨ ë°ì´í„° ì±„ìš°ê¸°
                    </button>
                    <button onclick="closeModal('addSubtaskModal')" class="text-gray-400 hover:text-gray-600">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
            </div>
            <form id="addSubtaskForm" onsubmit="submitSubtask(event)">
                <input type="hidden" id="subtask-ticket-id">
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">ì—…ë¬´ ì œëª© *</label>
                        <input type="text" name="title" required class="w-full border border-gray-300 rounded-lg px-4 py-3">
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">ìƒì„¸ ì„¤ëª…</label>
                        <textarea name="description" rows="3" class="w-full border border-gray-300 rounded-lg px-4 py-3"></textarea>
                    </div>
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2">ì‹œì‘ì¼</label>
                            <input type="date" name="startDate" class="w-full border border-gray-300 rounded-lg px-4 py-3">
                        </div>
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2">ì¢…ë£Œì¼</label>
                            <input type="date" name="endDate" class="w-full border border-gray-300 rounded-lg px-4 py-3">
                        </div>
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">ë‹´ë‹¹ì</label>
                        <select name="assignee" class="w-full border border-gray-300 rounded-lg px-4 py-3">
                            <option value="">ì„ íƒí•˜ì„¸ìš”</option>
                            <option value="ê¹€ê°œë°œ">ê¹€ê°œë°œ</option>
                            <option value="ì´í”„ë¡ íŠ¸">ì´í”„ë¡ íŠ¸</option>
                            <option value="ë°•ë””ìì¸">ë°•ë””ìì¸</option>
                            <option value="ìµœì¸í”„ë¼">ìµœì¸í”„ë¼</option>
                            <option value="ì •ê¸°íš">ì •ê¸°íš</option>
                        </select>
                    </div>
                </div>
                <div class="flex justify-end space-x-3 mt-6">
                    <button type="button" onclick="closeModal('addSubtaskModal')" class="px-5 py-2.5 border border-gray-300 rounded-lg hover:bg-gray-50 transition font-semibold">
                        ì·¨ì†Œ
                    </button>
                    <button type="submit" class="px-5 py-2.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition font-semibold">
                        ì¶”ê°€í•˜ê¸°
                    </button>
                </div>
            </form>
        </div>
    </div>

    </div>
    <!-- End of Main Application -->

    <!-- Gantt Quick Edit Modal -->
    <div id="ganttQuickEditModal" class="modal">
        <div class="bg-white rounded-2xl shadow-2xl max-w-md w-full mx-4 p-6 max-h-[90vh] overflow-y-auto animate-slide-in">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-xl font-bold text-gray-800">ì¼ì • ë¹ ë¥¸ ìˆ˜ì •</h3>
                <button onclick="closeModal('ganttQuickEditModal')" class="text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            
            <div id="ganttQuickEditContent" class="space-y-4">
                <!-- Content will be dynamically inserted -->
            </div>
            
            <div class="flex justify-end space-x-3 mt-6 pt-4 border-t">
                <button onclick="closeModal('ganttQuickEditModal')" class="px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition">
                    ì·¨ì†Œ
                </button>
                <button onclick="saveSubtaskQuickEdit()" class="px-6 py-2 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-lg hover:from-blue-700 hover:to-purple-700 transition font-semibold">
                    <i class="fas fa-save mr-2"></i>ì €ì¥
                </button>
            </div>
        </div>
    </div>

    <!-- Context Menu -->
    <div id="ganttContextMenu" class="hidden fixed bg-white rounded-lg shadow-xl border border-gray-200 py-2 z-50" style="min-width: 200px;">
        <button onclick="contextMenuAction('edit')" class="w-full text-left px-4 py-2 hover:bg-gray-100 transition text-sm">
            <i class="fas fa-edit mr-3 text-blue-600"></i>ì¼ì • ìˆ˜ì •
        </button>
        <button onclick="contextMenuAction('complete')" class="w-full text-left px-4 py-2 hover:bg-gray-100 transition text-sm">
            <i class="fas fa-check-circle mr-3 text-green-600"></i>ì™„ë£Œ ì²˜ë¦¬
        </button>
        <button onclick="contextMenuAction('detail')" class="w-full text-left px-4 py-2 hover:bg-gray-100 transition text-sm">
            <i class="fas fa-info-circle mr-3 text-gray-600"></i>í‹°ì¼“ ìƒì„¸
        </button>
        <div class="border-t border-gray-200 my-1"></div>
        <button onclick="contextMenuAction('delete')" class="w-full text-left px-4 py-2 hover:bg-red-50 transition text-sm text-red-600">
            <i class="fas fa-trash mr-3"></i>ì—…ë¬´ ì‚­ì œ
        </button>
    </div>

    <!-- New Project Modal -->
    <div id="newProjectModal" class="modal">
        <div class="bg-white rounded-2xl shadow-2xl max-w-3xl w-full mx-4 p-8 max-h-[90vh] overflow-y-auto animate-slide-in">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-2xl font-bold text-gray-800">ìƒˆ í”„ë¡œì íŠ¸ ìƒì„±</h3>
                <button onclick="closeModal('newProjectModal')" class="text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times text-2xl"></i>
                </button>
            </div>
            <form id="newProjectForm" onsubmit="submitProject(event)">
                <div class="space-y-5">
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">í”„ë¡œì íŠ¸ëª… *</label>
                        <input type="text" name="title" required class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-purple-500">
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">í”„ë¡œì íŠ¸ ì„¤ëª… *</label>
                        <textarea name="description" required rows="4" class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-purple-500"></textarea>
                    </div>
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2">ì‹œì‘ì¼ *</label>
                            <input type="date" name="startDate" required class="w-full border border-gray-300 rounded-lg px-4 py-3">
                        </div>
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2">ì¢…ë£Œì¼ *</label>
                            <input type="date" name="endDate" required class="w-full border border-gray-300 rounded-lg px-4 py-3">
                        </div>
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">ë§í¬ (ì—¬ëŸ¬ ê°œ ì…ë ¥ ê°€ëŠ¥)</label>
                        <div id="project-links-container" class="space-y-2 mb-2">
                            <div class="flex gap-2">
                                <input type="text" placeholder="ë§í¬ ì œëª©" class="flex-1 border border-gray-300 rounded-lg px-4 py-2 text-sm">
                                <input type="url" placeholder="URL" class="flex-1 border border-gray-300 rounded-lg px-4 py-2 text-sm">
                                <button type="button" onclick="removeProjectLink(this)" class="px-3 py-2 bg-red-100 text-red-600 rounded-lg hover:bg-red-200 text-sm">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </div>
                        <button type="button" onclick="addProjectLink()" class="text-sm text-purple-600 hover:text-purple-700 font-semibold">
                            <i class="fas fa-plus mr-1"></i>ë§í¬ ì¶”ê°€
                        </button>
                    </div>
                </div>
                <div class="flex justify-end space-x-3 mt-8">
                    <button type="button" onclick="closeModal('newProjectModal')" class="px-6 py-3 border border-gray-300 rounded-lg hover:bg-gray-50">
                        ì·¨ì†Œ
                    </button>
                    <button type="submit" class="px-6 py-3 bg-gradient-to-r from-purple-600 to-pink-600 text-white rounded-lg hover:from-purple-700 hover:to-pink-700 font-semibold">
                        <i class="fas fa-folder-plus mr-2"></i>í”„ë¡œì íŠ¸ ìƒì„±
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Project Detail Modal -->
    <div id="projectDetailModal" class="modal">
        <div class="bg-white rounded-2xl shadow-2xl max-w-5xl w-full mx-4 p-8 max-h-[90vh] overflow-y-auto animate-slide-in">
            <div class="flex items-center justify-between mb-6">
                <div>
                    <h3 class="text-2xl font-bold text-gray-800" id="detail-project-title"></h3>
                    <p class="text-sm text-gray-500 mt-1" id="detail-project-number"></p>
                </div>
                <button onclick="closeModal('projectDetailModal')" class="text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times text-2xl"></i>
                </button>
            </div>
            <div id="project-detail-content">
                <!-- Project details will be rendered here -->
            </div>
        </div>
    </div>

    <!-- Edit Staff Modal -->
    <div id="editStaffModal" class="modal">
        <div class="bg-white rounded-2xl shadow-2xl max-w-2xl w-full mx-4 p-8 animate-slide-in">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-2xl font-bold text-gray-800">
                    <i class="fas fa-user-edit text-blue-600 mr-2"></i>ì§ì› ì •ë³´ ìˆ˜ì •
                </h3>
                <button onclick="closeModal('editStaffModal')" class="text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times text-2xl"></i>
                </button>
            </div>

            <div class="space-y-6">
                <input type="hidden" id="edit-staff-id">
                
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">ì´ë¦„</label>
                        <input type="text" id="edit-staff-name" readonly
                            class="w-full border border-gray-300 rounded-lg px-4 py-3 bg-gray-50 text-gray-600">
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">ì—­í• </label>
                        <input type="text" id="edit-staff-role" readonly
                            class="w-full border border-gray-300 rounded-lg px-4 py-3 bg-gray-50 text-gray-600">
                    </div>
                </div>

                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">
                            ê²½ë ¥ (ë…„) <span class="text-red-500">*</span>
                        </label>
                        <input type="number" id="edit-staff-years" min="0" max="30"
                            class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">
                            ë“±ê¸‰ <span class="text-red-500">*</span>
                        </label>
                        <select id="edit-staff-grade" onchange="updateStaffRatePreview()"
                            class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500">
                            <option value="ì´ˆê¸‰">ì´ˆê¸‰ (1-2ë…„ì°¨)</option>
                            <option value="ì¤‘ê¸‰">ì¤‘ê¸‰ (3-7ë…„ì°¨)</option>
                            <option value="ê³ ê¸‰">ê³ ê¸‰ (8-9ë…„ì°¨)</option>
                            <option value="íŠ¹ê¸‰">íŠ¹ê¸‰ (10ë…„ ì´ìƒ)</option>
                        </select>
                    </div>
                </div>

                <div>
                    <label class="block text-sm font-semibold text-gray-700 mb-2">
                        ëŒ€ë¶„ë¥˜ ë‹´ë‹¹ <span class="text-red-500">*</span>
                    </label>
                    <select id="edit-staff-category"
                        class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500">
                        <option value="ì˜¤ì•„ì‹œìŠ¤">ì˜¤ì•„ì‹œìŠ¤</option>
                        <option value="ì¸í”„ë¼">ì¸í”„ë¼</option>
                        <option value="í™˜ê²½">í™˜ê²½</option>
                        <option value="ë¶€ë™ì‚°">ë¶€ë™ì‚°</option>
                        <option value="ê¸°íƒ€">ê¸°íƒ€</option>
                    </select>
                </div>

                <!-- ìš”ìœ¨ ë¯¸ë¦¬ë³´ê¸° -->
                <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                    <h4 class="font-semibold text-gray-800 mb-3">
                        <i class="fas fa-calculator text-blue-600 mr-2"></i>ì ìš© ìš”ìœ¨
                    </h4>
                    <div class="grid grid-cols-3 gap-4 text-sm">
                        <div>
                            <span class="text-gray-600">ì‹œê¸‰:</span>
                            <span class="font-bold text-gray-800 ml-2" id="preview-hourly">â‚©37,500</span>
                        </div>
                        <div>
                            <span class="text-gray-600">ì¼ê¸‰:</span>
                            <span class="font-bold text-gray-800 ml-2" id="preview-daily">â‚©300,000</span>
                        </div>
                        <div>
                            <span class="text-gray-600">ì›”ê¸‰:</span>
                            <span class="font-bold text-gray-800 ml-2" id="preview-monthly">â‚©6,300,000</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="flex justify-end space-x-3 mt-8">
                <button type="button" onclick="closeModal('editStaffModal')" 
                    class="px-6 py-3 border border-gray-300 rounded-lg hover:bg-gray-50 transition font-semibold">
                    ì·¨ì†Œ
                </button>
                <button type="button" onclick="saveStaffEdit()" 
                    class="px-6 py-3 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-lg hover:from-blue-700 hover:to-purple-700 transition font-semibold shadow-md">
                    <i class="fas fa-save mr-2"></i>ì €ì¥
                </button>
            </div>
        </div>
    </div>

    <!-- Add Staff Modal -->
    <div id="addStaffModal" class="modal">
        <div class="bg-white rounded-2xl shadow-2xl max-w-2xl w-full mx-4 p-8 animate-slide-in">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-2xl font-bold text-gray-800">
                    <i class="fas fa-user-plus text-green-600 mr-2"></i>ìƒˆ ì§ì› ì¶”ê°€
                </h3>
                <button onclick="closeModal('addStaffModal')" class="text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times text-2xl"></i>
                </button>
            </div>

            <div class="space-y-6">
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">
                            ì´ë¦„ <span class="text-red-500">*</span>
                        </label>
                        <input type="text" id="add-staff-name" placeholder="ì˜ˆ: ê¹€ê°œë°œ"
                            class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">
                            ì—­í•  <span class="text-red-500">*</span>
                        </label>
                        <input type="text" id="add-staff-role" placeholder="ì˜ˆ: ë°±ì—”ë“œ ê°œë°œì"
                            class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500">
                    </div>
                </div>

                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">
                            ê²½ë ¥ (ë…„) <span class="text-red-500">*</span>
                        </label>
                        <input type="number" id="add-staff-years" min="0" max="30" value="3"
                            class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">
                            ë“±ê¸‰ <span class="text-red-500">*</span>
                        </label>
                        <select id="add-staff-grade" onchange="updateAddStaffRatePreview()"
                            class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500">
                            <option value="ì´ˆê¸‰">ì´ˆê¸‰ (1-2ë…„ì°¨)</option>
                            <option value="ì¤‘ê¸‰" selected>ì¤‘ê¸‰ (3-7ë…„ì°¨)</option>
                            <option value="ê³ ê¸‰">ê³ ê¸‰ (8-9ë…„ì°¨)</option>
                            <option value="íŠ¹ê¸‰">íŠ¹ê¸‰ (10ë…„ ì´ìƒ)</option>
                        </select>
                    </div>
                </div>

                <div>
                    <label class="block text-sm font-semibold text-gray-700 mb-2">
                        ëŒ€ë¶„ë¥˜ ë‹´ë‹¹ <span class="text-red-500">*</span>
                    </label>
                    <select id="add-staff-category"
                        class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500">
                        <option value="ì˜¤ì•„ì‹œìŠ¤">ì˜¤ì•„ì‹œìŠ¤</option>
                        <option value="ì¸í”„ë¼">ì¸í”„ë¼</option>
                        <option value="í™˜ê²½">í™˜ê²½</option>
                        <option value="ë¶€ë™ì‚°">ë¶€ë™ì‚°</option>
                        <option value="ê¸°íƒ€">ê¸°íƒ€</option>
                    </select>
                </div>

                <!-- ìš”ìœ¨ ë¯¸ë¦¬ë³´ê¸° -->
                <div class="bg-green-50 border border-green-200 rounded-lg p-4">
                    <h4 class="font-semibold text-gray-800 mb-3">
                        <i class="fas fa-calculator text-green-600 mr-2"></i>ì ìš© ìš”ìœ¨
                    </h4>
                    <div class="grid grid-cols-3 gap-4 text-sm">
                        <div>
                            <span class="text-gray-600">ì‹œê¸‰:</span>
                            <span class="font-bold text-gray-800 ml-2" id="add-preview-hourly">â‚©37,500</span>
                        </div>
                        <div>
                            <span class="text-gray-600">ì¼ê¸‰:</span>
                            <span class="font-bold text-gray-800 ml-2" id="add-preview-daily">â‚©300,000</span>
                        </div>
                        <div>
                            <span class="text-gray-600">ì›”ê¸‰:</span>
                            <span class="font-bold text-gray-800 ml-2" id="add-preview-monthly">â‚©6,300,000</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="flex justify-end space-x-3 mt-8">
                <button type="button" onclick="closeModal('addStaffModal')" 
                    class="px-6 py-3 border border-gray-300 rounded-lg hover:bg-gray-50 transition font-semibold">
                    ì·¨ì†Œ
                </button>
                <button type="button" onclick="saveNewStaff()" 
                    class="px-6 py-3 bg-gradient-to-r from-green-600 to-blue-600 text-white rounded-lg hover:from-green-700 hover:to-blue-700 transition font-semibold shadow-md">
                    <i class="fas fa-user-plus mr-2"></i>ì¶”ê°€
                </button>
            </div>
        </div>
    </div>

    <!-- Edit Rates Modal -->
    <div id="editRatesModal" class="modal">
        <div class="bg-white rounded-2xl shadow-2xl max-w-3xl w-full mx-4 p-8 max-h-[90vh] overflow-y-auto animate-slide-in">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-2xl font-bold text-gray-800">
                    <i class="fas fa-coins text-yellow-500 mr-2"></i>ë“±ê¸‰ë³„ ê¸°ì¤€ ë‹¨ê°€ ìˆ˜ì •
                </h3>
                <button onclick="closeModal('editRatesModal')" class="text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times text-2xl"></i>
                </button>
            </div>

            <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-4">
                <p class="text-sm text-yellow-800">
                    <i class="fas fa-exclamation-triangle mr-2"></i>
                    <strong>ì£¼ì˜:</strong> ë‹¨ê°€ ë³€ê²½ì€ ëª¨ë“  IT ì§ì›ì˜ ìš”ìœ¨ì— ì¦‰ì‹œ ë°˜ì˜ë˜ë©°, ë³€ê²½ ì´ë ¥ì´ ì €ì¥ë©ë‹ˆë‹¤.
                </p>
            </div>

            <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6">
                <p class="text-sm text-blue-800 font-semibold mb-2">
                    <i class="fas fa-info-circle mr-2"></i>ì‚¬ìš© ë°©ë²•
                </p>
                <ul class="text-xs text-blue-700 space-y-1 ml-6 list-disc">
                    <li><strong>ì‹œê¸‰ (ì›)</strong> í•„ë“œì— ì›í•˜ëŠ” ê¸ˆì•¡ì„ ì…ë ¥í•˜ì„¸ìš”</li>
                    <li>ì…ë ¥í•˜ë©´ <strong>ì¼ê¸‰</strong>ê³¼ <strong>ì›”ê¸‰</strong>ì´ ìë™ìœ¼ë¡œ ê³„ì‚°ë©ë‹ˆë‹¤</li>
                    <li>ê³„ì‚° ê¸°ì¤€: ì¼ê¸‰ = ì‹œê¸‰ Ã— 8ì‹œê°„ / ì›”ê¸‰ = ì¼ê¸‰ Ã— 21ì¼</li>
                </ul>
            </div>

            <div class="space-y-6">
                <!-- íŠ¹ê¸‰ -->
                <div class="bg-purple-50 border border-purple-200 rounded-lg p-4">
  <div class="font-bold text-purple-700 mb-3 flex items-center">
                        ğŸŒŸ íŠ¹ê¸‰ (10ë…„ ì´ìƒ)
                    </div>
                    <div class="grid grid-cols-3 gap-4">
                        <div>
                            <label class="block text-xs font-semibold text-gray-700 mb-1">
                                ì‹œê¸‰ (ì›) <span class="text-blue-600">â† ì…ë ¥</span>
                            </label>
                            <input type="number" id="edit-rate-íŠ¹ê¸‰-hourly" 
                                placeholder="ì‹œê¸‰ ì…ë ¥"
                                class="w-full border-2 border-blue-300 rounded-lg px-3 py-2 text-sm font-semibold focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-xs font-semibold text-gray-700 mb-1">
                                ì¼ê¸‰ (ì›) <span class="text-gray-500">ìë™</span>
                            </label>
                            <input type="text" id="edit-rate-íŠ¹ê¸‰-daily" 
                                placeholder="ìë™ ê³„ì‚°"
                                class="w-full border border-gray-300 rounded-lg px-3 py-2 text-sm bg-gray-100 text-gray-700" readonly>
                        </div>
                        <div>
                            <label class="block text-xs font-semibold text-gray-700 mb-1">
                                ì›”ê¸‰ (ì›) <span class="text-gray-500">ìë™</span>
                            </label>
                            <input type="text" id="edit-rate-íŠ¹ê¸‰-monthly" 
                                placeholder="ìë™ ê³„ì‚°"
                                class="w-full border border-gray-300 rounded-lg px-3 py-2 text-sm bg-gray-100 text-gray-700" readonly>
                        </div>
                    </div>
                </div>

                <!-- ê³ ê¸‰ -->
                <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                    <div class="font-bold text-blue-700 mb-3 flex items-center">
                        â­ ê³ ê¸‰ (8-9ë…„ì°¨)
                    </div>
                    <div class="grid grid-cols-3 gap-4">
                        <div>
                            <label class="block text-xs font-semibold text-gray-700 mb-1">
                                ì‹œê¸‰ (ì›) <span class="text-blue-600">â† ì…ë ¥</span>
                            </label>
                            <input type="number" id="edit-rate-ê³ ê¸‰-hourly" 
                                placeholder="ì‹œê¸‰ ì…ë ¥"
                                class="w-full border-2 border-blue-300 rounded-lg px-3 py-2 text-sm font-semibold focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-xs font-semibold text-gray-700 mb-1">
                                ì¼ê¸‰ (ì›) <span class="text-gray-500">ìë™</span>
                            </label>
                            <input type="text" id="edit-rate-ê³ ê¸‰-daily" 
                                placeholder="ìë™ ê³„ì‚°"
                                class="w-full border border-gray-300 rounded-lg px-3 py-2 text-sm bg-gray-100 text-gray-700" readonly>
                        </div>
                        <div>
                            <label class="block text-xs font-semibold text-gray-700 mb-1">
                                ì›”ê¸‰ (ì›) <span class="text-gray-500">ìë™</span>
                            </label>
                            <input type="text" id="edit-rate-ê³ ê¸‰-monthly" 
                                placeholder="ìë™ ê³„ì‚°"
                                class="w-full border border-gray-300 rounded-lg px-3 py-2 text-sm bg-gray-100 text-gray-700" readonly>
                        </div>
                    </div>
                </div>

                <!-- ì¤‘ê¸‰ -->
                <div class="bg-green-50 border border-green-200 rounded-lg p-4">
                    <div class="font-bold text-green-700 mb-3 flex items-center">
                        âœ“ ì¤‘ê¸‰ (3-7ë…„ì°¨)
                    </div>
                    <div class="grid grid-cols-3 gap-4">
                        <div>
                            <label class="block text-xs font-semibold text-gray-700 mb-1">
                                ì‹œê¸‰ (ì›) <span class="text-blue-600">â† ì…ë ¥</span>
                            </label>
                            <input type="number" id="edit-rate-ì¤‘ê¸‰-hourly" 
                                placeholder="ì‹œê¸‰ ì…ë ¥"
                                class="w-full border-2 border-blue-300 rounded-lg px-3 py-2 text-sm font-semibold focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-xs font-semibold text-gray-700 mb-1">
                                ì¼ê¸‰ (ì›) <span class="text-gray-500">ìë™</span>
                            </label>
                            <input type="text" id="edit-rate-ì¤‘ê¸‰-daily" 
                                placeholder="ìë™ ê³„ì‚°"
                                class="w-full border border-gray-300 rounded-lg px-3 py-2 text-sm bg-gray-100 text-gray-700" readonly>
                        </div>
                        <div>
                            <label class="block text-xs font-semibold text-gray-700 mb-1">
                                ì›”ê¸‰ (ì›) <span class="text-gray-500">ìë™</span>
                            </label>
                            <input type="text" id="edit-rate-ì¤‘ê¸‰-monthly" 
                                placeholder="ìë™ ê³„ì‚°"
                                class="w-full border border-gray-300 rounded-lg px-3 py-2 text-sm bg-gray-100 text-gray-700" readonly>
                        </div>
                    </div>
                </div>

                <!-- ì´ˆê¸‰ -->
                <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                    <div class="font-bold text-gray-700 mb-3 flex items-center">
                        â€¢ ì´ˆê¸‰ (1-2ë…„ì°¨)
                    </div>
                    <div class="grid grid-cols-3 gap-4">
                        <div>
                            <label class="block text-xs font-semibold text-gray-700 mb-1">
                                ì‹œê¸‰ (ì›) <span class="text-blue-600">â† ì…ë ¥</span>
                            </label>
                            <input type="number" id="edit-rate-ì´ˆê¸‰-hourly" 
                                placeholder="ì‹œê¸‰ ì…ë ¥"
                                class="w-full border-2 border-blue-300 rounded-lg px-3 py-2 text-sm font-semibold focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-xs font-semibold text-gray-700 mb-1">
                                ì¼ê¸‰ (ì›) <span class="text-gray-500">ìë™</span>
                            </label>
                            <input type="text" id="edit-rate-ì´ˆê¸‰-daily" 
                                placeholder="ìë™ ê³„ì‚°"
                                class="w-full border border-gray-300 rounded-lg px-3 py-2 text-sm bg-gray-100 text-gray-700" readonly>
                        </div>
                        <div>
                            <label class="block text-xs font-semibold text-gray-700 mb-1">
                                ì›”ê¸‰ (ì›) <span class="text-gray-500">ìë™</span>
                            </label>
                            <input type="text" id="edit-rate-ì´ˆê¸‰-monthly" 
                                placeholder="ìë™ ê³„ì‚°"
                                class="w-full border border-gray-300 rounded-lg px-3 py-2 text-sm bg-gray-100 text-gray-700" readonly>
                        </div>
                    </div>
                </div>

                <!-- ë³€ê²½ ì‚¬ìœ  -->
                <div>
                    <label class="block text-sm font-semibold text-gray-700 mb-2">ë³€ê²½ ì‚¬ìœ </label>
                    <textarea id="rate-change-note" rows="3" placeholder="ì˜ˆ: 2025ë…„ ì„ê¸ˆ ì¸ìƒë¥  ë°˜ì˜"
                        class="w-full border border-gray-300 rounded-lg px-4 py-3"></textarea>
                </div>
            </div>

            <div class="flex justify-end space-x-3 mt-8">
                <button type="button" onclick="closeModal('editRatesModal')" 
                    class="px-6 py-3 border border-gray-300 rounded-lg hover:bg-gray-50 transition font-semibold">
                    ì·¨ì†Œ
                </button>
                <button type="button" onclick="saveRateChanges()" 
                    class="px-6 py-3 bg-gradient-to-r from-yellow-500 to-orange-500 text-white rounded-lg hover:from-yellow-600 hover:to-orange-600 transition font-semibold shadow-md">
                    <i class="fas fa-save mr-2"></i>ë‹¨ê°€ ë³€ê²½
                </button>
            </div>
        </div>
    </div>

    <!-- Rate History Modal -->
    <div id="rateHistoryModal" class="modal">
        <div class="bg-white rounded-2xl shadow-2xl max-w-4xl w-full mx-4 p-8 max-h-[90vh] overflow-y-auto animate-slide-in">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-2xl font-bold text-gray-800">
                    <i class="fas fa-history text-blue-500 mr-2"></i>ë‹¨ê°€ ë³€ê²½ ì´ë ¥
                </h3>
                <button onclick="closeModal('rateHistoryModal')" class="text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times text-2xl"></i>
                </button>
            </div>

            <div class="space-y-4" id="rate-history-list">
                <!-- History will be rendered here -->
            </div>
        </div>
    </div>

    <!-- Link Ticket Modal -->
    <div id="linkTicketModal" class="modal">
        <div class="bg-white rounded-2xl shadow-2xl max-w-2xl w-full mx-4 p-6 max-h-[90vh] overflow-y-auto animate-slide-in">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-xl font-bold text-gray-800">í‹°ì¼“ ì—°ê²°í•˜ê¸°</h3>
                <button onclick="closeModal('linkTicketModal')" class="text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            
            <div class="mb-6">
                <label class="block text-sm font-semibold text-gray-700 mb-2">ê²€ìƒ‰</label>
                <input type="text" id="linkTicketSearch" oninput="searchLinkableTickets()" 
                       class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500" 
                       placeholder="í‹°ì¼“ë²ˆí˜¸ ë˜ëŠ” ì œëª©ìœ¼ë¡œ ê²€ìƒ‰ (ì˜ˆ: TKT-2024-001)">
            </div>

            <div class="mb-4">
                <label class="block text-sm font-semibold text-gray-700 mb-2">ì¹´í…Œê³ ë¦¬ í•„í„°</label>
                <select id="linkTicketCategoryFilter" onchange="searchLinkableTickets()" 
                        class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500">
                    <option value="">ì „ì²´ ì¹´í…Œê³ ë¦¬</option>
                    <option value="ì˜¤ì•„ì‹œìŠ¤">ì˜¤ì•„ì‹œìŠ¤</option>
                    <option value="ì¸í”„ë¼">ì¸í”„ë¼</option>
                    <option value="ë¶€ë™ì‚°">ë¶€ë™ì‚°</option>
                    <option value="í™˜ê²½">í™˜ê²½</option>
                    <option value="GMS">GMS</option>
                    <option value="ê¸°íƒ€">ê¸°íƒ€</option>
                </select>
            </div>
            
            <div class="mb-4">
                <div class="flex items-center justify-between">
                    <span class="text-sm font-semibold text-gray-700">ê²€ìƒ‰ ê²°ê³¼</span>
                    <span class="text-xs text-gray-500" id="linkTicketCount">0ê°œ</span>
                </div>
            </div>

            <div id="linkableTicketsList" class="space-y-2 mb-6 max-h-96 overflow-y-auto">
                <!-- ê²€ìƒ‰ ê²°ê³¼ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
            </div>
            
            <div class="flex justify-end space-x-3 pt-4 border-t">
                <button onclick="closeModal('linkTicketModal')" class="px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition">
                    ì·¨ì†Œ
                </button>
                <button onclick="saveLinkTickets()" class="px-6 py-2 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-lg hover:from-blue-700 hover:to-purple-700 transition font-semibold">
                    <i class="fas fa-link mr-2"></i>ì—°ê²°í•˜ê¸°
                </button>
            </div>
        </div>
    </div>

    <!-- System Settings Modal -->
    <div id="systemSettingsModal" class="modal">
        <div class="bg-white rounded-2xl shadow-2xl max-w-2xl w-full mx-4 p-8 animate-slide-in">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-2xl font-bold text-gray-800">
                    <i class="fas fa-cog text-green-600 mr-2"></i>ì‹œìŠ¤í…œ ì„¤ì •
                </h3>
                <button onclick="closeModal('systemSettingsModal')" class="text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times text-2xl"></i>
                </button>
            </div>

            <div class="space-y-6">
                <!-- ê²¬ì  í™•ì¸ ê¸ˆì•¡ ì„¤ì • -->
                <div class="bg-gradient-to-r from-green-50 to-teal-50 border border-green-200 rounded-lg p-6">
                    <h4 class="font-bold text-gray-800 mb-4 flex items-center">
                        <i class="fas fa-dollar-sign text-green-600 mr-2"></i>ê²¬ì  í™•ì¸ í•„ìš” ê¸ˆì•¡ ê¸°ì¤€
                    </h4>
                    
                    <div class="mb-4">
                        <label class="block text-sm font-semibold text-gray-700 mb-2">
                            ê¸ˆì•¡ ê¸°ì¤€ (ì›)
                        </label>
                        <input type="number" id="threshold-input" 
                            value="5000000" 
                            min="0" 
                            step="100000"
                            class="w-full border-2 border-green-300 rounded-lg px-4 py-3 text-lg font-semibold focus:ring-2 focus:ring-green-500"
                            placeholder="ì˜ˆ: 5000000">
                        <div class="text-xs text-gray-600 mt-2">
                            ğŸ’¡ ì´ ê¸ˆì•¡ ì´ìƒì˜ ê²¬ì ì€ ì‹ ì²­ìì˜ í™•ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤
                        </div>
                    </div>

                    <div class="bg-white rounded-lg p-4 border border-gray-200">
                        <div class="text-sm font-semibold text-gray-700 mb-2">í˜„ì¬ ì„¤ì •</div>
                        <div class="text-2xl font-bold text-green-600" id="current-threshold-display">
                            â‚©5,000,000
                        </div>
                    </div>

                    <div class="mt-4 p-4 bg-blue-50 border border-blue-200 rounded-lg">
                        <div class="text-sm text-blue-800">
                            <strong>ğŸ“‹ ê²¬ì  í™•ì¸ ì¡°ê±´:</strong>
                        </div>
                        <ul class="text-sm text-blue-700 mt-2 space-y-1">
                            <li>âœ“ ì„¤ì • ê¸ˆì•¡ ì´ìƒì˜ ê²¬ì </li>
                            <li>âœ“ ê°œë°œìš”ì²­ ì¹´í…Œê³ ë¦¬ (ê¸ˆì•¡ ë¬´ê´€)</li>
                        </ul>
                        <div class="text-xs text-blue-600 mt-2">
                            ìœ„ ì¡°ê±´ì— í•´ë‹¹í•˜ë©´ ì‹ ì²­ìê°€ ê²¬ì ì„ í™•ì¸í•œ í›„ ì§„í–‰í•©ë‹ˆë‹¤
                        </div>
                    </div>
                </div>
            </div>

            <div class="flex justify-end space-x-3 mt-8">
                <button type="button" onclick="closeModal('systemSettingsModal')" 
                    class="px-6 py-3 border border-gray-300 rounded-lg hover:bg-gray-50 transition font-semibold">
                    ì·¨ì†Œ
                </button>
                <button type="button" onclick="saveSystemSettings()" 
                    class="px-6 py-3 bg-gradient-to-r from-green-500 to-teal-500 text-white rounded-lg hover:from-green-600 hover:to-teal-600 transition font-semibold shadow-md">
                    <i class="fas fa-save mr-2"></i>ì„¤ì • ì €ì¥
                </button>
            </div>
        </div>
    </div>

    <!-- ê²¬ì ì„œ ëª¨ë‹¬ -->
    <div id="quotationModal" class="modal">
        <div class="bg-white rounded-2xl shadow-2xl max-w-5xl w-full mx-4 p-8 max-h-[90vh] overflow-y-auto animate-slide-in">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-2xl font-bold text-gray-800">
                    <i class="fas fa-file-invoice-dollar text-blue-600 mr-2"></i>
                    IT ìš©ì—­ ê²¬ì ì„œ
                </h3>
                <div class="flex items-center gap-3">
                    <button onclick="printQuotation()" class="px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition font-semibold text-sm">
                        <i class="fas fa-print mr-2"></i>ì¸ì‡„
                    </button>
                    <button onclick="downloadQuotation()" class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition font-semibold text-sm">
                        <i class="fas fa-download mr-2"></i>ë‹¤ìš´ë¡œë“œ
                    </button>
                    <button onclick="closeModal('quotationModal')" class="text-gray-400 hover:text-gray-600 transition">
                        <i class="fas fa-times text-2xl"></i>
                    </button>
                </div>
            </div>
            <div id="quotation-content" class="bg-white">
                <!-- ê²¬ì ì„œ ë‚´ìš©ì´ ì—¬ê¸°ì— ë Œë”ë§ë©ë‹ˆë‹¤ -->
            </div>
        </div>
    </div>

    <!-- ğŸ†• ìì‚° ìš”ì²­ ëª¨ë‹¬ë“¤ -->
    
    <!-- ìì‚° ìœ í˜• ì„ íƒ ëª¨ë‹¬ -->
    <div id="assetTypeModal" class="modal">
        <div class="bg-white rounded-2xl shadow-2xl max-w-2xl w-full mx-4 p-8 animate-slide-in">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-2xl font-bold text-gray-800">
                    <i class="fas fa-laptop text-purple-500 mr-2"></i>IT ìì‚° ìš”ì²­
                </h3>
                <button onclick="closeModal('assetTypeModal')" class="text-gray-400 hover:text-gray-600 transition">
                    <i class="fas fa-times text-2xl"></i>
                </button>
            </div>
            
            <p class="text-gray-600 mb-6">ìš”ì²­í•˜ì‹¤ ìì‚° ìœ í˜•ì„ ì„ íƒí•´ì£¼ì„¸ìš”</p>
            
            <div class="space-y-4">
                <!-- í•˜ë“œì›¨ì–´ -->
                <div onclick="selectAssetType('í•˜ë“œì›¨ì–´')" 
                     class="border-2 border-gray-200 rounded-xl p-6 cursor-pointer hover:border-purple-500 hover:bg-purple-50 transition-all group">
                    <div class="flex items-start justify-between">
                        <div class="flex items-start space-x-4">
                            <div class="w-14 h-14 bg-purple-100 rounded-lg flex items-center justify-center group-hover:bg-purple-200 transition">
                                <i class="fas fa-laptop text-purple-600 text-2xl"></i>
                            </div>
                            <div>
                                <h4 class="text-lg font-bold text-gray-800 mb-1">ğŸ’» í•˜ë“œì›¨ì–´</h4>
                                <p class="text-sm text-gray-600">PC, ë…¸íŠ¸ë¶, ëª¨ë‹ˆí„°, í”„ë¦°í„° ë“±</p>
                                <div class="flex flex-wrap gap-1 mt-2">
                                    <span class="text-xs px-2 py-1 bg-purple-100 text-purple-700 rounded">ì‹ ê·œ ì§€ê¸‰</span>
                                    <span class="text-xs px-2 py-1 bg-purple-100 text-purple-700 rounded">ê³ ì¥ ì‹ ê³ </span>
                                    <span class="text-xs px-2 py-1 bg-purple-100 text-purple-700 rounded">ë³€ê²½ ìš”ì²­</span>
                                </div>
                            </div>
                        </div>
                        <i class="fas fa-chevron-right text-gray-400 group-hover:text-purple-600 group-hover:translate-x-1 transition"></i>
                    </div>
                </div>

                <!-- ì†Œí”„íŠ¸ì›¨ì–´ -->
                <div onclick="selectAssetType('ì†Œí”„íŠ¸ì›¨ì–´')" 
                     class="border-2 border-gray-200 rounded-xl p-6 cursor-pointer hover:border-blue-500 hover:bg-blue-50 transition-all group">
                    <div class="flex items-start justify-between">
                        <div class="flex items-start space-x-4">
                            <div class="w-14 h-14 bg-blue-100 rounded-lg flex items-center justify-center group-hover:bg-blue-200 transition">
                                <i class="fas fa-key text-blue-600 text-2xl"></i>
                            </div>
                            <div>
                                <h4 class="text-lg font-bold text-gray-800 mb-1">ğŸ”‘ ì†Œí”„íŠ¸ì›¨ì–´ / ë¼ì´ì„ ìŠ¤</h4>
                                <p class="text-sm text-gray-600">í•œê¸€, MS Office, Adobe, ê°œë°œë„êµ¬ ë“±</p>
                                <div class="flex flex-wrap gap-1 mt-2">
                                    <span class="text-xs px-2 py-1 bg-blue-100 text-blue-700 rounded">ì‹ ê·œ ë°œê¸‰</span>
                                    <span class="text-xs px-2 py-1 bg-blue-100 text-blue-700 rounded">ê°±ì‹  ìš”ì²­</span>
                                    <span class="text-xs px-2 py-1 bg-blue-100 text-blue-700 rounded">ì¶”ê°€ ë¼ì´ì„ ìŠ¤</span>
                                </div>
                            </div>
                        </div>
                        <i class="fas fa-chevron-right text-gray-400 group-hover:text-blue-600 group-hover:translate-x-1 transition"></i>
                    </div>
                </div>

                <!-- í´ë¼ìš°ë“œ -->
                <div onclick="selectAssetType('í´ë¼ìš°ë“œ')" 
                     class="border-2 border-gray-200 rounded-xl p-6 cursor-pointer hover:border-green-500 hover:bg-green-50 transition-all group">
                    <div class="flex items-start justify-between">
                        <div class="flex items-start space-x-4">
                            <div class="w-14 h-14 bg-green-100 rounded-lg flex items-center justify-center group-hover:bg-green-200 transition">
                                <i class="fas fa-cloud text-green-600 text-2xl"></i>
                            </div>
                            <div>
                                <h4 class="text-lg font-bold text-gray-800 mb-1">â˜ï¸ í´ë¼ìš°ë“œ ì„œë¹„ìŠ¤</h4>
                                <p class="text-sm text-gray-600">AWS, Azure, GCP, SaaS, ìŠ¤í† ë¦¬ì§€ ë“±</p>
                                <div class="flex flex-wrap gap-1 mt-2">
                                    <span class="text-xs px-2 py-1 bg-green-100 text-green-700 rounded">ê³„ì • ë°œê¸‰</span>
                                    <span class="text-xs px-2 py-1 bg-green-100 text-green-700 rounded">ìš©ëŸ‰ ì¦ì„¤</span>
                                    <span class="text-xs px-2 py-1 bg-green-100 text-green-700 rounded">ì„œë¹„ìŠ¤ ì¶”ê°€</span>
                                </div>
                            </div>
                        </div>
                        <i class="fas fa-chevron-right text-gray-400 group-hover:text-green-600 group-hover:translate-x-1 transition"></i>
                    </div>
                </div>
            </div>

            <div class="mt-6 flex justify-end">
                <button type="button" onclick="closeModal('assetTypeModal')" 
                        class="px-6 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition font-semibold">
                    ì·¨ì†Œ
                </button>
            </div>
        </div>
    </div>

    <!-- í•˜ë“œì›¨ì–´ ìš”ì²­ ëª¨ë‹¬ -->
    <div id="assetHardwareModal" class="modal">
        <div class="bg-white rounded-2xl shadow-2xl max-w-3xl w-full mx-4 p-8 animate-slide-in max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-2xl font-bold text-gray-800">
                    <i class="fas fa-laptop text-purple-500 mr-2"></i>í•˜ë“œì›¨ì–´ ìš”ì²­
                </h3>
                <button onclick="closeModal('assetHardwareModal')" class="text-gray-400 hover:text-gray-600 transition">
                    <i class="fas fa-times text-2xl"></i>
                </button>
            </div>
            
            <form id="assetHardwareForm" onsubmit="submitAssetHardwareRequest(event)">
                <div class="space-y-6">
                    <!-- ìš”ì²­ ìœ í˜• -->
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-3">ìš”ì²­ ìœ í˜• *</label>
                        <div class="grid grid-cols-3 gap-3">
                            <label class="relative flex items-center p-4 border-2 border-gray-200 rounded-lg cursor-pointer hover:border-purple-500 transition">
                                <input type="radio" name="hwRequestType" id="asset-hw-type-new" value="ì§€ê¸‰" checked onchange="onHwRequestTypeChange()" class="mr-3">
                                <div>
                                    <div class="font-semibold text-gray-800">ì‹ ê·œ ì§€ê¸‰</div>
                                    <div class="text-xs text-gray-500">ìƒˆ ì¥ë¹„ ì‹ ì²­</div>
                                </div>
                            </label>
                            <label class="relative flex items-center p-4 border-2 border-gray-200 rounded-lg cursor-pointer hover:border-red-500 transition">
                                <input type="radio" name="hwRequestType" value="ê³ ì¥" onchange="onHwRequestTypeChange()" class="mr-3">
                                <div>
                                    <div class="font-semibold text-gray-800">ê³ ì¥ ì‹ ê³ </div>
                                    <div class="text-xs text-gray-500">ìˆ˜ë¦¬ ìš”ì²­</div>
                                </div>
                            </label>
                            <label class="relative flex items-center p-4 border-2 border-gray-200 rounded-lg cursor-pointer hover:border-blue-500 transition">
                                <input type="radio" name="hwRequestType" value="ë³€ê²½" onchange="onHwRequestTypeChange()" class="mr-3">
                                <div>
                                    <div class="font-semibold text-gray-800">ë³€ê²½ ìš”ì²­</div>
                                    <div class="text-xs text-gray-500">êµì²´/ì—…ê·¸ë ˆì´ë“œ</div>
                                </div>
                            </label>
                        </div>
                    </div>

                    <!-- ì‹ ê·œ ì§€ê¸‰ ì„¹ì…˜ -->
                    <div id="hw-new-section">
                        <!-- ì‚¬ìš©ì ì„ íƒ -->
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-3">ì‚¬ìš©ì ì„ íƒ *</label>
                            <div class="space-y-3">
                                <label class="flex items-center p-3 border-2 border-gray-200 rounded-lg cursor-pointer hover:border-purple-500 transition">
                                    <input type="radio" name="hwUser" id="asset-hw-user-self" value="self" checked onchange="toggleOtherUserSection()" class="mr-3">
                                    <span class="font-semibold">ë³¸ì¸ (<span id="current-user-name-hw">${currentUser?.name || 'ì‚¬ìš©ì'}</span>)</span>
                                </label>
                                <label class="flex items-center p-3 border-2 border-gray-200 rounded-lg cursor-pointer hover:border-purple-500 transition">
                                    <input type="radio" name="hwUser" value="other" onchange="toggleOtherUserSection()" class="mr-3">
                                    <span class="font-semibold">íƒ€ì¸ (íŒ€ì›/ì‹ ê·œì…ì‚¬ì)</span>
                                </label>
                                <div id="asset-hw-user-other-section" style="display:none;" class="ml-8">
                                    <input type="text" id="asset-hw-user-other" 
                                           placeholder="ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”" 
                                           class="w-full border border-gray-300 rounded-lg px-4 py-2">
                                </div>
                            </div>
                        </div>

                        <!-- ì§ê¸‰ -->
                        <div class="mt-6">
                            <label class="block text-sm font-semibold text-gray-700 mb-2">ì§ê¸‰ *</label>
                            <select id="asset-hw-grade" onchange="updateRecommendedAssets()" 
                                    class="w-full border border-gray-300 rounded-lg px-4 py-2">
                                <option value="ì‚¬ì›">ì‚¬ì›</option>
                                <option value="ëŒ€ë¦¬">ëŒ€ë¦¬</option>
                                <option value="ê³¼ì¥" selected>ê³¼ì¥</option>
                                <option value="ì°¨ì¥">ì°¨ì¥</option>
                                <option value="ë¶€ì¥">ë¶€ì¥</option>
                                <option value="ì„ì›">ì„ì›</option>
                            </select>
                        </div>

                        <!-- ì¶”ì²œ ì¥ë¹„ (ë‹¤ì¤‘ ì„ íƒ) ğŸ†• -->
                        <div class="mt-6">
                            <label class="block text-sm font-semibold text-gray-700 mb-3">
                                <i class="fas fa-star text-yellow-500 mr-1"></i>ì¶”ì²œ ì¥ë¹„ (ë‹¤ì¤‘ ì„ íƒ ê°€ëŠ¥)
                            </label>
                            <div class="bg-blue-50 border border-blue-200 rounded-lg p-3 mb-3">
                                <p class="text-xs text-blue-800">
                                    <i class="fas fa-info-circle mr-1"></i>
                                    í•„ìš”í•œ ì¥ë¹„ë¥¼ ëª¨ë‘ ì„ íƒí•˜ì„¸ìš” (ë…¸íŠ¸ë¶, ëª¨ë‹ˆí„° ë“±)
                                </p>
                            </div>
                            <div id="recommended-assets-container" class="space-y-3">
                                <!-- ì¶”ì²œ ì¥ë¹„ ëª©ë¡ (ì²´í¬ë°•ìŠ¤) -->
                            </div>
                        </div>
                    </div>

                    <!-- ê³ ì¥ ì‹ ê³  ì„¹ì…˜ ğŸ†• -->
                    <div id="hw-fault-section" style="display:none;">
                        <div class="bg-red-50 border border-red-200 rounded-lg p-4 mb-4">
                            <p class="text-sm text-red-800">
                                <i class="fas fa-exclamation-triangle mr-2"></i>
                                ê³ ì¥ë‚œ ì¥ë¹„ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”
                            </p>
                        </div>
                        
                        <div id="hw-fault-list" class="space-y-3">
                            <!-- ë³¸ì¸ í•˜ë“œì›¨ì–´ ëª©ë¡ (ë¼ë””ì˜¤) -->
                        </div>
                    </div>

                    <!-- ë³€ê²½ ìš”ì²­ ì„¹ì…˜ -->
                    <div id="hw-change-section" style="display:none;">
                        <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4">
                            <p class="text-sm text-blue-800">
                                <i class="fas fa-info-circle mr-2"></i>
                                ë³€ê²½ì´ í•„ìš”í•œ ì¥ë¹„ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”
                            </p>
                        </div>
                        
                        <div id="hw-change-list" class="space-y-3">
                            <!-- ë³¸ì¸ í•˜ë“œì›¨ì–´ ëª©ë¡ (ë¼ë””ì˜¤) -->
                        </div>
                    </div>
                    
                    <!-- ì‚¬ìœ  (ê³µí†µ - í•˜ë‹¨ì—ë§Œ) -->
                    <div id="hw-common-reason">
                        <label class="block text-sm font-semibold text-gray-700 mb-2">ì‚¬ìœ  *</label>
                        <textarea id="asset-hw-reason" rows="4" required
                                  placeholder="ìš”ì²­ ì‚¬ìœ ë¥¼ ìƒì„¸íˆ ì…ë ¥í•´ì£¼ì„¸ìš”"
                                  class="w-full border border-gray-300 rounded-lg px-4 py-3"></textarea>
                    </div>
                </div>

                <div class="mt-6 flex justify-end space-x-3">
                    <button type="button" onclick="closeModal('assetHardwareModal')" 
                            class="px-6 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition font-semibold">
                        ì·¨ì†Œ
                    </button>
                    <button type="submit" 
                            class="px-6 py-3 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition font-semibold">
                        <i class="fas fa-paper-plane mr-2"></i>ì‹ ì²­í•˜ê¸°
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- ì†Œí”„íŠ¸ì›¨ì–´/ë¼ì´ì„ ìŠ¤ ìš”ì²­ ëª¨ë‹¬ ğŸ†• -->
    <div id="assetSoftwareModal" class="modal">
        <div class="bg-white rounded-2xl shadow-2xl max-w-3xl w-full mx-4 p-8 animate-slide-in max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-2xl font-bold text-gray-800">
                    <i class="fas fa-code text-blue-500 mr-2"></i>ì†Œí”„íŠ¸ì›¨ì–´/ë¼ì´ì„ ìŠ¤ ìš”ì²­
                </h3>
                <button onclick="closeModal('assetSoftwareModal')" class="text-gray-400 hover:text-gray-600 transition">
                    <i class="fas fa-times text-2xl"></i>
                </button>
            </div>
            
            <form id="assetSoftwareForm" onsubmit="submitAssetSoftwareRequest(event)">
                <div class="space-y-6">
                    <!-- ìš”ì²­ ìœ í˜• -->
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-3">ìš”ì²­ ìœ í˜• *</label>
                        <div class="grid grid-cols-3 gap-3">
                            <label class="relative flex items-center p-4 border-2 border-gray-200 rounded-lg cursor-pointer hover:border-blue-500 transition">
                                <input type="radio" name="swRequestType" value="ì‹ ê·œë°œê¸‰" checked class="mr-3">
                                <div>
                                    <div class="font-semibold text-gray-800">ì‹ ê·œ ë°œê¸‰</div>
                                    <div class="text-xs text-gray-500">ìƒˆ ë¼ì´ì„ ìŠ¤</div>
                                </div>
                            </label>
                            <label class="relative flex items-center p-4 border-2 border-gray-200 rounded-lg cursor-pointer hover:border-blue-500 transition">
                                <input type="radio" name="swRequestType" value="ê°±ì‹ ìš”ì²­" class="mr-3">
                                <div>
                                    <div class="font-semibold text-gray-800">ê°±ì‹  ìš”ì²­</div>
                                    <div class="text-xs text-gray-500">ê¸°ì¡´ ì—°ì¥</div>
                                </div>
                            </label>
                            <label class="relative flex items-center p-4 border-2 border-gray-200 rounded-lg cursor-pointer hover:border-blue-500 transition">
                                <input type="radio" name="swRequestType" value="ì¶”ê°€ë¼ì´ì„ ìŠ¤" class="mr-3">
                                <div>
                                    <div class="font-semibold text-gray-800">ì¶”ê°€ ë¼ì´ì„ ìŠ¤</div>
                                    <div class="text-xs text-gray-500">ì¶”ê°€ ë°œê¸‰</div>
                                </div>
                            </label>
                        </div>
                    </div>

                    <!-- ì†Œí”„íŠ¸ì›¨ì–´ ì„ íƒ -->
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">ì†Œí”„íŠ¸ì›¨ì–´ *</label>
                        <select id="asset-sw-name" required class="w-full border border-gray-300 rounded-lg px-4 py-2">
                            <option value="">ì„ íƒí•˜ì„¸ìš”</option>
                            <option value="í•œê¸€ 2022">í•œê¸€ 2022</option>
                            <option value="MS Office 365">MS Office 365</option>
                            <option value="Adobe Creative Cloud">Adobe Creative Cloud</option>
                            <option value="IntelliJ IDEA">IntelliJ IDEA</option>
                            <option value="Visual Studio">Visual Studio</option>
                            <option value="AutoCAD">AutoCAD</option>
                            <option value="ê¸°íƒ€">ê¸°íƒ€ (ì§ì ‘ ì…ë ¥)</option>
                        </select>
                    </div>
                    
                    <!-- ê¸°íƒ€ ì…ë ¥ -->
                    <div id="asset-sw-other-section" style="display:none;">
                        <label class="block text-sm font-semibold text-gray-700 mb-2">ì†Œí”„íŠ¸ì›¨ì–´ ì´ë¦„ *</label>
                        <input type="text" id="asset-sw-other-name" placeholder="ì†Œí”„íŠ¸ì›¨ì–´ ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”"
                               class="w-full border border-gray-300 rounded-lg px-4 py-2">
                    </div>

                    <!-- ì‚¬ìš©ì ì„ íƒ -->
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-3">ì‚¬ìš©ì *</label>
                        <div class="space-y-3">
                            <label class="flex items-center p-3 border-2 border-gray-200 rounded-lg cursor-pointer hover:border-blue-500 transition">
                                <input type="radio" name="swUser" value="self" checked class="mr-3">
                                <span class="font-semibold">ë³¸ì¸</span>
                            </label>
                            <label class="flex items-center p-3 border-2 border-gray-200 rounded-lg cursor-pointer hover:border-blue-500 transition">
                                <input type="radio" name="swUser" value="other" class="mr-3">
                                <span class="font-semibold">íƒ€ì¸ (íŒ€ì›/ì‹ ê·œì…ì‚¬ì)</span>
                            </label>
                            <div id="asset-sw-user-other-section" style="display:none;" class="ml-8">
                                <input type="text" id="asset-sw-user-other" placeholder="ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”" 
                                       class="w-full border border-gray-300 rounded-lg px-4 py-2">
                            </div>
                        </div>
                    </div>

                    <!-- ê°±ì‹  ìš”ì²­ ì„¹ì…˜ ğŸ†• -->
                    <div id="sw-renewal-section" style="display:none;">
                        <div class="bg-orange-50 border border-orange-200 rounded-lg p-4 mb-4">
                            <p class="text-sm text-orange-800">
                                <i class="fas fa-info-circle mr-2"></i>
                                ê°±ì‹ í•  ì†Œí”„íŠ¸ì›¨ì–´ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš” (ë‹¤ì¤‘ ì„ íƒ ê°€ëŠ¥)
                            </p>
                        </div>
                        
                        <div id="sw-renewal-list" class="space-y-3">
                            <!-- ë™ì ìœ¼ë¡œ ë Œë”ë§ë©ë‹ˆë‹¤ -->
                        </div>
                    </div>
                    
                    <!-- ì‚¬ìœ  (ê³µí†µ) -->
                    <div id="sw-common-reason">
                        <label class="block text-sm font-semibold text-gray-700 mb-2">ì‚¬ìœ  *</label>
                        <textarea id="asset-sw-reason" rows="4" required
                                  placeholder="ìš”ì²­ ì‚¬ìœ ë¥¼ ìƒì„¸íˆ ì…ë ¥í•´ì£¼ì„¸ìš”"
                                  class="w-full border border-gray-300 rounded-lg px-4 py-3"></textarea>
                    </div>
                </div>

                <div class="mt-6 flex justify-end space-x-3">
                    <button type="button" onclick="closeModal('assetSoftwareModal')" 
                            class="px-6 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition font-semibold">
                        ì·¨ì†Œ
                    </button>
                    <button type="submit" 
                            class="px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition font-semibold">
                        <i class="fas fa-paper-plane mr-2"></i>ì‹ ì²­í•˜ê¸°
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- í´ë¼ìš°ë“œ ì„œë¹„ìŠ¤ ìš”ì²­ ëª¨ë‹¬ ğŸ†• -->
    <div id="assetCloudModal" class="modal">
        <div class="bg-white rounded-2xl shadow-2xl max-w-3xl w-full mx-4 p-8 animate-slide-in max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-2xl font-bold text-gray-800">
                    <i class="fas fa-cloud text-cyan-500 mr-2"></i>í´ë¼ìš°ë“œ ì„œë¹„ìŠ¤ ìš”ì²­
                </h3>
                <button onclick="closeModal('assetCloudModal')" class="text-gray-400 hover:text-gray-600 transition">
                    <i class="fas fa-times text-2xl"></i>
                </button>
            </div>
            
            <form id="assetCloudForm" onsubmit="submitAssetCloudRequest(event)">
                <div class="space-y-6">
                    <!-- ìš”ì²­ ìœ í˜• -->
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-3">ìš”ì²­ ìœ í˜• *</label>
                        <div class="grid grid-cols-3 gap-3">
                            <label class="relative flex items-center p-4 border-2 border-gray-200 rounded-lg cursor-pointer hover:border-cyan-500 transition">
                                <input type="radio" name="cloudRequestType" value="ê³„ì •ë°œê¸‰" checked class="mr-3">
                                <div>
                                    <div class="font-semibold text-gray-800">ê³„ì • ë°œê¸‰</div>
                                    <div class="text-xs text-gray-500">ì‹ ê·œ ê³„ì •</div>
                                </div>
                            </label>
                            <label class="relative flex items-center p-4 border-2 border-gray-200 rounded-lg cursor-pointer hover:border-cyan-500 transition">
                                <input type="radio" name="cloudRequestType" value="ìš©ëŸ‰ì¦ì„¤" class="mr-3">
                                <div>
                                    <div class="font-semibold text-gray-800">ìš©ëŸ‰ ì¦ì„¤</div>
                                    <div class="text-xs text-gray-500">í™•ì¥ ìš”ì²­</div>
                                </div>
                            </label>
                            <label class="relative flex items-center p-4 border-2 border-gray-200 rounded-lg cursor-pointer hover:border-cyan-500 transition">
                                <input type="radio" name="cloudRequestType" value="ì„œë¹„ìŠ¤ì¶”ê°€" class="mr-3">
                                <div>
                                    <div class="font-semibold text-gray-800">ì„œë¹„ìŠ¤ ì¶”ê°€</div>
                                    <div class="text-xs text-gray-500">ì¶”ê°€ ì‹ ì²­</div>
                                </div>
                            </label>
                        </div>
                    </div>

                    <!-- ì„œë¹„ìŠ¤ ì„ íƒ -->
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">ì„œë¹„ìŠ¤ ìœ í˜• *</label>
                        <select id="asset-cloud-service" required class="w-full border border-gray-300 rounded-lg px-4 py-2">
                            <option value="">ì„ íƒí•˜ì„¸ìš”</option>
                            <optgroup label="AWS">
                                <option value="AWS EC2">AWS EC2</option>
                                <option value="AWS S3">AWS S3</option>
                                <option value="AWS RDS">AWS RDS</option>
                            </optgroup>
                            <optgroup label="Azure">
                                <option value="Azure VM">Azure VM</option>
                                <option value="Azure Storage">Azure Storage</option>
                            </optgroup>
                            <optgroup label="GCP">
                                <option value="GCP Compute">GCP Compute Engine</option>
                                <option value="GCP Storage">GCP Cloud Storage</option>
                            </optgroup>
                            <option value="ê¸°íƒ€">ê¸°íƒ€ (ì§ì ‘ ì…ë ¥)</option>
                        </select>
                    </div>
                    
                    <!-- ê¸°íƒ€ ì…ë ¥ -->
                    <div id="asset-cloud-other-section" style="display:none;">
                        <label class="block text-sm font-semibold text-gray-700 mb-2">ì„œë¹„ìŠ¤ ì´ë¦„ *</label>
                        <input type="text" id="asset-cloud-other-name" placeholder="ì„œë¹„ìŠ¤ ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”"
                               class="w-full border border-gray-300 rounded-lg px-4 py-2">
                    </div>

                    <!-- ìš©ëŸ‰/ì‚¬ì–‘ -->
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">ìš©ëŸ‰/ì‚¬ì–‘ *</label>
                        <input type="text" id="asset-cloud-capacity" required
                               placeholder="ì˜ˆ: 100GB, t3.medium 2vCPU 4GB"
                               class="w-full border border-gray-300 rounded-lg px-4 py-2">
                    </div>

                    <!-- ì˜ˆìƒ ë¹„ìš© -->
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">ì˜ˆìƒ ë¹„ìš© (ì›”)</label>
                        <div class="relative">
                            <span class="absolute left-4 top-3 text-gray-500">â‚©</span>
                            <input type="number" id="asset-cloud-cost" placeholder="50000"
                                   class="w-full border border-gray-300 rounded-lg px-4 py-2 pl-8">
                        </div>
                    </div>

                    <!-- ì‚¬ìš© ê¸°ê°„ -->
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">ì‚¬ìš© ê¸°ê°„</label>
                        <select id="asset-cloud-duration" class="w-full border border-gray-300 rounded-lg px-4 py-2">
                            <option value="1ê°œì›”">1ê°œì›”</option>
                            <option value="3ê°œì›”">3ê°œì›”</option>
                            <option value="6ê°œì›”">6ê°œì›”</option>
                            <option value="1ë…„" selected>1ë…„</option>
                            <option value="ì¥ê¸°">ì¥ê¸° (1ë…„ ì´ìƒ)</option>
                        </select>
                    </div>

                    <!-- ìš©ëŸ‰ ì¦ì„¤ ì„¹ì…˜ ğŸ†• -->
                    <div id="cloud-expansion-section" style="display:none;">
                        <div class="bg-purple-50 border border-purple-200 rounded-lg p-4 mb-4">
                            <p class="text-sm text-purple-800">
                                <i class="fas fa-info-circle mr-2"></i>
                                ì¦ì„¤í•  í´ë¼ìš°ë“œ ì„œë¹„ìŠ¤ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”
                            </p>
                        </div>
                        
                        <div id="cloud-expansion-list" class="space-y-3 mb-4">
                            <!-- ë™ì ìœ¼ë¡œ ë Œë”ë§ë©ë‹ˆë‹¤ -->
                        </div>
                        
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2">ì¦ì„¤ ìš©ëŸ‰/ì‚¬ì–‘ *</label>
                            <input type="text" id="asset-cloud-expansion-amount"
                                   placeholder="ì˜ˆ: +500GB, +2vCPU/4GB RAM"
                                   class="w-full border border-gray-300 rounded-lg px-4 py-2">
                        </div>
                    </div>
                    
                    <!-- ì‚¬ìœ  (ê³µí†µ) -->
                    <div id="cloud-common-reason">
                        <label class="block text-sm font-semibold text-gray-700 mb-2">ì‚¬ìœ  *</label>
                        <textarea id="asset-cloud-reason" rows="4" required
                                  placeholder="ìš”ì²­ ì‚¬ìœ ë¥¼ ìƒì„¸íˆ ì…ë ¥í•´ì£¼ì„¸ìš”"
                                  class="w-full border border-gray-300 rounded-lg px-4 py-3"></textarea>
                    </div>
                </div>

                <div class="mt-6 flex justify-end space-x-3">
                    <button type="button" onclick="closeModal('assetCloudModal')" 
                            class="px-6 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition font-semibold">
                        ì·¨ì†Œ
                    </button>
                    <button type="submit" 
                            class="px-6 py-3 bg-cyan-600 text-white rounded-lg hover:bg-cyan-700 transition font-semibold">
                        <i class="fas fa-paper-plane mr-2"></i>ì‹ ì²­í•˜ê¸°
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- ì¤‘ë¶„ë¥˜ ì„ íƒ ëª¨ë‹¬ ğŸ†• -->
    <div id="subCategoryModal" class="modal">
        <div class="bg-white rounded-2xl shadow-2xl max-w-4xl w-full mx-4 p-8 animate-slide-in max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-2xl font-bold text-gray-800">
                    <i class="fas fa-list text-indigo-500 mr-2"></i>
                    <span id="selected-main-category"></span> ìš”ì²­ ìœ í˜• ì„ íƒ
                </h3>
                <button onclick="closeModal('subCategoryModal')" class="text-gray-400 hover:text-gray-600 transition">
                    <i class="fas fa-times text-2xl"></i>
                </button>
            </div>
            
            <p class="text-sm text-gray-600 mb-6">ì–´ë–¤ ì¢…ë¥˜ì˜ ìš”ì²­ì¸ê°€ìš”?</p>
            
            <div class="grid grid-cols-2 md:grid-cols-3 gap-4" id="subCategoryGrid">
                <!-- ì¥ì• ì‹ ê³  -->
                <div onclick="selectSubCategory('ì¥ì• ì‹ ê³ ')" class="bg-gradient-to-br from-red-50 to-red-100 border-2 border-red-200 rounded-xl p-6 cursor-pointer hover:shadow-lg hover:scale-105 transition-all duration-200 group">
                    <div class="flex flex-col items-center text-center">
                        <div class="w-16 h-16 bg-red-500 rounded-full flex items-center justify-center mb-3 group-hover:scale-110 transition">
                            <i class="fas fa-exclamation-triangle text-white text-2xl"></i>
                        </div>
                        <h4 class="font-bold text-red-900 mb-2">ì¥ì• ì‹ ê³ </h4>
                        <p class="text-xs text-red-700">ì‹œìŠ¤í…œ ì˜¤ë¥˜ ë° ì¥ì• </p>
                    </div>
                </div>

                <!-- ê°œë°œìš”ì²­ -->
                <div onclick="selectSubCategory('ê°œë°œìš”ì²­')" class="bg-gradient-to-br from-blue-50 to-blue-100 border-2 border-blue-200 rounded-xl p-6 cursor-pointer hover:shadow-lg hover:scale-105 transition-all duration-200 group">
                    <div class="flex flex-col items-center text-center">
                        <div class="w-16 h-16 bg-blue-500 rounded-full flex items-center justify-center mb-3 group-hover:scale-110 transition">
                            <i class="fas fa-code text-white text-2xl"></i>
                        </div>
                        <h4 class="font-bold text-blue-900 mb-2">ê°œë°œìš”ì²­</h4>
                        <p class="text-xs text-blue-700">ì‹ ê·œ ê°œë°œ ë° ê°œì„ </p>
                    </div>
                </div>

                <!-- ìš´ì˜/ë³€ê²½ìš”ì²­ -->
                <div onclick="selectSubCategory('ìš´ì˜/ë³€ê²½ìš”ì²­')" class="bg-gradient-to-br from-orange-50 to-orange-100 border-2 border-orange-200 rounded-xl p-6 cursor-pointer hover:shadow-lg hover:scale-105 transition-all duration-200 group">
                    <div class="flex flex-col items-center text-center">
                        <div class="w-16 h-16 bg-orange-500 rounded-full flex items-center justify-center mb-3 group-hover:scale-110 transition">
                            <i class="fas fa-tools text-white text-2xl"></i>
                        </div>
                        <h4 class="font-bold text-orange-900 mb-2">ìš´ì˜/ë³€ê²½</h4>
                        <p class="text-xs text-orange-700">ì„¤ì • ë° ë³€ê²½</p>
                    </div>
                </div>

                <!-- í”„ë¡œì íŠ¸ -->
                <div onclick="selectSubCategory('í”„ë¡œì íŠ¸')" class="bg-gradient-to-br from-purple-50 to-purple-100 border-2 border-purple-200 rounded-xl p-6 cursor-pointer hover:shadow-lg hover:scale-105 transition-all duration-200 group">
                    <div class="flex flex-col items-center text-center">
                        <div class="w-16 h-16 bg-purple-500 rounded-full flex items-center justify-center mb-3 group-hover:scale-110 transition">
                            <i class="fas fa-project-diagram text-white text-2xl"></i>
                        </div>
                        <h4 class="font-bold text-purple-900 mb-2">í”„ë¡œì íŠ¸</h4>
                        <p class="text-xs text-purple-700">ì‹œìŠ¤í…œ êµ¬ì¶•</p>
                    </div>
                </div>

                <!-- ì§€ì›ë¬¸ì˜ -->
                <div onclick="selectSubCategory('ì§€ì›ë¬¸ì˜')" class="bg-gradient-to-br from-green-50 to-green-100 border-2 border-green-200 rounded-xl p-6 cursor-pointer hover:shadow-lg hover:scale-105 transition-all duration-200 group">
                    <div class="flex flex-col items-center text-center">
                        <div class="w-16 h-16 bg-green-500 rounded-full flex items-center justify-center mb-3 group-hover:scale-110 transition">
                            <i class="fas fa-question-circle text-white text-2xl"></i>
                        </div>
                        <h4 class="font-bold text-green-900 mb-2">ì§€ì›ë¬¸ì˜</h4>
                        <p class="text-xs text-green-700">ì‚¬ìš©ë²• ë° ì§€ì›</p>
                    </div>
                </div>

                <!-- ë””ìì¸ìš”ì²­ -->
                <div onclick="selectSubCategory('ë””ìì¸ìš”ì²­')" class="bg-gradient-to-br from-pink-50 to-pink-100 border-2 border-pink-200 rounded-xl p-6 cursor-pointer hover:shadow-lg hover:scale-105 transition-all duration-200 group">
                    <div class="flex flex-col items-center text-center">
                        <div class="w-16 h-16 bg-pink-500 rounded-full flex items-center justify-center mb-3 group-hover:scale-110 transition">
                            <i class="fas fa-paint-brush text-white text-2xl"></i>
                        </div>
                        <h4 class="font-bold text-pink-900 mb-2">ë””ìì¸ìš”ì²­</h4>
                        <p class="text-xs text-pink-700">ë°°ë„ˆ ë° ì½˜í…ì¸ </p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ìì‚° ë°˜ë ¤ ëª¨ë‹¬ ğŸ†• -->
    <div id="rejectAssetModal" class="modal">
        <div class="bg-white rounded-2xl shadow-2xl max-w-2xl w-full mx-4 p-8 animate-slide-in">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-2xl font-bold text-gray-800">
                    <i class="fas fa-times-circle text-red-500 mr-2"></i>ìì‚° ìš”ì²­ ë°˜ë ¤
                </h3>
                <button onclick="closeModal('rejectAssetModal')" class="text-gray-400 hover:text-gray-600 transition">
                    <i class="fas fa-times text-2xl"></i>
                </button>
            </div>
            
            <form id="rejectAssetForm" onsubmit="submitRejectAsset(event)">
                <input type="hidden" id="reject-asset-ticket-id">
                
                <div class="bg-red-50 border border-red-200 rounded-lg p-4 mb-6">
                    <p class="text-sm text-red-800">
                        <i class="fas fa-exclamation-triangle mr-2"></i>
                        ë°˜ë ¤ ì‹œ ì‹ ì²­ìì—ê²Œ ì•Œë¦¼ì´ ì „ì†¡ë˜ë©°, í‹°ì¼“ì€ <strong>ë°˜ë ¤</strong> ìƒíƒœë¡œ ë³€ê²½ë©ë‹ˆë‹¤.
                    </p>
                </div>
                
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">ë°˜ë ¤ ì‚¬ìœ  *</label>
                        <textarea id="reject-asset-reason" rows="5" required
                                  placeholder="ë°˜ë ¤ ì‚¬ìœ ë¥¼ ìƒì„¸íˆ ì…ë ¥í•´ì£¼ì„¸ìš”&#10;ì˜ˆ: ì˜ˆì‚° ë¶€ì¡±, ë¶ˆí•„ìš”í•œ ìš”ì²­, ìŠ¹ì¸ ê¸°ì¤€ ë¯¸ë‹¬ ë“±"
                                  class="w-full border border-gray-300 rounded-lg px-4 py-3"></textarea>
                    </div>
                </div>

                <div class="mt-6 flex justify-end space-x-3">
                    <button type="button" onclick="closeModal('rejectAssetModal')" 
                            class="px-6 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition font-semibold">
                        ì·¨ì†Œ
                    </button>
                    <button type="submit" 
                            class="px-6 py-3 bg-red-600 text-white rounded-lg hover:bg-red-700 transition font-semibold">
                        <i class="fas fa-times-circle mr-2"></i>ë°˜ë ¤ í™•ì •
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- ìì‚° ì²˜ë¦¬ ì™„ë£Œ ëª¨ë‹¬ ğŸ†• -->
    <div id="assetProcessingModal" class="modal">
        <div class="bg-white rounded-2xl shadow-2xl max-w-3xl w-full mx-4 p-8 animate-slide-in max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-2xl font-bold text-gray-800">
                    <i class="fas fa-clipboard-check text-purple-500 mr-2"></i>ìì‚° ì²˜ë¦¬ ì™„ë£Œ
                </h3>
                <button onclick="closeModal('assetProcessingModal')" class="text-gray-400 hover:text-gray-600 transition">
                    <i class="fas fa-times text-2xl"></i>
                </button>
            </div>
            
            <form id="assetProcessingForm" onsubmit="submitAssetProcessing(event)">
                <input type="hidden" id="processing-ticket-id">
                <input type="hidden" id="processing-asset-category">
                
                <!-- í•˜ë“œì›¨ì–´ ì²˜ë¦¬ -->
                <div id="processing-hardware-section" style="display:none;">
                    <div class="bg-purple-50 border border-purple-200 rounded-lg p-4 mb-6">
                        <p class="text-sm text-purple-800">
                            <i class="fas fa-info-circle mr-2"></i>
                            í•˜ë“œì›¨ì–´ ì§€ê¸‰/ì„¤ì¹˜ ì™„ë£Œ ì •ë³´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.
                        </p>
                    </div>
                    
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2">ì²˜ë¦¬ ë°©ë²• *</label>
                            <select id="processing-hw-method" required class="w-full border border-gray-300 rounded-lg px-4 py-2">
                                <option value="">ì„ íƒí•˜ì„¸ìš”</option>
                                <option value="í˜„ì¥ì„¤ì¹˜">í˜„ì¥ ë°©ë¬¸ ì„¤ì¹˜</option>
                                <option value="í”½ì—…">í”½ì—… (ì‚¬ìš©ì ìˆ˜ë ¹)</option>
                                <option value="ë°°ì†¡">ë°°ì†¡</option>
                            </select>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2">ì²˜ë¦¬ ë‚´ìš© *</label>
                            <textarea id="processing-hw-description" rows="4" required
                                      placeholder="ì˜ˆ: 3ì¸µ íšŒì˜ì‹¤ì—ì„œ ì„¤ì¹˜ ì™„ë£Œ, ë„¤íŠ¸ì›Œí¬ ë° í”„ë¦°í„° ì—°ê²° í™•ì¸"
                                      class="w-full border border-gray-300 rounded-lg px-4 py-3"></textarea>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2">ì™„ë£Œì¼</label>
                            <input type="date" id="processing-hw-date" 
                                   class="w-full border border-gray-300 rounded-lg px-4 py-2">
                        </div>
                    </div>
                </div>
                
                <!-- ì†Œí”„íŠ¸ì›¨ì–´/ë¼ì´ì„ ìŠ¤ ì²˜ë¦¬ -->
                <div id="processing-software-section" style="display:none;">
                    <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6">
                        <p class="text-sm text-blue-800">
                            <i class="fas fa-info-circle mr-2"></i>
                            ì†Œí”„íŠ¸ì›¨ì–´ ì„¤ì¹˜ íŒŒì¼ ë˜ëŠ” ë‹¤ìš´ë¡œë“œ ë§í¬ë¥¼ ì²¨ë¶€í•´ì£¼ì„¸ìš”.
                        </p>
                    </div>
                    
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2">ë‹¤ìš´ë¡œë“œ ë§í¬</label>
                            <input type="url" id="processing-sw-link" placeholder="https://example.com/download"
                                   class="w-full border border-gray-300 rounded-lg px-4 py-2">
                        </div>
                        
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2">íŒŒì¼ ì²¨ë¶€</label>
                            <div class="flex items-center space-x-2">
                                <input type="file" id="processing-sw-file" 
                                       class="flex-1 border border-gray-300 rounded-lg px-4 py-2 file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100">
                                <button type="button" onclick="clearFile('processing-sw-file')" 
                                        class="px-3 py-2 text-gray-500 hover:text-gray-700 transition">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                            <p class="text-xs text-gray-500 mt-1">
                                <i class="fas fa-info-circle mr-1"></i>ì„¤ì¹˜ íŒŒì¼, ê°€ì´ë“œ ë¬¸ì„œ ë“±
                            </p>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2">ì„¤ì¹˜ ê°€ì´ë“œ *</label>
                            <textarea id="processing-sw-guide" rows="6" required
                                      placeholder="1. ë‹¤ìš´ë¡œë“œ ë§í¬ ì ‘ì†&#10;2. ì„¤ì¹˜ íŒŒì¼ ì‹¤í–‰&#10;3. ê³„ì • ì •ë³´ ì…ë ¥ (ë³„ë„ ì „ë‹¬)&#10;4. ì„¤ì¹˜ ì™„ë£Œ í›„ ì¬ë¶€íŒ…"
                                      class="w-full border border-gray-300 rounded-lg px-4 py-3"></textarea>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2">ë¼ì´ì„ ìŠ¤ í‚¤ (ìˆëŠ” ê²½ìš°)</label>
                            <input type="text" id="processing-sw-license" placeholder="XXXX-XXXX-XXXX-XXXX"
                                   class="w-full border border-gray-300 rounded-lg px-4 py-2 font-mono">
                        </div>
                    </div>
                </div>

                <div class="mt-6 flex justify-end space-x-3">
                    <button type="button" onclick="closeModal('assetProcessingModal')" 
                            class="px-6 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition font-semibold">
                        ì·¨ì†Œ
                    </button>
                    <button type="submit" 
                            class="px-6 py-3 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition font-semibold">
                        <i class="fas fa-check-circle mr-2"></i>ì²˜ë¦¬ ì™„ë£Œ
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- ê²Œì‹œíŒ ë“±ë¡ ëª¨ë‹¬ ğŸ†• -->
    <div id="boardCreateModal" class="modal">
        <div class="bg-white rounded-2xl shadow-2xl max-w-3xl w-full mx-4 p-8 animate-slide-in max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-2xl font-bold text-gray-800">
                    <i class="fas fa-clipboard-check text-teal-500 mr-2"></i>ê²Œì‹œê¸€ ë“±ë¡
                </h3>
                <button onclick="closeModal('boardCreateModal')" class="text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times text-2xl"></i>
                </button>
            </div>
            
            <form id="boardCreateForm" onsubmit="submitBoardPost(event)">
                <div class="space-y-5">
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">ëŒ€ë¶„ë¥˜ *</label>
                        <select id="board-main-category" required class="w-full border border-gray-300 rounded-lg px-4 py-2">
                            <option value="">ì„ íƒí•˜ì„¸ìš”</option>
                            <option value="ì˜¤ì•„ì‹œìŠ¤">ì˜¤ì•„ì‹œìŠ¤</option>
                            <option value="GMS">GMS</option>
                            <option value="ë¶€ë™ì‚°">ë¶€ë™ì‚°</option>
                            <option value="ì¸í”„ë¼">ì¸í”„ë¼</option>
                            <option value="ERP">ERP</option>
                            <option value="HR">HR</option>
                            <option value="ê¸°íƒ€">ê¸°íƒ€</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">êµ¬ë¶„ *</label>
                        <div class="grid grid-cols-2 gap-3">
                            <label class="flex items-center p-3 border-2 border-gray-200 rounded-lg cursor-pointer hover:border-teal-500 transition">
                                <input type="radio" name="boardType" value="ë§¤ë‰´ì–¼" checked class="mr-3">
                                <span class="font-semibold">ë§¤ë‰´ì–¼</span>
                            </label>
                            <label class="flex items-center p-3 border-2 border-gray-200 rounded-lg cursor-pointer hover:border-teal-500 transition">
                                <input type="radio" name="boardType" value="íŒŒì¼" class="mr-3">
                                <span class="font-semibold">íŒŒì¼</span>
                            </label>
                        </div>
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">ì œëª© *</label>
                        <input type="text" id="board-title" required placeholder="ê²Œì‹œê¸€ ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”"
                               class="w-full border border-gray-300 rounded-lg px-4 py-2">
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">ë‚´ìš© *</label>
                        <textarea id="board-content" rows="8" required placeholder="ìƒì„¸ ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”"
                                  class="w-full border border-gray-300 rounded-lg px-4 py-3"></textarea>
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">URL (ì„ íƒ)</label>
                        <input type="url" id="board-url" placeholder="https://example.com/download"
                               class="w-full border border-gray-300 rounded-lg px-4 py-2">
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">íŒŒì¼ ì²¨ë¶€ (ì„ íƒ, ìµœëŒ€ 5ê°œ)</label>
                        <input type="file" id="board-files" multiple
                               class="w-full border border-gray-300 rounded-lg px-4 py-2 file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:bg-teal-50 file:text-teal-700 hover:file:bg-teal-100">
                        <p class="text-xs text-gray-500 mt-1">
                            <i class="fas fa-info-circle mr-1"></i>ì—¬ëŸ¬ íŒŒì¼ì„ ì„ íƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤
                        </p>
                    </div>
                </div>
                <div class="mt-6 flex justify-end space-x-3">
                    <button type="button" onclick="closeModal('boardCreateModal')" 
                            class="px-6 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition font-semibold">
                        ì·¨ì†Œ
                    </button>
                    <button type="submit" 
                            class="px-6 py-3 bg-teal-600 text-white rounded-lg hover:bg-teal-700 transition font-semibold">
                        <i class="fas fa-paper-plane mr-2"></i>ë“±ë¡í•˜ê¸°
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- ê²Œì‹œíŒ ìƒì„¸ë³´ê¸° ëª¨ë‹¬ ğŸ†• -->
    <div id="boardDetailModal" class="modal">
        <div class="bg-white rounded-2xl shadow-2xl max-w-4xl w-full mx-4 p-8 animate-slide-in max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-2xl font-bold text-gray-800" id="board-detail-title">
                    <i class="fas fa-clipboard text-teal-500 mr-2"></i>ê²Œì‹œê¸€ ìƒì„¸
                </h3>
                <button onclick="closeModal('boardDetailModal')" class="text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times text-2xl"></i>
                </button>
            </div>
            <div id="board-detail-content"></div>
        </div>
    </div>

    <script>
        // Demo Accounts
        const demoAccounts = {
            'user': {
                password: 'user123',
                name: 'í™ê¸¸ë™',
                department: 'ìš´ì˜íŒ€',
                role: 'user'
            },
            'master': {
                password: 'master123',
                name: 'IT ë§ˆìŠ¤í„°',
                department: 'ITíŒ€',
                role: 'master'
            },
            'admin': {
                password: 'admin123',
                name: 'IT ì‹¤ë¬´ì',
                department: 'ITíŒ€',
                role: 'admin'
            }
        };

        // Handle Login
        function handleLogin(event) {
            event.preventDefault();
            const loginId = document.getElementById('loginId').value;
            const password = document.getElementById('loginPassword').value;
            
            console.log('ë¡œê·¸ì¸ ì‹œë„:', loginId, password); // ë””ë²„ê¹…
            console.log('ê³„ì • ì •ë³´:', demoAccounts[loginId]); // ë””ë²„ê¹…
            
            const account = demoAccounts[loginId];
            
            if (account && account.password === password) {
                performLogin(account);
            } else {
                alert('âŒ ì•„ì´ë”” ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.');
            }
        }
        
        // Quick Login (ë¹ ë¥¸ ë¡œê·¸ì¸) ğŸ†•
        function quickLogin(accountType) {
            const account = demoAccounts[accountType];
            if (account) {
                document.getElementById('loginId').value = accountType;
                document.getElementById('loginPassword').value = account.password;
                performLogin(account);
            }
        }
        
        // Perform Login (ë¡œê·¸ì¸ ì‹¤í–‰)
        function performLogin(account) {
            // Set current user
            currentUser = {
                name: account.name,
                department: account.department,
                role: account.role
            };
            currentRole = account.role;
            
            console.log('ë¡œê·¸ì¸ ì„±ê³µ:', currentUser); // ë””ë²„ê¹…
            
            // Update UI
            document.getElementById('current-user-name').textContent = currentUser.name;
            document.getElementById('current-user-role').textContent = currentUser.department;
            
            // Show main app
            document.getElementById('loginScreen').classList.add('hidden');
            document.getElementById('mainApp').classList.remove('hidden');
            
            // Initialize appropriate view
            if (currentRole === 'admin' || currentRole === 'master') {
                document.getElementById('user-role-btn').classList.remove('active');
                document.getElementById('admin-role-btn').classList.add('active');
                document.getElementById('user-view').classList.add('hidden');
                document.getElementById('admin-view').classList.remove('hidden');
                
                // Show Account Management tab for master only
                if (currentRole === 'master') {
                    document.getElementById('accountManagementTab').style.display = 'block';
                }
                
                renderAdminView();
            } else {
                renderUserView();
            }
            
            alert(`âœ… í™˜ì˜í•©ë‹ˆë‹¤, ${currentUser.name}ë‹˜!`);
        }

        // Data Store
        /*
        ============================================
        ğŸ“Š ìµœì¢… ìƒíƒœ ì²´ê³„ & ì›Œí¬í”Œë¡œìš°
        ============================================
        
        âœ… í‹°ì¼“ ìƒíƒœ (Ticket Status):
        1. ìš”ì²­ â†’ ì‚¬ìš©ìê°€ í‹°ì¼“ ìƒì„± (ìˆ˜ì •/ì‚­ì œ ê°€ëŠ¥)
        2. ì ‘ìˆ˜ â†’ ì‹¤ë¬´ì 1ì°¨ ì„ ë³„ & ë‹´ë‹¹ì ìë™ ë°°ì •
           - approved: false (ë§ˆìŠ¤í„° ìŠ¹ì¸ ëŒ€ê¸°)
           - approved: true (ë§ˆìŠ¤í„° ìŠ¹ì¸ ì™„ë£Œ, ì‘ì—… ê°€ëŠ¥)
        3. ì²˜ë¦¬ì¤‘ â†’ ì‘ì—… ì§„í–‰ ì¤‘
           - ìˆ˜ë™: ë‹´ë‹¹ìê°€ ì§ì ‘ ì‹œì‘
           - ìë™: í•˜ìœ„ì—…ë¬´ 1ê°œ ì´ìƒ ì§„í–‰ì¤‘
        4. ê²€ìˆ˜ ëŒ€ê¸° â†’ ITíŒ€ ì‘ì—… ì™„ë£Œ, ì‚¬ìš©ì ê²€ìˆ˜ í•„ìš”
           - ìˆ˜ë™: ì™„ë£Œ ì²˜ë¦¬ ë²„íŠ¼
           - ìë™: í•˜ìœ„ì—…ë¬´ ëª¨ë‘ ì™„ë£Œ
        5. ì™„ë£Œ â†’ ì‚¬ìš©ì ìµœì¢… ìŠ¹ì¸ ì™„ë£Œ
        6. ë³´ë¥˜ â†’ ì¼ì‹œ ì¤‘ë‹¨
        7. ë°˜ë ¤ â†’ ìš”ì²­ ê±°ì ˆ
        
        ğŸ”„ í•µì‹¬ ì›Œí¬í”Œë¡œìš°:
        
        [1ë‹¨ê³„: ìš”ì²­ ìƒì„±]
        ì‚¬ìš©ì â†’ í‹°ì¼“ ìƒì„±
        - ìˆ˜ì •/ì‚­ì œ ê°€ëŠ¥ (ìš”ì²­ ìƒíƒœë§Œ)
        
        [2ë‹¨ê³„: 1ì°¨ ì„ ë³„]
        ì‹¤ë¬´ì(admin) â†’ ê²€í† 
        â”œâ”€ ì ‘ìˆ˜: ë³¸ì¸ì„ ë‹´ë‹¹ìë¡œ ë°°ì • (approved: false)
        â”œâ”€ ë°˜ë ¤: ì²˜ë¦¬ ë¶ˆê°€ ì‚¬ìœ  ì‘ì„±
        â””â”€ ë³´ë¥˜: ì¼ì‹œ ì¤‘ë‹¨
        
        [3ë‹¨ê³„: ìµœì¢… ìŠ¹ì¸]
        ë§ˆìŠ¤í„°(master) â†’ ì ‘ìˆ˜ ê±´ ê²€í† 
        â”œâ”€ ìŠ¹ì¸: approved: true (ì‘ì—… ê°€ëŠ¥ ìƒíƒœ)
        â”œâ”€ ë°˜ë ¤: ìŠ¹ì¸ ê±°ë¶€
        â”œâ”€ ë³´ë¥˜: ì¼ì‹œ ì¤‘ë‹¨
        â””â”€ ë‹´ë‹¹ì ì¬ë°°ì • ê°€ëŠ¥
        
        [4ë‹¨ê³„: ì‘ì—… ì§„í–‰]
        ë‹´ë‹¹ì(admin/master) â†’ ì‘ì—… ì‹œì‘
        â”œâ”€ ë°©ë²•1: ì§ì ‘ ì²˜ë¦¬ ì‹œì‘ ë²„íŠ¼ â†’ ì²˜ë¦¬ì¤‘
        â”œâ”€ ë°©ë²•2: í•˜ìœ„ì—…ë¬´ ì¶”ê°€ í›„ 1ê°œ ì´ìƒ ì§„í–‰ì¤‘ â†’ ìë™ ì²˜ë¦¬ì¤‘
        â””â”€ ìƒíƒœ: approved: trueì¸ ì ‘ìˆ˜ ê±´ë§Œ ê°€ëŠ¥
        
        [5ë‹¨ê³„: ì™„ë£Œ ì²˜ë¦¬]
        ë‹´ë‹¹ì â†’ ì‘ì—… ì™„ë£Œ
        â”œâ”€ ë°©ë²•1: ê²€ìˆ˜ ìš”ì²­ ë²„íŠ¼ (ì™„ë£Œ ì½”ë©˜íŠ¸ ì‘ì„±) â†’ ê²€ìˆ˜ ëŒ€ê¸°
        â””â”€ ë°©ë²•2: í•˜ìœ„ì—…ë¬´ ëª¨ë‘ ì™„ë£Œ â†’ ìë™ ê²€ìˆ˜ ëŒ€ê¸°
        
        [6ë‹¨ê³„: ìµœì¢… ê²€ìˆ˜]
        ì‚¬ìš©ì â†’ ê²€ìˆ˜
        â”œâ”€ ë§Œì¡±: ìµœì¢… ìŠ¹ì¸ (ë§Œì¡±ë„ í‰ê°€) â†’ ì™„ë£Œ
        â””â”€ ë¶ˆë§Œì¡±: ì¬ê²€ìˆ˜ ìš”ì²­ â†’ ì²˜ë¦¬ì¤‘
        
        [7ë‹¨ê³„: ì™„ë£Œ í›„ ê´€ë¦¬]
        ì‚¬ìš©ì/ë§ˆìŠ¤í„° â†’ ì™„ë£Œ í‹°ì¼“ ì¬ê²€ìˆ˜ ìš”ì²­ ê°€ëŠ¥
        
        âœ… ìë™ ìƒíƒœ ì „í™˜:
        - í•˜ìœ„ì—…ë¬´ 1ê°œ ì´ìƒ 'ì§„í–‰ì¤‘' â†’ í‹°ì¼“ ìë™ 'ì²˜ë¦¬ì¤‘'
        - í•˜ìœ„ì—…ë¬´ ëª¨ë‘ 'ì™„ë£Œ' â†’ í‹°ì¼“ ìë™ 'ê²€ìˆ˜ ëŒ€ê¸°'
        
        âœ… í•˜ìœ„ì‘ì—… ìƒíƒœ (Subtask Status):
        1. ëŒ€ê¸° â†’ ì‘ì—… ì‹œì‘ ì „
        2. ì§„í–‰ì¤‘ â†’ ì‘ì—… ì§„í–‰ ì¤‘
        3. ì™„ë£Œ â†’ ì‘ì—… ì™„ë£Œ
        
        âœ… ê¶Œí•œ ì²´ê³„:
        
        [ì‚¬ìš©ì user]
        - í‹°ì¼“ ìƒì„± âœ…
        - ìš”ì²­ ìƒíƒœ: ìˆ˜ì •/ì‚­ì œ âœ…
        - ê²€ìˆ˜ ìŠ¹ì¸/ì¬ê²€ìˆ˜ ìš”ì²­ âœ…
        
        [ì‹¤ë¬´ì admin]
        - ìš”ì²­ â†’ ì ‘ìˆ˜/ë°˜ë ¤/ë³´ë¥˜ âœ… (ë³¸ì¸ ë‹´ë‹¹ì ë°°ì •)
        - ì ‘ìˆ˜+ìŠ¹ì¸ ì™„ë£Œ â†’ ì²˜ë¦¬ ì‹œì‘ âœ…
        - í•˜ìœ„ì—…ë¬´ ê´€ë¦¬ âœ…
        - ê²€ìˆ˜ ìš”ì²­ âœ…
        
        [ë§ˆìŠ¤í„° master = ìŠˆí¼ìœ ì €]
        - user ëª¨ë“  ê¸°ëŠ¥ âœ…
        - admin ëª¨ë“  ê¸°ëŠ¥ âœ…
        - ì ‘ìˆ˜ â†’ ìŠ¹ì¸/ë°˜ë ¤ âœ…
        - ë‹´ë‹¹ì ì¬ë°°ì • âœ…
        - ëª¨ë“  í‹°ì¼“ ì¡°íšŒ âœ…
        - ëª¨ë“  í‹°ì¼“ ê²€ìˆ˜ âœ…
        
        ============================================
        */
        
        let tickets = [];
        let projects = [];
        
        // ğŸ¢ IT ìì‚° ë°ì´í„°
        let assets = [];
        let boardPosts = []; // ê²Œì‹œíŒ ğŸ†•
        let boardPostIdCounter = 1;
        let assetIdCounter = 1;
        
        // ğŸ¯ ìƒˆë¡œìš´ ì¹´í…Œê³ ë¦¬ ì‹œìŠ¤í…œ ë°ì´í„° (ì‚¬ìš©ì ë©”ì¸ìš©)
        const serviceCategories = {
            'ì˜¤ì•„ì‹œìŠ¤': {
                icon: 'fa-water',
                color: 'blue',
                description: 'ì˜¤ì•„ì‹œìŠ¤ ì‹œìŠ¤í…œ'
            },
            'GMS': {
                icon: 'fa-cogs',
                color: 'green',
                description: 'GMS ì‹œìŠ¤í…œ'
            },
            'ë¶€ë™ì‚°': {
                icon: 'fa-building',
                color: 'orange',
                description: 'ë¶€ë™ì‚° ì‹œìŠ¤í…œ'
            },
            'ì¸í”„ë¼': {
                icon: 'fa-server',
                color: 'purple',
                description: 'ì¸í”„ë¼ ì‹œìŠ¤í…œ'
            },
            'ERP': {
                icon: 'fa-chart-line',
                color: 'red',
                description: 'ERP ì‹œìŠ¤í…œ'
            },
            'HR': {
                icon: 'fa-users',
                color: 'pink',
                description: 'HR ì‹œìŠ¤í…œ'
            },
            'ê¸°íƒ€': {
                icon: 'fa-ellipsis-h',
                color: 'gray',
                description: 'ê¸°íƒ€ ì„œë¹„ìŠ¤'
            }
        };
        
        const subCategories = {
            'ì¥ì• ì‹ ê³ ': {
                icon: 'fa-exclamation-triangle',
                color: 'red',
                items: ['ì‹œìŠ¤í…œì¥ì• ', 'ë„¤íŠ¸ì›Œí¬ì¥ì• ', 'í”„ë¡œê·¸ë¨ì˜¤ë¥˜', 'ë³´ì•ˆì´ìŠˆ']
            },
            'ê°œë°œìš”ì²­': {
                icon: 'fa-code',
                color: 'blue',
                items: ['ì‹ ê·œ', 'ê¸°ëŠ¥ê°œì„ ', 'ë²„ê·¸', 'APIì—°ë™', 'ë°ì´í„°ì¶”ì¶œ']
            },
            'ìš´ì˜/ë³€ê²½ìš”ì²­': {
                icon: 'fa-tools',
                color: 'orange',
                items: ['ì„¤ì •ë³€ê²½', 'ì¸í”„ë¼ë³€ê²½', 'ë°°í¬ìš”ì²­', 'DBë³€ê²½', 'ê³„ì •ìƒì„±', 'í™ˆí˜ì´ì§€ìˆ˜ì •']
            },
            'í”„ë¡œì íŠ¸': {
                icon: 'fa-project-diagram',
                color: 'purple',
                items: ['ë§ˆì´ê·¸ë ˆì´ì…˜', 'ì—…ê·¸ë ˆì´ë“œ', 'í†µí•©', 'ì‹ ê·œì‹œìŠ¤í…œêµ¬ì¶•']
            },
            'ì§€ì›ë¬¸ì˜': {
                icon: 'fa-question-circle',
                color: 'green',
                items: ['ì›ê²©ì§€ì›', 'êµìœ¡ìš”ì²­', 'ì‚¬ìš©ë²•ë¬¸ì˜', 'ê¸°ìˆ ë¬¸ì˜']
            },
            'ë””ìì¸ìš”ì²­': {
                icon: 'fa-paint-brush',
                color: 'pink',
                items: ['ì˜¨ë¼ì¸ë°°ë„ˆ', 'ì˜¨ë¼ì¸ì½˜í…ì¸ ', 'ì˜¤í”„ë¼ì¸ë°°ë„ˆ', 'í™ˆí˜ì´ì§€']
            }
        };
        
        // ğŸ§ª í…ŒìŠ¤íŠ¸ìš© ìì‚° ë°ì´í„° ì´ˆê¸°í™”
        function initTestAssets() {
            assets = [
                // í•˜ë“œì›¨ì–´ - ëŒ€ê¸° ì¤‘ì¸ ì¥ë¹„
                {
                    id: assetIdCounter++,
                    code: 'HW-001',
                    category: 'í•˜ë“œì›¨ì–´',
                    type: 'ë…¸íŠ¸ë¶',
                    name: 'LG ê·¸ë¨ 14ì¸ì¹˜',
                    manufacturer: 'LGì „ì',
                    model: '14Z90Q',
                    specs: 'i5-1240P / 16GB / 512GB SSD',
                    status: 'ëŒ€ê¸°',
                    purchaseDate: '2024-01-15',
                    purchasePrice: 1890000,
                    currentUser: null,
                    recommendedGrade: 'ì‚¬ì›'
                },
                {
                    id: assetIdCounter++,
                    code: 'HW-002',
                    category: 'í•˜ë“œì›¨ì–´',
                    type: 'ë…¸íŠ¸ë¶',
                    name: 'LG ê·¸ë¨ 15ì¸ì¹˜',
                    manufacturer: 'LGì „ì',
                    model: '15Z90Q',
                    specs: 'i7-1260P / 16GB / 1TB SSD',
                    status: 'ëŒ€ê¸°',
                    purchaseDate: '2024-02-20',
                    purchasePrice: 2190000,
                    currentUser: null,
                    recommendedGrade: 'ëŒ€ë¦¬'
                },
                {
                    id: assetIdCounter++,
                    code: 'HW-003',
                    category: 'í•˜ë“œì›¨ì–´',
                    type: 'PC',
                    name: 'ì‚¼ì„± ë°ìŠ¤í¬íƒ‘ ì¤‘ê¸‰',
                    manufacturer: 'ì‚¼ì„±ì „ì',
                    model: 'DB400T',
                    specs: 'i5-12400 / 16GB / 512GB SSD',
                    status: 'ì‚¬ìš©ì¤‘',
                    purchaseDate: '2024-01-10',
                    purchasePrice: 1200000,
                    currentUser: 'í™ê¸¸ë™',
                    assignedAt: '2024-01-15',
                    recommendedGrade: 'ì‚¬ì›'
                },
                // ğŸ†• ì¶”ê°€ ì‚¬ìš©ì¤‘ í•˜ë“œì›¨ì–´
                {
                    id: assetIdCounter++,
                    code: 'HW-004',
                    category: 'í•˜ë“œì›¨ì–´',
                    type: 'ë…¸íŠ¸ë¶',
                    name: 'MacBook Pro 14',
                    manufacturer: 'Apple',
                    model: 'MKGR3KH/A',
                    specs: 'M2 Pro / 16GB / 512GB SSD',
                    status: 'ì‚¬ìš©ì¤‘',
                    purchaseDate: '2024-03-01',
                    purchasePrice: 3200000,
                    currentUser: 'IT ë§ˆìŠ¤í„°',
                    assignedAt: '2024-03-05',
                    recommendedGrade: 'ê³¼ì¥'
                },
                {
                    id: assetIdCounter++,
                    code: 'HW-005',
                    category: 'í•˜ë“œì›¨ì–´',
                    type: 'ëª¨ë‹ˆí„°',
                    name: 'ì‚¼ì„± 27ì¸ì¹˜ ëª¨ë‹ˆí„°',
                    manufacturer: 'ì‚¼ì„±ì „ì',
                    model: 'S27A600',
                    specs: '27" FHD IPS',
                    status: 'ì‚¬ìš©ì¤‘',
                    purchaseDate: '2024-02-15',
                    purchasePrice: 350000,
                    currentUser: 'í™ê¸¸ë™',
                    assignedAt: '2024-02-20',
                    recommendedGrade: 'ëŒ€ë¦¬'
                },
                // ğŸ†• ì†Œí”„íŠ¸ì›¨ì–´ ìì‚°
                {
                    id: assetIdCounter++,
                    code: 'SW-001',
                    category: 'ì†Œí”„íŠ¸ì›¨ì–´',
                    type: 'Subscription',
                    name: 'MS Office 365',
                    manufacturer: 'Microsoft',
                    status: 'í™œì„±',
                    startDate: '2024-01-01',
                    expiryDate: '2024-12-31',
                    monthlyFee: 12000,
                    licenseCount: 50,
                    currentUser: ['í™ê¸¸ë™', 'IT ë§ˆìŠ¤í„°', 'IT ì‹¤ë¬´ì'],
                    usedCount: 3
                },
                {
                    id: assetIdCounter++,
                    code: 'SW-002',
                    category: 'ì†Œí”„íŠ¸ì›¨ì–´',
                    type: 'Subscription',
                    name: 'Adobe Creative Cloud',
                    manufacturer: 'Adobe',
                    status: 'í™œì„±',
                    startDate: '2024-01-01',
                    expiryDate: '2024-12-31',
                    monthlyFee: 61000,
                    licenseCount: 10,
                    currentUser: ['IT ë§ˆìŠ¤í„°'],
                    usedCount: 1
                },
                {
                    id: assetIdCounter++,
                    code: 'SW-003',
                    category: 'ì†Œí”„íŠ¸ì›¨ì–´',
                    type: 'Perpetual',
                    name: 'í•œê¸€ 2022',
                    manufacturer: 'í•œê¸€ê³¼ì»´í“¨í„°',
                    status: 'í™œì„±',
                    purchaseDate: '2024-01-10',
                    purchasePrice: 150000,
                    licenseCount: 100,
                    currentUser: ['í™ê¸¸ë™', 'IT ì‹¤ë¬´ì'],
                    usedCount: 2
                },
                // ğŸ†• í´ë¼ìš°ë“œ ìì‚°
                {
                    id: assetIdCounter++,
                    code: 'CL-001',
                    category: 'í´ë¼ìš°ë“œ',
                    type: 'AWS EC2',
                    name: 'AWS EC2 ì¸ìŠ¤í„´ìŠ¤',
                    manufacturer: 'Amazon',
                    specs: 't3.medium (2vCPU, 4GB RAM)',
                    status: 'í™œì„±',
                    startDate: '2024-01-01',
                    monthlyFee: 45000,
                    currentUser: 'í™ê¸¸ë™ íŒ€',
                    region: 'ap-northeast-2'
                },
                {
                    id: assetIdCounter++,
                    code: 'CL-002',
                    category: 'í´ë¼ìš°ë“œ',
                    type: 'Azure Storage',
                    name: 'Azure Blob Storage',
                    manufacturer: 'Microsoft',
                    specs: '1TB Standard',
                    status: 'í™œì„±',
                    startDate: '2024-02-01',
                    monthlyFee: 25000,
                    currentUser: 'ITíŒ€',
                    region: 'Korea Central'
                },
                {
                    id: assetIdCounter++,
                    code: 'CL-003',
                    category: 'í´ë¼ìš°ë“œ',
                    type: 'GCP BigQuery',
                    name: 'GCP BigQuery',
                    manufacturer: 'Google',
                    specs: '500GB Storage, 1TB Query',
                    status: 'í™œì„±',
                    startDate: '2024-03-01',
                    monthlyFee: 35000,
                    currentUser: 'ë°ì´í„°íŒ€',
                    region: 'asia-northeast3'
                }
            ];
        }
        
        // ì´ˆê¸°í™”
        initTestAssets();
        
        // ìì‚° ì¹´í…Œê³ ë¦¬ ì •ì˜
        const assetCategories = {
            'í•˜ë“œì›¨ì–´': ['PC', 'ë…¸íŠ¸ë¶', 'ëª¨ë‹ˆí„°', 'í‚¤ë³´ë“œ', 'ë§ˆìš°ìŠ¤', 'í”„ë¦°í„°', 'ì„œë²„', 'ë„¤íŠ¸ì›Œí¬ì¥ë¹„'],
            'ì†Œí”„íŠ¸ì›¨ì–´': ['í•œê¸€', 'MS Office', 'Adobe', 'ê°œë°œë„êµ¬', 'CAD', 'ê¸°íƒ€'],
            'ë¼ì´ì„ ìŠ¤': ['Named User', 'Concurrent', 'Subscription', 'Perpetual'],
            'í´ë¼ìš°ë“œ': ['AWS', 'Azure', 'GCP', 'SaaS', 'ìŠ¤í† ë¦¬ì§€', 'CDN']
        };
        
        // ì§ê¸‰ë³„ ì¶”ì²œ í•˜ë“œì›¨ì–´
        const gradeRecommendations = {
            'ì‚¬ì›': ['PC-ë³´ê¸‰í˜•', 'ë…¸íŠ¸ë¶-ë³´ê¸‰í˜•', 'ëª¨ë‹ˆí„°-24ì¸ì¹˜'],
            'ëŒ€ë¦¬': ['PC-ì¤‘ê¸‰', 'ë…¸íŠ¸ë¶-ì¤‘ê¸‰', 'ëª¨ë‹ˆí„°-27ì¸ì¹˜'],
            'ê³¼ì¥': ['PC-ê³ ê¸‰', 'ë…¸íŠ¸ë¶-ê³ ê¸‰', 'ëª¨ë‹ˆí„°-27ì¸ì¹˜', 'ë“€ì–¼ëª¨ë‹ˆí„°'],
            'ì°¨ì¥': ['ë…¸íŠ¸ë¶-ê³ ê¸‰', 'MacBook Air', 'ë“€ì–¼ëª¨ë‹ˆí„°'],
            'ë¶€ì¥': ['MacBook Pro', 'ë…¸íŠ¸ë¶-ìµœê³ ê¸‰', 'ë“€ì–¼ëª¨ë‹ˆí„°-ê³ ê¸‰'],
            'ì„ì›': ['MacBook Pro Max', 'ìµœê³ ì‚¬ì–‘', 'íŠ¸ë¦¬í”Œëª¨ë‹ˆí„°']
        };
        
        // ğŸ“ ì¹´í…Œê³ ë¦¬ 3ë‹¨ê³„ ë¶„ë¥˜ ì •ì˜
        const categoryStructure = {
            main: ['ì˜¤ì•„ì‹œìŠ¤', 'ì¸í”„ë¼', 'í™˜ê²½', 'ë¶€ë™ì‚°', 'ê¸°íƒ€'],
            middle: ['ê°œë°œìš”ì²­', 'ìš´ì˜ê´€ë¦¬'],
            sub: ['ì‹ ê·œ', 'ê°œì„ (ë³€ê²½)', 'ì¥ì• ', 'ê¸°ëŠ¥ì¶”ê°€', 'ê³„ì •ì¶”ê°€', 'ê¶Œí•œìš”ì²­']
        };
        
        // ğŸ’¼ ë“±ê¸‰ë³„ ê¸°ì¤€ ë‹¨ê°€ (ë§¨ë¨¼ìŠ¤/ë§¨ë°ì´ ê¸°ì¤€)
        // ğŸ’¼ ë“±ê¸‰ë³„ ê¸°ì¤€ ë‹¨ê°€ (ë§¨ë¨¼ìŠ¤/ë§¨ë°ì´ ê¸°ì¤€) - ìˆ˜ì • ê°€ëŠ¥
        let gradeRates = {
            'íŠ¹ê¸‰': { 
                monthlyRate: 9000000,  // ì›” ê¸°ì¤€  
                dailyRate: 428571,     // ì¼ ê¸°ì¤€ (ì›”/21ì¼)
                hourlyRate: 53571,     // ì‹œê°„ ê¸°ì¤€ (ì¼/8ì‹œê°„)
                description: '10ë…„ ì´ìƒ ê²½ë ¥, ì•„í‚¤í…íŠ¸ê¸‰'
            },
            'ê³ ê¸‰': { 
                monthlyRate: 7500000,
                dailyRate: 357143,
                hourlyRate: 44643,
                description: '8-9ë…„ì°¨, ì‹œë‹ˆì–´ê¸‰'
            },
            'ì¤‘ê¸‰': { 
                monthlyRate: 6300000,
                dailyRate: 300000,
                hourlyRate: 37500,
                description: '3-7ë…„ì°¨, ì¤‘ê²¬ê¸‰'
            },
            'ì´ˆê¸‰': { 
                monthlyRate: 5500000,
                dailyRate: 261905,
                hourlyRate: 32738,
                description: '1-2ë…„ì°¨, ì£¼ë‹ˆì–´ê¸‰'
            }
        };
        
        // ğŸ“œ ë‹¨ê°€ ë³€ê²½ íˆìŠ¤í† ë¦¬
        let rateHistory = [
            {
                id: 1,
                changedAt: '2024-01-01 00:00:00',
                changedBy: 'IT ë§ˆìŠ¤í„°',
                rates: {
                    'íŠ¹ê¸‰': { monthlyRate: 9000000, dailyRate: 428571, hourlyRate: 53571 },
                    'ê³ ê¸‰': { monthlyRate: 7500000, dailyRate: 357143, hourlyRate: 44643 },
                    'ì¤‘ê¸‰': { monthlyRate: 6300000, dailyRate: 300000, hourlyRate: 37500 },
                    'ì´ˆê¸‰': { monthlyRate: 5500000, dailyRate: 261905, hourlyRate: 32738 }
                },
                note: 'ì´ˆê¸° ë‹¨ê°€ ì„¤ì •'
            }
        ];
        let rateHistoryIdCounter = 2;
        
        // âš™ï¸ ì‹œìŠ¤í…œ ì„¤ì •
        let systemSettings = {
            estimateConfirmationThreshold: 5000000  // ê²¬ì í™•ì¸ í•„ìš” ê¸ˆì•¡ ê¸°ì¤€ (ê¸°ë³¸: 500ë§Œì›)
        };
        
        // IT ì‹¤ë¬´ì ì •ë³´ (ë…„ì°¨, ì‹œê°„ë‹¹ ë¹„ìš©, ë“±ê¸‰, ì „ë¬¸ë¶„ì•¼)
        let itStaff = [
            {
                id: 1,
                name: 'ê¹€ê°œë°œ',
                role: 'ë°±ì—”ë“œ ê°œë°œì',
                yearsOfExperience: 5,
                category: 'ì˜¤ì•„ì‹œìŠ¤',
                grade: 'ì¤‘ê¸‰',
                get hourlyRate() { return gradeRates[this.grade].hourlyRate; },
                get dailyRate() { return gradeRates[this.grade].dailyRate; },
                get monthlyRate() { return gradeRates[this.grade].monthlyRate; }
            },
            {
                id: 2,
                name: 'ì´í”„ë¡ íŠ¸',
                role: 'í”„ë¡ íŠ¸ì—”ë“œ ê°œë°œì',
                yearsOfExperience: 3,
                category: 'ì˜¤ì•„ì‹œìŠ¤',
                grade: 'ì¤‘ê¸‰',
                get hourlyRate() { return gradeRates[this.grade].hourlyRate; },
                get dailyRate() { return gradeRates[this.grade].dailyRate; },
                get monthlyRate() { return gradeRates[this.grade].monthlyRate; }
            },
            {
                id: 3,
                name: 'ìµœì¸í”„ë¼',
                role: 'ì¸í”„ë¼ ì—”ì§€ë‹ˆì–´',
                yearsOfExperience: 7,
                category: 'ì¸í”„ë¼',
                grade: 'ì¤‘ê¸‰',
                get hourlyRate() { return gradeRates[this.grade].hourlyRate; },
                get dailyRate() { return gradeRates[this.grade].dailyRate; },
                get monthlyRate() { return gradeRates[this.grade].monthlyRate; }
            },
            {
                id: 4,
                name: 'ë°•ë””ìì¸',
                role: 'UI/UX ë””ìì´ë„ˆ',
                yearsOfExperience: 4,
                category: 'ì˜¤ì•„ì‹œìŠ¤',
                grade: 'ì¤‘ê¸‰',
                get hourlyRate() { return gradeRates[this.grade].hourlyRate; },
                get dailyRate() { return gradeRates[this.grade].dailyRate; },
                get monthlyRate() { return gradeRates[this.grade].monthlyRate; }
            },
            {
                id: 5,
                name: 'ì •ë³´ì•ˆ',
                role: 'ë³´ì•ˆ ì „ë¬¸ê°€',
                yearsOfExperience: 6,
                category: 'ë³´ì•ˆ',
                grade: 'ì¤‘ê¸‰',
                get hourlyRate() { return gradeRates[this.grade].hourlyRate; },
                get dailyRate() { return gradeRates[this.grade].dailyRate; },
                get monthlyRate() { return gradeRates[this.grade].monthlyRate; }
            }
        ];
        
        let itStaffIdCounter = 6;
        
        // ë…„ì°¨ë³„ ê¸°ë³¸ ì‹œê°„ë‹¹ ë¹„ìš© ê³„ì‚° í•¨ìˆ˜
        function calculateHourlyRate(years) {
            const baseRate = 30000; // 1ë…„ì°¨ ê¸°ë³¸
            const yearlyIncrease = 5000; // ë…„ì°¨ë‹¹ ì¦ê°€
            return baseRate + (years * yearlyIncrease);
        }
        
        // â° SLA (Service Level Agreement) ì„¤ì •
        const SLA_HOURS = {
            'ë†’ìŒ': 48,    // 48ì‹œê°„ (2ì¼)
            'ë³´í†µ': 120,   // 120ì‹œê°„ (5ì¼)
            'ë‚®ìŒ': 240    // 240ì‹œê°„ (10ì¼)
        };
        
        // SLA ë§ˆê° ì‹œê°„ ê³„ì‚°
        function calculateSLADeadline(createdAt, priority) {
            const created = new Date(createdAt);
            const slaHours = SLA_HOURS[priority] || 120;
            const deadline = new Date(created.getTime() + (slaHours * 60 * 60 * 1000));
            return deadline;
        }
        
        // SLA ìƒíƒœ í™•ì¸ (ì •ìƒ/ì„ë°•/ì´ˆê³¼)
        function getSLAStatus(createdAt, priority, currentStatus) {
            if (currentStatus === 'ì™„ë£Œ' || currentStatus === 'ë°˜ë ¤' || currentStatus === 'ê²€ìˆ˜ ëŒ€ê¸°') {
                return 'completed';
            }
            
            const deadline = calculateSLADeadline(createdAt, priority);
            const now = new Date();
            const hoursRemaining = (deadline - now) / (1000 * 60 * 60);
            
            if (hoursRemaining < 0) {
                return 'overdue'; // ì´ˆê³¼
            } else if (hoursRemaining <= 24) {
                return 'urgent'; // 24ì‹œê°„ ì´ë‚´ - ì„ë°•
            } else {
                return 'normal'; // ì •ìƒ
            }
        }
        
        // í‹°ì¼“ë²ˆí˜¸ ìƒì„± ì¹´ìš´í„° (ëŒ€ë¶„ë¥˜+ì¤‘ë¶„ë¥˜ë³„)
        let ticketNumberCounters = {};
        
        // í‹°ì¼“ë²ˆí˜¸ ìƒì„± í•¨ìˆ˜
        function generateTicketNumber(categoryMain, categoryMiddle) {
            const year = new Date().getFullYear();
            
            // ëŒ€ë¶„ë¥˜ ì•½ì–´
            const mainCode = {
                'ì˜¤ì•„ì‹œìŠ¤': 'OA',
                'ì¸í”„ë¼': 'IF',
                'í™˜ê²½': 'EV',
                'ë¶€ë™ì‚°': 'PD',
                'ê¸°íƒ€': 'ETC'
            }[categoryMain] || 'TKT';
            
            // ì¤‘ë¶„ë¥˜ ì•½ì–´
            const middleCode = {
                'ê°œë°œìš”ì²­': 'DEV',
                'ìš´ì˜ê´€ë¦¬': 'OPS'
            }[categoryMiddle] || 'REQ';
            
            // ì¹´ìš´í„° í‚¤
            const key = `${mainCode}-${middleCode}-${year}`;
            
            // ì¹´ìš´í„° ì´ˆê¸°í™” ë˜ëŠ” ì¦ê°€
            if (!ticketNumberCounters[key]) {
                ticketNumberCounters[key] = 1;
            } else {
                ticketNumberCounters[key]++;
            }
            
            const number = String(ticketNumberCounters[key]).padStart(3, '0');
            return `${mainCode}-${middleCode}-${year}-${number}`;
        }
        
        let ticketIdCounter = 1;
        let projectIdCounter = 1;
        let currentRole = 'user'; // 'user' or 'admin'
        let currentUser = {
            name: 'í™ê¸¸ë™',
            department: 'ìš´ì˜íŒ€',
            role: 'user'
        };
        
        // ğŸ†• í˜„ì¬ ë·° ì¦‰ì‹œ ìƒˆë¡œê³ ì¹¨
        function refreshCurrentView() {
            if (currentRole === 'admin' || currentRole === 'master') {
                renderAdminView();
            } else {
                renderUserView();
            }
        }
        
        // í•„í„° ìƒíƒœ ğŸ†•
        let kanbanFilter = 'ì „ì²´';  // ì „ì²´/ITSM/ìì‚°
        let ticketListFilter = 'ì „ì²´';  // ì „ì²´/ITSM/ìì‚°
        let adminViewScope = 'all';  // all/own (Adminë§Œ ì‚¬ìš©)

        // Initialize with demo data
        function initializeDemoData() {
            const demoTickets = [
                {
                    id: ticketIdCounter++,
                    ticketNumber: 'TKT-2024-001',
                    title: 'ì¸íŠ¸ë¼ë„· ë¡œê·¸ì¸ ì˜¤ë¥˜ ìˆ˜ì • ìš”ì²­',
                    description: 'Chrome ë¸Œë¼ìš°ì €ì—ì„œ ì¸íŠ¸ë¼ë„· ë¡œê·¸ì¸ ì‹œ ì„¸ì…˜ì´ ìœ ì§€ë˜ì§€ ì•ŠëŠ” ë¬¸ì œê°€ ìˆìŠµë‹ˆë‹¤.',
                    requester: 'í™ê¸¸ë™',
                    department: 'ìš´ì˜íŒ€',
                    category: 'ì¸í”„ë¼',
                    status: 'ì²˜ë¦¬ì¤‘',
                    priority: 'ë†’ìŒ',
                    assignees: ['ê¹€ê°œë°œ', 'ì´í”„ë¡ íŠ¸'],
                    createdAt: '2024-11-25',
                    dueDate: '2024-12-05',
                    linkedTickets: [],
                    approved: true,
                    approvedBy: 'IT ë§ˆìŠ¤í„°',
                    approvedAt: '2024-11-25 14:30',
                    comments: [
                        {
                            id: 'cmt1',
                            author: 'IT ê´€ë¦¬ì',
                            content: 'ê¹€ê°œë°œë‹˜ê»˜ ë°±ì—”ë“œ ê²€í†  ìš°ì„  ë°°ì •í–ˆìŠµë‹ˆë‹¤.',
                            createdAt: '2024-11-26 10:30'
                        }
                    ],
                    subtasks: [
                        {
                            id: 'st1',
                            title: 'ì„¸ì…˜ ê´€ë¦¬ ë¡œì§ ì ê²€',
                            description: 'ë°±ì—”ë“œ ì„¸ì…˜ ê´€ë¦¬ ì½”ë“œ ê²€í† ',
                            assignee: 'ê¹€ê°œë°œ',
                            startDate: '2024-11-26',
                            endDate: '2024-11-28',
                            status: 'ì™„ë£Œ',
                            actualHours: 8 // ì‹¤ì œ ì†Œìš” ì‹œê°„ (8ì‹œê°„)
                        },
                        {
                            id: 'st2',
                            title: 'í”„ë¡ íŠ¸ì—”ë“œ ì¿ í‚¤ ì²˜ë¦¬ ìˆ˜ì •',
                            description: 'Chrome ì¿ í‚¤ ì •ì±… ëŒ€ì‘',
                            assignee: 'ì´í”„ë¡ íŠ¸',
                            startDate: '2024-11-29',
                            endDate: '2024-12-02',
                            status: 'ì§„í–‰ì¤‘',
                            actualHours: 6 // ì‹¤ì œ ì†Œìš” ì‹œê°„ (6ì‹œê°„)
                        }
                    ]
                },
                {
                    id: ticketIdCounter++,
                    ticketNumber: 'TKT-2024-002',
                    title: 'ëª¨ë°”ì¼ ì•± UI ê°œì„ ',
                    description: 'ëª¨ë°”ì¼ ì•±ì˜ ë©”ì¸ í™”ë©´ ë ˆì´ì•„ì›ƒì„ ê°œì„ í•˜ê³  ì‚¬ìš©ì ê²½í—˜ì„ í–¥ìƒì‹œì¼œì£¼ì„¸ìš”.',
                    requester: 'ê¹€ì² ìˆ˜',
                    department: 'ë§ˆì¼€íŒ…íŒ€',
                    category: 'ì˜¤ì•„ì‹œìŠ¤',
                    status: 'ì ‘ìˆ˜',
                    priority: 'ë³´í†µ',
                    assignees: [],
                    createdAt: '2024-11-28',
                    dueDate: '2024-12-15',
                    linkedTickets: [],
                    approved: false,
                    comments: [],
                    subtasks: []
                },
                {
                    id: ticketIdCounter++,
                    ticketNumber: 'TKT-2024-003',
                    title: 'ì£¼ê°„ ì„œë²„ ë°±ì—… ìë™í™”',
                    description: 'ë§¤ì£¼ ì¼ìš”ì¼ ìë™ìœ¼ë¡œ ì„œë²„ ë°±ì—…ì´ ì‹¤í–‰ë˜ë„ë¡ ìŠ¤í¬ë¦½íŠ¸ ì‘ì„± ë¶€íƒë“œë¦½ë‹ˆë‹¤.',
                    requester: 'í™ê¸¸ë™',
                    department: 'ìš´ì˜íŒ€',
                    category: 'ì¸í”„ë¼',
                    status: 'ì™„ë£Œ',
                    priority: 'ë³´í†µ',
                    assignees: ['ìµœì¸í”„ë¼'],
                    createdAt: '2024-11-20',
                    dueDate: '2024-11-27',
                    linkedTickets: [],
                    approved: true,
                    approvedBy: 'IT ë§ˆìŠ¤í„°',
                    approvedAt: '2024-11-20 10:00',
                    comments: [],
                    subtasks: [
                        {
                            id: 'st3',
                            title: 'ë°±ì—… ìŠ¤í¬ë¦½íŠ¸ ì‘ì„±',
                            assignee: 'ìµœì¸í”„ë¼',
                            startDate: '2024-11-21',
                            endDate: '2024-11-23',
                            status: 'ì™„ë£Œ',
                            actualHours: 12
                        },
                        {
                            id: 'st4',
                            title: 'í¬ë¡ ì¡ ì„¤ì • ë° í…ŒìŠ¤íŠ¸',
                            assignee: 'ìµœì¸í”„ë¼',
                            startDate: '2024-11-24',
                            endDate: '2024-11-26',
                            status: 'ì™„ë£Œ',
                            actualHours: 4
                        }
                    ]
                },
                {
                    id: ticketIdCounter++,
                    ticketNumber: 'TKT-2024-004',
                    title: 'ì‚¬ë‚´ ë©”ì‹ ì € ì•Œë¦¼ ê¸°ëŠ¥ ì¶”ê°€',
                    description: 'ì¤‘ìš” ê³µì§€ì‚¬í•­ì— ëŒ€í•œ í‘¸ì‹œ ì•Œë¦¼ ê¸°ëŠ¥ì„ ì¶”ê°€í•´ì£¼ì„¸ìš”.',
                    requester: 'ì´ì˜í¬',
                    department: 'ì¸ì‚¬íŒ€',
                    category: 'ì˜¤ì•„ì‹œìŠ¤',
                    status: 'ê²€ìˆ˜ ëŒ€ê¸°',
                    priority: 'ë‚®ìŒ',
                    assignees: ['ë°•ë””ìì¸'],
                    createdAt: '2024-11-15',
                    dueDate: '2024-11-29',
                    linkedTickets: [],
                    approved: true,
                    approvedBy: 'IT ë§ˆìŠ¤í„°',
                    approvedAt: '2024-11-16 09:00',
                    completionComment: 'ì•Œë¦¼ ê¸°ëŠ¥ì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤. ì„¤ì • > ì•Œë¦¼ ë©”ë‰´ì—ì„œ ì•Œë¦¼ ì¢…ë¥˜ë³„ë¡œ on/offê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤.',
                    completionLinks: ['https://docs.company.com/messenger-notification'],
                    completedBy: 'ë°•ë””ìì¸',
                    completedAt: '2024-11-28 17:30',
                    satisfactionRating: null,
                    comments: [],
                    subtasks: [
                        {
                            id: 'st5',
                            title: 'ì•Œë¦¼ UI ë””ìì¸',
                            assignee: 'ë°•ë””ìì¸',
                            startDate: '2024-11-16',
                            endDate: '2024-11-20',
                            status: 'ì™„ë£Œ',
                            actualHours: 12
                        },
                        {
                            id: 'st6',
                            title: 'í‘¸ì‹œ ì•Œë¦¼ ê¸°ëŠ¥ êµ¬í˜„',
                            assignee: 'ë°•ë””ìì¸',
                            startDate: '2024-11-21',
                            endDate: '2024-11-28',
                            status: 'ì™„ë£Œ',
                            actualHours: 16
                        }
                    ]
                },
                {
                    id: ticketIdCounter++,
                    ticketNumber: 'TKT-2024-005',
                    title: 'VPN ì ‘ì† ì†ë„ ê°œì„ ',
                    description: 'ì¬íƒê·¼ë¬´ ì‹œ VPN ì†ë„ê°€ ë„ˆë¬´ ëŠë ¤ ì—…ë¬´ì— ì§€ì¥ì´ ìˆìŠµë‹ˆë‹¤',
                    requester: 'ìµœìˆ˜ì§„',
                    department: 'ê°œë°œíŒ€',
                    category: 'ì¸í”„ë¼',
                    status: 'ì™„ë£Œ',
                    priority: 'ë†’ìŒ',
                    assignees: ['ìµœì¸í”„ë¼'],
                    createdAt: '2024-11-10',
                    dueDate: '2024-11-20',
                    linkedTickets: [],
                    approved: true,
                    approvedBy: 'IT ë§ˆìŠ¤í„°',
                    approvedAt: '2024-11-10 14:00',
                    completionComment: 'VPN ì„œë²„ ìš©ëŸ‰ì„ 2ë°°ë¡œ ì¦ì„¤í•˜ê³  ë¼ìš°íŒ… ìµœì í™”ë¥¼ ì™„ë£Œí–ˆìŠµë‹ˆë‹¤. í‰ê·  ì†ë„ê°€ 3ë°° í–¥ìƒë˜ì—ˆìŠµë‹ˆë‹¤.',
                    completionLinks: ['https://wiki.company.com/vpn-setup-guide'],
                    completedBy: 'ìµœì¸í”„ë¼',
                    completedAt: '2024-11-19 16:00',
                    satisfactionRating: 5,
                    userApprovedAt: '2024-11-20 09:30',
                    userApprovedBy: 'ìµœìˆ˜ì§„',
                    comments: [
                        {
                            id: 'cmt2',
                            author: 'ìµœìˆ˜ì§„',
                            content: 'ì†ë„ê°€ ì •ë§ ë¹¨ë¼ì¡Œë„¤ìš”! ê°ì‚¬í•©ë‹ˆë‹¤ ğŸ‘',
                            createdAt: '2024-11-20 09:30'
                        }
                    ],
                    subtasks: [
                        {
                            id: 'st7',
                            title: 'VPN ì„œë²„ ì¦ì„¤',
                            assignee: 'ìµœì¸í”„ë¼',
                            startDate: '2024-11-11',
                            endDate: '2024-11-15',
                            status: 'ì™„ë£Œ',
                            actualHours: 20
                        },
                        {
                            id: 'st8',
                            title: 'ë¼ìš°íŒ… ìµœì í™”',
                            assignee: 'ìµœì¸í”„ë¼',
                            startDate: '2024-11-16',
                            endDate: '2024-11-19',
                            status: 'ì™„ë£Œ',
                            actualHours: 8
                        }
                    ]
                },
                // í™ê¸¸ë™(user) í…ŒìŠ¤íŠ¸ í‹°ì¼“ë“¤
                {
                    id: ticketIdCounter++,
                    ticketNumber: 'TKT-2024-006',
                    title: 'ìš´ì˜íŒ€ ê³µìœ  ë“œë¼ì´ë¸Œ ìš©ëŸ‰ ì¦ì„¤',
                    description: 'ìš´ì˜íŒ€ ê³µìœ  ë“œë¼ì´ë¸Œì˜ ìš©ëŸ‰ì´ ë¶€ì¡±í•©ë‹ˆë‹¤. í˜„ì¬ 95% ì‚¬ìš© ì¤‘ì´ë©°, ìµœì†Œ 500GB ì¶”ê°€ í•„ìš”í•©ë‹ˆë‹¤.',
                    requester: 'í™ê¸¸ë™',
                    department: 'ìš´ì˜íŒ€',
                    category: 'ì¸í”„ë¼',
                    categoryMain: 'ì¸í”„ë¼',
                    categoryMiddle: 'ìš´ì˜ê´€ë¦¬',
                    categorySub: 'ê¶Œí•œìš”ì²­',
                    status: 'ìš”ì²­',
                    priority: 'ë†’ìŒ',
                    assignees: [],
                    createdAt: '2024-12-08',
                    dueDate: '2024-12-15',
                    linkedTickets: [],
                    approved: null,
                    comments: [],
                    subtasks: []
                },
                {
                    id: ticketIdCounter++,
                    ticketNumber: 'TKT-2024-007',
                    title: 'ì—…ë¬´ ì¼ì§€ ì‘ì„± ì‹œìŠ¤í…œ ê°œì„ ',
                    description: 'í˜„ì¬ ì—…ë¬´ ì¼ì§€ë¥¼ ìˆ˜ê¸°ë¡œ ì‘ì„±í•˜ê³  ìˆìŠµë‹ˆë‹¤. ìë™í™”ëœ ì¼ì§€ ì‹œìŠ¤í…œ êµ¬ì¶•ì„ ìš”ì²­í•©ë‹ˆë‹¤.',
                    requester: 'í™ê¸¸ë™',
                    department: 'ìš´ì˜íŒ€',
                    category: 'ì˜¤ì•„ì‹œìŠ¤',
                    categoryMain: 'ì˜¤ì•„ì‹œìŠ¤',
                    categoryMiddle: 'ê°œë°œìš”ì²­',
                    categorySub: 'ì‹ ê·œ',
                    status: 'ì ‘ìˆ˜',
                    priority: 'ë³´í†µ',
                    assignees: ['ë°•ë””ìì¸'],
                    createdAt: '2024-12-05',
                    dueDate: '2024-12-20',
                    linkedTickets: [],
                    approved: false,
                    comments: [
                        {
                            id: 'cmt-hong-1',
                            author: 'ë°•ë””ìì¸',
                            content: 'ìš”êµ¬ì‚¬í•­ í™•ì¸í–ˆìŠµë‹ˆë‹¤. ë§ˆìŠ¤í„° ìŠ¹ì¸ í›„ ì‘ì—… ì‹œì‘í•˜ê² ìŠµë‹ˆë‹¤.',
                            createdAt: '2024-12-05 14:30'
                        }
                    ],
                    subtasks: []
                },
                {
                    id: ticketIdCounter++,
                    ticketNumber: 'TKT-2024-008',
                    title: 'í”„ë¦°í„° ë„¤íŠ¸ì›Œí¬ ì—°ê²° ì˜¤ë¥˜',
                    description: 'ìš´ì˜íŒ€ ì‚¬ë¬´ì‹¤ í”„ë¦°í„°(HP-LaserJet-301)ê°€ ë„¤íŠ¸ì›Œí¬ì—ì„œ ì¸ì‹ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ê¸´ê¸‰ ì¶œë ¥ ì—…ë¬´ê°€ ìˆì–´ ë¹ ë¥¸ ì²˜ë¦¬ ë¶€íƒë“œë¦½ë‹ˆë‹¤.',
                    requester: 'í™ê¸¸ë™',
                    department: 'ìš´ì˜íŒ€',
                    category: 'ì¸í”„ë¼',
                    
                    categoryMain: 'ì¸í”„ë¼',
                    categoryMiddle: 'ìš´ì˜ê´€ë¦¬',
                    categorySub: 'ì¥ì• ',
                    status: 'ì ‘ìˆ˜',
                    priority: 'ë†’ìŒ',
                    assignees: ['ê¹€ê°œë°œ'],
                    createdAt: '2024-12-06',
                    dueDate: '2024-12-09',
                    linkedTickets: [],
                    approved: true,
                    approvedBy: 'IT ë§ˆìŠ¤í„°',
                    approvedAt: '2024-12-06 10:30',
                    comments: [
                        {
                            id: 'cmt-hong-2',
                            author: 'IT ë§ˆìŠ¤í„°',
                            content: 'ê¸´ê¸‰ ê±´ìœ¼ë¡œ ìŠ¹ì¸í•©ë‹ˆë‹¤. ì¦‰ì‹œ ì²˜ë¦¬ ë¶€íƒë“œë¦½ë‹ˆë‹¤.',
                            createdAt: '2024-12-06 10:30'
                        }
                    ],
                    subtasks: [
                        {
                            id: 'st-hong-1',
                            title: 'ë„¤íŠ¸ì›Œí¬ ì„¤ì • í™•ì¸',
                            assignee: 'ê¹€ê°œë°œ',
                            startDate: '2024-12-06',
                            endDate: '2024-12-07',
                            status: 'ëŒ€ê¸°',
                            actualHours: 0
                        },
                        {
                            id: 'st-hong-2',
                            title: 'ë“œë¼ì´ë²„ ì¬ì„¤ì¹˜',
                            assignee: 'ê¹€ê°œë°œ',
                            startDate: '2024-12-07',
                            endDate: '2024-12-08',
                            status: 'ëŒ€ê¸°',
                            actualHours: 0
                        }
                    ]
                },
                {
                    id: ticketIdCounter++,
                    ticketNumber: 'TKT-2024-009',
                    title: 'ìš´ì˜íŒ€ ëŒ€ì‹œë³´ë“œ ì°¨íŠ¸ ì¶”ê°€',
                    description: 'ìš´ì˜íŒ€ ì „ìš© ëŒ€ì‹œë³´ë“œì— ì›”ë³„ ë§¤ì¶œ ì°¨íŠ¸ì™€ ê³ ê° ë§Œì¡±ë„ ê·¸ë˜í”„ë¥¼ ì¶”ê°€í•´ì£¼ì„¸ìš”.',
                    requester: 'í™ê¸¸ë™',
                    department: 'ìš´ì˜íŒ€',
                    category: 'ì˜¤ì•„ì‹œìŠ¤',
                    
                    categoryMain: 'ì˜¤ì•„ì‹œìŠ¤',
                    categoryMiddle: 'ê°œë°œìš”ì²­',
                    categorySub: 'ê¸°ëŠ¥ì¶”ê°€',
                    status: 'ì²˜ë¦¬ì¤‘',
                    priority: 'ë³´í†µ',
                    assignees: ['ë°•ë””ìì¸'],
                    createdAt: '2024-12-01',
                    dueDate: '2024-12-12',
                    linkedTickets: [],
                    approved: true,
                    approvedBy: 'IT ë§ˆìŠ¤í„°',
                    approvedAt: '2024-12-01 15:00',
                    comments: [
                        {
                            id: 'cmt-hong-3',
                            author: 'ë°•ë””ìì¸',
                            content: 'ë””ìì¸ ì‘ì—… ì™„ë£Œí–ˆìŠµë‹ˆë‹¤. ê°œë°œ ì§„í–‰ ì¤‘ì…ë‹ˆë‹¤.',
                            createdAt: '2024-12-05 11:00'
                        }
                    ],
                    subtasks: [
                        {
                            id: 'st-hong-3',
                            title: 'ì°¨íŠ¸ ë””ìì¸',
                            assignee: 'ë°•ë””ìì¸',
                            startDate: '2024-12-02',
                            endDate: '2024-12-04',
                            status: 'ì™„ë£Œ',
                            actualHours: 8
                        },
                        {
                            id: 'st-hong-4',
                            title: 'ë§¤ì¶œ ì°¨íŠ¸ ê°œë°œ',
                            assignee: 'ë°•ë””ìì¸',
                            startDate: '2024-12-05',
                            endDate: '2024-12-09',
                            status: 'ì§„í–‰ì¤‘',
                            actualHours: 12
                        },
                        {
                            id: 'st-hong-5',
                            title: 'ë§Œì¡±ë„ ê·¸ë˜í”„ ê°œë°œ',
                            assignee: 'ë°•ë””ìì¸',
                            startDate: '2024-12-10',
                            endDate: '2024-12-12',
                            status: 'ëŒ€ê¸°',
                            actualHours: 0
                        }
                    ]
                },
                {
                    id: ticketIdCounter++,
                    ticketNumber: 'TKT-2024-010',
                    title: 'ê³ ê° ë¬¸ì˜ ì±„íŒ…ë´‡ ì—°ë™',
                    description: 'ê³ ê°ì„¼í„° ì—…ë¬´ íš¨ìœ¨í™”ë¥¼ ìœ„í•´ AI ì±—ë´‡ì„ ì—°ë™í•´ì£¼ì„¸ìš”. FAQ ìë™ ì‘ë‹µ ê¸°ëŠ¥ì´ í•„ìš”í•©ë‹ˆë‹¤.',
                    requester: 'í™ê¸¸ë™',
                    department: 'ìš´ì˜íŒ€',
                    category: 'ì˜¤ì•„ì‹œìŠ¤',
                    
                    categoryMain: 'ì˜¤ì•„ì‹œìŠ¤',
                    categoryMiddle: 'ê°œë°œìš”ì²­',
                    categorySub: 'ì‹ ê·œ',
                    status: 'ê²€ìˆ˜ ëŒ€ê¸°',
                    priority: 'ë†’ìŒ',
                    assignees: ['ê¹€ê°œë°œ'],
                    createdAt: '2024-11-25',
                    dueDate: '2024-12-05',
                    linkedTickets: [],
                    approved: true,
                    approvedBy: 'IT ë§ˆìŠ¤í„°',
                    approvedAt: '2024-11-25 16:00',
                    completionComment: 'ChatGPT APIë¥¼ ì—°ë™í•˜ì—¬ FAQ ìë™ ì‘ë‹µ ê¸°ëŠ¥ì„ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤. ê´€ë¦¬ì í˜ì´ì§€ì—ì„œ FAQ ë°ì´í„°ë¥¼ ì§ì ‘ ì¶”ê°€/ìˆ˜ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. í‰ê·  ì‘ë‹µ ì‹œê°„ 3ì´ˆ ì´ë‚´ë¡œ ìµœì í™”í–ˆìŠµë‹ˆë‹¤.',
                    completionLinks: [
                        'https://wiki.company.com/chatbot-guide',
                        'https://admin.company.com/chatbot-settings'
                    ],
                    completedBy: 'ê¹€ê°œë°œ',
                    completedAt: '2024-12-07 18:00',
                    satisfactionRating: null,
                    userApprovedAt: null,
                    comments: [
                        {
                            id: 'cmt-hong-4',
                            author: 'ê¹€ê°œë°œ',
                            content: 'ì‘ì—… ì™„ë£Œí–ˆìŠµë‹ˆë‹¤. í…ŒìŠ¤íŠ¸ ë¶€íƒë“œë¦½ë‹ˆë‹¤.',
                            createdAt: '2024-12-07 18:00'
                        }
                    ],
                    subtasks: [
                        {
                            id: 'st-hong-6',
                            title: 'ChatGPT API ì—°ë™',
                            assignee: 'ê¹€ê°œë°œ',
                            startDate: '2024-11-26',
                            endDate: '2024-11-30',
                            status: 'ì™„ë£Œ',
                            actualHours: 16
                        },
                        {
                            id: 'st-hong-7',
                            title: 'FAQ ê´€ë¦¬ í˜ì´ì§€ ê°œë°œ',
                            assignee: 'ê¹€ê°œë°œ',
                            startDate: '2024-12-01',
                            endDate: '2024-12-05',
                            status: 'ì™„ë£Œ',
                            actualHours: 20
                        },
                        {
                            id: 'st-hong-8',
                            title: 'ì„±ëŠ¥ ìµœì í™” ë° í…ŒìŠ¤íŠ¸',
                            assignee: 'ê¹€ê°œë°œ',
                            startDate: '2024-12-06',
                            endDate: '2024-12-07',
                            status: 'ì™„ë£Œ',
                            actualHours: 8
                        }
                    ]
                },
                {
                    id: ticketIdCounter++,
                    ticketNumber: 'TKT-2024-011',
                    title: 'ëª¨ë°”ì¼ ì•± í‘¸ì‹œ ì•Œë¦¼ ê¸°ëŠ¥',
                    description: 'ìš´ì˜íŒ€ ëª¨ë°”ì¼ ì•±ì— ì¤‘ìš” ê³µì§€ í‘¸ì‹œ ì•Œë¦¼ ê¸°ëŠ¥ì„ ì¶”ê°€í•´ì£¼ì„¸ìš”.',
                    requester: 'í™ê¸¸ë™',
                    department: 'ìš´ì˜íŒ€',
                    category: 'ì˜¤ì•„ì‹œìŠ¤',
                    
                    categoryMain: 'ì˜¤ì•„ì‹œìŠ¤',
                    categoryMiddle: 'ê°œë°œìš”ì²­',
                    categorySub: 'ê¸°ëŠ¥ì¶”ê°€',
                    status: 'ì™„ë£Œ',
                    priority: 'ë³´í†µ',
                    assignees: ['ë°•ë””ìì¸'],
                    createdAt: '2024-11-20',
                    dueDate: '2024-12-01',
                    linkedTickets: [],
                    approved: true,
                    approvedBy: 'IT ë§ˆìŠ¤í„°',
                    approvedAt: '2024-11-20 09:00',
                    completionComment: 'í‘¸ì‹œ ì•Œë¦¼ ê¸°ëŠ¥ì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤. Firebase Cloud Messagingì„ ì‚¬ìš©í•˜ì—¬ êµ¬í˜„í–ˆìœ¼ë©°, ì„¤ì • ë©”ë‰´ì—ì„œ ì•Œë¦¼ on/offê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤.',
                    completionLinks: ['https://docs.company.com/push-notification-guide'],
                    completedBy: 'ë°•ë””ìì¸',
                    completedAt: '2024-11-30 17:00',
                    satisfactionRating: 5,
                    userApprovedAt: '2024-12-01 10:00',
                    userApprovedBy: 'í™ê¸¸ë™',
                    comments: [
                        {
                            id: 'cmt-hong-5',
                            author: 'í™ê¸¸ë™',
                            content: '[ìµœì¢… í™•ì¸ ì™„ë£Œ]\në§Œì¡±ë„: â­â­â­â­â­\nì˜ê²¬: ë¹ ë¥¸ ì‘ì—… ê°ì‚¬í•©ë‹ˆë‹¤. í‘¸ì‹œ ì•Œë¦¼ì´ ì˜ ì‘ë™í•©ë‹ˆë‹¤!',
                            createdAt: '2024-12-01 10:00'
                        }
                    ],
                    subtasks: [
                        {
                            id: 'st-hong-9',
                            title: 'Firebase ì„¤ì •',
                            assignee: 'ë°•ë””ìì¸',
                            startDate: '2024-11-21',
                            endDate: '2024-11-23',
                            status: 'ì™„ë£Œ',
                            actualHours: 6
                        },
                        {
                            id: 'st-hong-10',
                            title: 'í‘¸ì‹œ ì•Œë¦¼ UI ê°œë°œ',
                            assignee: 'ë°•ë””ìì¸',
                            startDate: '2024-11-24',
                            endDate: '2024-11-28',
                            status: 'ì™„ë£Œ',
                            actualHours: 16
                        },
                        {
                            id: 'st-hong-11',
                            title: 'ì•Œë¦¼ ì„¤ì • ë©”ë‰´ ì¶”ê°€',
                            assignee: 'ë°•ë””ìì¸',
                            startDate: '2024-11-29',
                            endDate: '2024-11-30',
                            status: 'ì™„ë£Œ',
                            actualHours: 6
                        }
                    ]
                },
                {
                    id: ticketIdCounter++,
                    ticketNumber: 'TKT-2024-012',
                    title: 'ì—…ë¬´ ë³´ê³ ì„œ ìë™ ìƒì„± ê¸°ëŠ¥',
                    description: 'ì£¼ê°„/ì›”ê°„ ì—…ë¬´ ë³´ê³ ì„œë¥¼ ìë™ìœ¼ë¡œ ìƒì„±í•˜ëŠ” ê¸°ëŠ¥ì´ í•„ìš”í•©ë‹ˆë‹¤. Excel í˜•íƒœë¡œ ë‹¤ìš´ë¡œë“œ ê°€ëŠ¥í•´ì•¼ í•©ë‹ˆë‹¤.',
                    requester: 'í™ê¸¸ë™',
                    department: 'ìš´ì˜íŒ€',
                    category: 'ì˜¤ì•„ì‹œìŠ¤',
                    
                    categoryMain: 'ì˜¤ì•„ì‹œìŠ¤',
                    categoryMiddle: 'ê°œë°œìš”ì²­',
                    categorySub: 'ì‹ ê·œ',
                    status: 'ë³´ë¥˜',
                    priority: 'ë‚®ìŒ',
                    assignees: ['ê¹€ê°œë°œ'],
                    createdAt: '2024-11-28',
                    dueDate: '2024-12-20',
                    linkedTickets: [],
                    approved: true,
                    approvedBy: 'IT ë§ˆìŠ¤í„°',
                    approvedAt: '2024-11-28 14:00',
                    comments: [
                        {
                            id: 'cmt-hong-6',
                            author: 'ê¹€ê°œë°œ',
                            content: 'ë” ìš°ì„ ìˆœìœ„ ë†’ì€ ì‘ì—…ì´ ìˆì–´ ì¼ì‹œ ë³´ë¥˜í•©ë‹ˆë‹¤. 12ì›” 15ì¼ë¶€í„° ì¬ê°œ ì˜ˆì •ì…ë‹ˆë‹¤.',
                            createdAt: '2024-12-02 11:00'
                        },
                        {
                            id: 'cmt-hong-7',
                            author: 'í™ê¸¸ë™',
                            content: 'ì•Œê² ìŠµë‹ˆë‹¤. ê¸‰í•œ ê±´ ì•„ë‹ˆë‹ˆ ì²œì²œíˆ ì§„í–‰í•´ì£¼ì„¸ìš”.',
                            createdAt: '2024-12-02 14:00'
                        }
                    ],
                    subtasks: []
                },
                {
                    id: ticketIdCounter++,
                    ticketNumber: 'TKT-2024-013',
                    title: 'ì‚¬ìš©ì ê¶Œí•œ ê´€ë¦¬ ê°œì„ ',
                    description: 'í˜„ì¬ ê¶Œí•œ ì„¤ì •ì´ ë³µì¡í•©ë‹ˆë‹¤. ë” ì§ê´€ì ì¸ UIë¡œ ê°œì„  ë¶€íƒë“œë¦½ë‹ˆë‹¤.',
                    requester: 'í™ê¸¸ë™',
                    department: 'ìš´ì˜íŒ€',
                    category: 'ë³´ì•ˆ',
                    
                    categoryMain: 'ë³´ì•ˆ',
                    categoryMiddle: 'ìš´ì˜ê´€ë¦¬',
                    categorySub: 'ê¶Œí•œìš”ì²­',
                    status: 'ë°˜ë ¤',
                    priority: 'ë‚®ìŒ',
                    assignees: [],
                    createdAt: '2024-11-22',
                    dueDate: '2024-12-10',
                    linkedTickets: [],
                    approved: null,
                    comments: [
                        {
                            id: 'cmt-hong-8',
                            author: 'ê¹€ê°œë°œ',
                            content: '[ë°˜ë ¤]\ní˜„ì¬ ê¶Œí•œ ì‹œìŠ¤í…œì€ ë³´ì•ˆ ì •ì±…ì— ë”°ë¼ ì„¤ê³„ë˜ì—ˆìŠµë‹ˆë‹¤. êµ¬ì²´ì ì¸ ê°œì„  ì‚¬í•­ì„ ëª…ì‹œí•œ í›„ ì¬ìš”ì²­ ë¶€íƒë“œë¦½ë‹ˆë‹¤.',
                            createdAt: '2024-11-23 09:00'
                        }
                    ],
                    subtasks: []
                }
            ];
            tickets = demoTickets;
            
            // ìƒ˜í”Œ í”„ë¡œì íŠ¸ ë°ì´í„°
            const demoProjects = [
                {
                    id: 1,
                    projectNumber: 'PRJ-2024-001',
                    title: 'ì¸íŠ¸ë¼ë„· ì „ë©´ ê°œí¸ í”„ë¡œì íŠ¸',
                    description: 'ì‚¬ìš©ì ê²½í—˜ ê°œì„ ì„ ìœ„í•œ ì „ì²´ ë¦¬ë‰´ì–¼ ì‘ì—…. ëª¨ë˜í•œ UI/UX ì ìš© ë° ì„±ëŠ¥ ìµœì í™”ë¥¼ ëª©í‘œë¡œ í•©ë‹ˆë‹¤.',
                    startDate: '2024-12-01',
                    endDate: '2025-03-31',
                    status: 'ì§„í–‰ì¤‘',
                    links: [
                        { id: 'link1', title: 'Figma ë””ìì¸', url: 'https://figma.com/design/...' },
                        { id: 'link2', title: 'Confluence ê¸°íšì„œ', url: 'https://confluence.com/...' }
                    ],
                    linkedTickets: [1, 2],
                    createdBy: 'IT ê´€ë¦¬ì',
                    createdAt: '2024-11-20'
                },
                {
                    id: 2,
                    projectNumber: 'PRJ-2024-002',
                    title: 'GMS ì‹œìŠ¤í…œ ê³ ë„í™”',
                    description: 'GMS ì‹œìŠ¤í…œì˜ ì „ë°˜ì ì¸ ê¸°ëŠ¥ ê°œì„  ë° ì‹ ê·œ ëª¨ë“ˆ ì¶”ê°€',
                    startDate: '2024-11-15',
                    endDate: '2024-12-31',
                    status: 'ì§„í–‰ì¤‘',
                    links: [],
                    linkedTickets: [3],
                    createdBy: 'IT ê´€ë¦¬ì',
                    createdAt: '2024-11-10'
                }
            ];
            projects = demoProjects;
            projectIdCounter = projects.length + 1;
            
            // ğŸ¢ ìì‚° ë°ì´í„° ì´ˆê¸°í™”
            const demoAssets = [
                // í•˜ë“œì›¨ì–´
                {
                    id: assetIdCounter++,
                    code: 'HW-001',
                    category: 'í•˜ë“œì›¨ì–´',
                    type: 'ë…¸íŠ¸ë¶',
                    name: 'LG ê·¸ë¨ 17ì¸ì¹˜',
                    manufacturer: 'LG',
                    status: 'ì‚¬ìš©ì¤‘',
                    currentUser: 'í™ê¸¸ë™',
                    assignedAt: '2024-01-15',
                    purchaseDate: '2024-01-01',
                    purchasePrice: 2100000,
                    specs: { cpu: 'i7-13', ram: '16GB', storage: '512GB SSD' },
                    recommendedGrade: 'ê³¼ì¥',
                    history: [{ date: '2024-01-15', user: 'í™ê¸¸ë™', action: 'ì§€ê¸‰', note: 'ì‹ ê·œ ë°°ì •' }]
                },
                {
                    id: assetIdCounter++,
                    code: 'HW-002',
                    category: 'í•˜ë“œì›¨ì–´',
                    type: 'ë…¸íŠ¸ë¶',
                    name: 'MacBook Pro 14',
                    manufacturer: 'Apple',
                    status: 'ì‚¬ìš©ì¤‘',
                    currentUser: 'ê¹€ì² ìˆ˜',
                    assignedAt: '2024-02-10',
                    purchaseDate: '2024-02-01',
                    purchasePrice: 2890000,
                    specs: { cpu: 'M3 Pro', ram: '16GB', storage: '512GB' },
                    recommendedGrade: 'ë¶€ì¥',
                    history: [{ date: '2024-02-10', user: 'ê¹€ì² ìˆ˜', action: 'ì§€ê¸‰', note: 'ì„ì› ìŠ¹ì§„' }]
                },
                {
                    id: assetIdCounter++,
                    code: 'HW-003',
                    category: 'í•˜ë“œì›¨ì–´',
                    type: 'PC',
                    name: 'ì‚¼ì„± ë°ìŠ¤í¬íƒ‘ ì¤‘ê¸‰',
                    manufacturer: 'ì‚¼ì„±',
                    status: 'ëŒ€ê¸°',
                    currentUser: null,
                    purchaseDate: '2024-06-01',
                    purchasePrice: 1450000,
                    specs: { cpu: 'i5-12', ram: '16GB', storage: '256GB SSD' },
                    recommendedGrade: 'ëŒ€ë¦¬',
                    history: []
                },
                // ì¶”ê°€ ëŒ€ê¸° ì¥ë¹„ë“¤ ğŸ†•
                {
                    id: assetIdCounter++,
                    code: 'HW-006',
                    category: 'í•˜ë“œì›¨ì–´',
                    type: 'ë…¸íŠ¸ë¶',
                    name: 'LG ê·¸ë¨ 14ì¸ì¹˜ ë³´ê¸‰í˜•',
                    manufacturer: 'LG',
                    status: 'ëŒ€ê¸°',
                    currentUser: null,
                    purchaseDate: '2024-11-01',
                    purchasePrice: 1350000,
                    specs: { cpu: 'i5-12', ram: '8GB', storage: '256GB SSD' },
                    recommendedGrade: 'ì‚¬ì›',
                    history: []
                },
                {
                    id: assetIdCounter++,
                    code: 'HW-007',
                    category: 'í•˜ë“œì›¨ì–´',
                    type: 'ë…¸íŠ¸ë¶',
                    name: 'LG ê·¸ë¨ 15ì¸ì¹˜',
                    manufacturer: 'LG',
                    status: 'ëŒ€ê¸°',
                    currentUser: null,
                    purchaseDate: '2024-11-05',
                    purchasePrice: 1850000,
                    specs: { cpu: 'i7-12', ram: '16GB', storage: '512GB SSD' },
                    recommendedGrade: 'ê³¼ì¥',
                    history: []
                },
                {
                    id: assetIdCounter++,
                    code: 'HW-008',
                    category: 'í•˜ë“œì›¨ì–´',
                    type: 'ë…¸íŠ¸ë¶',
                    name: 'MacBook Air M2',
                    manufacturer: 'Apple',
                    status: 'ëŒ€ê¸°',
                    currentUser: null,
                    purchaseDate: '2024-11-10',
                    purchasePrice: 1690000,
                    specs: { cpu: 'M2', ram: '16GB', storage: '512GB' },
                    recommendedGrade: 'ì°¨ì¥',
                    history: []
                },
                {
                    id: assetIdCounter++,
                    code: 'HW-009',
                    category: 'í•˜ë“œì›¨ì–´',
                    type: 'ë…¸íŠ¸ë¶',
                    name: 'MacBook Pro 16ì¸ì¹˜',
                    manufacturer: 'Apple',
                    status: 'ëŒ€ê¸°',
                    currentUser: null,
                    purchaseDate: '2024-11-15',
                    purchasePrice: 3590000,
                    specs: { cpu: 'M3 Pro', ram: '32GB', storage: '1TB' },
                    recommendedGrade: 'ë¶€ì¥',
                    history: []
                },
                {
                    id: assetIdCounter++,
                    code: 'HW-010',
                    category: 'í•˜ë“œì›¨ì–´',
                    type: 'ë…¸íŠ¸ë¶',
                    name: 'MacBook Pro 16ì¸ì¹˜ Max',
                    manufacturer: 'Apple',
                    status: 'ëŒ€ê¸°',
                    currentUser: null,
                    purchaseDate: '2024-11-20',
                    purchasePrice: 4890000,
                    specs: { cpu: 'M3 Max', ram: '64GB', storage: '2TB' },
                    recommendedGrade: 'ì„ì›',
                    history: []
                },
                {
                    id: assetIdCounter++,
                    code: 'HW-011',
                    category: 'í•˜ë“œì›¨ì–´',
                    type: 'ëª¨ë‹ˆí„°',
                    name: 'ì‚¼ì„± 24ì¸ì¹˜ ëª¨ë‹ˆí„°',
                    manufacturer: 'ì‚¼ì„±',
                    status: 'ëŒ€ê¸°',
                    currentUser: null,
                    purchaseDate: '2024-11-01',
                    purchasePrice: 280000,
                    specs: { size: '24inch', resolution: '1920x1080' },
                    recommendedGrade: 'ì‚¬ì›',
                    history: []
                },
                {
                    id: assetIdCounter++,
                    code: 'HW-012',
                    category: 'í•˜ë“œì›¨ì–´',
                    type: 'ëª¨ë‹ˆí„°',
                    name: 'LG 27ì¸ì¹˜ ëª¨ë‹ˆí„°',
                    manufacturer: 'LG',
                    status: 'ëŒ€ê¸°',
                    currentUser: null,
                    purchaseDate: '2024-11-05',
                    purchasePrice: 450000,
                    specs: { size: '27inch', resolution: '2560x1440' },
                    recommendedGrade: 'ê³¼ì¥',
                    history: []
                },
                {
                    id: assetIdCounter++,
                    code: 'HW-004',
                    category: 'í•˜ë“œì›¨ì–´',
                    type: 'ëª¨ë‹ˆí„°',
                    name: 'LG ìš¸íŠ¸ë¼ì™€ì´ë“œ 34ì¸ì¹˜',
                    manufacturer: 'LG',
                    status: 'ì‚¬ìš©ì¤‘',
                    currentUser: 'í™ê¸¸ë™',
                    assignedAt: '2024-03-01',
                    purchaseDate: '2024-02-20',
                    purchasePrice: 650000,
                    specs: { size: '34inch', resolution: '3440x1440' },
                    recommendedGrade: 'ê³¼ì¥',
                    history: [{ date: '2024-03-01', user: 'í™ê¸¸ë™', action: 'ì§€ê¸‰' }]
                },
                {
                    id: assetIdCounter++,
                    code: 'HW-005',
                    category: 'í•˜ë“œì›¨ì–´',
                    type: 'ë…¸íŠ¸ë¶',
                    name: 'ë ˆë…¸ë²„ ThinkPad',
                    manufacturer: 'Lenovo',
                    status: 'ê³ ì¥',
                    currentUser: 'ì´ì˜í¬',
                    assignedAt: '2023-11-01',
                    purchaseDate: '2023-10-15',
                    purchasePrice: 1800000,
                    specs: { cpu: 'i7-11', ram: '16GB', storage: '512GB' },
                    recommendedGrade: 'ì°¨ì¥',
                    history: [
                        { date: '2023-11-01', user: 'ì´ì˜í¬', action: 'ì§€ê¸‰' },
                        { date: '2024-12-01', user: 'ì´ì˜í¬', action: 'ê³ ì¥ì‹ ê³ ', note: 'ë°°í„°ë¦¬ ë¶ˆëŸ‰' }
                    ]
                },
                
                // ì†Œí”„íŠ¸ì›¨ì–´
                {
                    id: assetIdCounter++,
                    code: 'SW-001',
                    category: 'ì†Œí”„íŠ¸ì›¨ì–´',
                    type: 'MS Office',
                    name: 'Microsoft Office 365',
                    manufacturer: 'Microsoft',
                    status: 'ì‚¬ìš©ì¤‘',
                    currentUser: 'í™ê¸¸ë™',
                    licenseType: 'Subscription',
                    monthlyFee: 12900,
                    expiryDate: '2025-12-31',
                    licenseKey: 'M365-XXXXX-XXXXX',
                    assignedAt: '2024-01-01',
                    history: [{ date: '2024-01-01', user: 'í™ê¸¸ë™', action: 'ë°œê¸‰' }]
                },
                {
                    id: assetIdCounter++,
                    code: 'SW-002',
                    category: 'ì†Œí”„íŠ¸ì›¨ì–´',
                    type: 'í•œê¸€',
                    name: 'í•œê¸€ 2022',
                    manufacturer: 'í•œì»´',
                    status: 'ì‚¬ìš©ì¤‘',
                    currentUser: 'ê¹€ì² ìˆ˜',
                    licenseType: 'Perpetual',
                    purchasePrice: 198000,
                    licenseKey: 'HWP2022-XXXX-XXXX',
                    expiryDate: null,
                    assignedAt: '2024-02-01',
                    history: [{ date: '2024-02-01', user: 'ê¹€ì² ìˆ˜', action: 'ë°œê¸‰' }]
                },
                {
                    id: assetIdCounter++,
                    code: 'SW-003',
                    category: 'ì†Œí”„íŠ¸ì›¨ì–´',
                    type: 'Adobe',
                    name: 'Adobe Creative Cloud',
                    manufacturer: 'Adobe',
                    status: 'ì‚¬ìš©ì¤‘',
                    currentUser: 'ë°•ë””ìì¸',
                    licenseType: 'Subscription',
                    monthlyFee: 65000,
                    expiryDate: '2025-06-30',
                    licenseKey: 'ACC-XXXXX-XXXXX',
                    assignedAt: '2024-07-01',
                    history: [{ date: '2024-07-01', user: 'ë°•ë””ìì¸', action: 'ë°œê¸‰' }]
                },
                {
                    id: assetIdCounter++,
                    code: 'SW-004',
                    category: 'ì†Œí”„íŠ¸ì›¨ì–´',
                    type: 'ê°œë°œë„êµ¬',
                    name: 'IntelliJ IDEA Ultimate',
                    manufacturer: 'JetBrains',
                    status: 'ì‚¬ìš©ì¤‘',
                    currentUser: 'ê¹€ê°œë°œ',
                    licenseType: 'Subscription',
                    monthlyFee: 18900,
                    expiryDate: '2025-03-31',
                    licenseKey: 'IJ-XXXXX-XXXXX',
                    assignedAt: '2024-04-01',
                    history: [{ date: '2024-04-01', user: 'ê¹€ê°œë°œ', action: 'ë°œê¸‰' }]
                },
                {
                    id: assetIdCounter++,
                    code: 'SW-005',
                    category: 'ì†Œí”„íŠ¸ì›¨ì–´',
                    type: 'MS Office',
                    name: 'Microsoft Office 365',
                    manufacturer: 'Microsoft',
                    status: 'ëŒ€ê¸°',
                    currentUser: null,
                    licenseType: 'Subscription',
                    monthlyFee: 12900,
                    expiryDate: '2025-12-31',
                    licenseKey: 'M365-YYYYY-YYYYY',
                    history: []
                },
                
                // ë¼ì´ì„ ìŠ¤
                {
                    id: assetIdCounter++,
                    code: 'LIC-001',
                    category: 'ë¼ì´ì„ ìŠ¤',
                    type: 'Named User',
                    name: 'Windows 11 Pro',
                    manufacturer: 'Microsoft',
                    status: 'ì‚¬ìš©ì¤‘',
                    currentUser: 'í™ê¸¸ë™',
                    licenseType: 'Named User',
                    purchasePrice: 250000,
                    licenseKey: 'WIN11-XXXXX-XXXXX',
                    expiryDate: null,
                    assignedAt: '2024-01-15',
                    history: [{ date: '2024-01-15', user: 'í™ê¸¸ë™', action: 'ë°œê¸‰' }]
                },
                {
                    id: assetIdCounter++,
                    code: 'LIC-002',
                    category: 'ë¼ì´ì„ ìŠ¤',
                    type: 'Concurrent',
                    name: 'Zoom Pro',
                    manufacturer: 'Zoom',
                    status: 'ì‚¬ìš©ì¤‘',
                    currentUser: 'ITíŒ€',
                    licenseType: 'Concurrent',
                    maxUsers: 100,
                    monthlyFee: 150000,
                    expiryDate: '2025-12-31',
                    licenseKey: 'ZOOM-XXXXX-XXXXX',
                    assignedAt: '2024-01-01',
                    history: [{ date: '2024-01-01', user: 'ITíŒ€', action: 'ë°œê¸‰', note: 'ì „ì‚¬ ë¼ì´ì„ ìŠ¤' }]
                },
                {
                    id: assetIdCounter++,
                    code: 'LIC-003',
                    category: 'ë¼ì´ì„ ìŠ¤',
                    type: 'Subscription',
                    name: 'Figma Professional',
                    manufacturer: 'Figma',
                    status: 'ì‚¬ìš©ì¤‘',
                    currentUser: 'ë°•ë””ìì¸',
                    licenseType: 'Subscription',
                    monthlyFee: 15000,
                    expiryDate: '2025-06-30',
                    licenseKey: 'FIG-XXXXX-XXXXX',
                    assignedAt: '2024-07-01',
                    history: [{ date: '2024-07-01', user: 'ë°•ë””ìì¸', action: 'ë°œê¸‰' }]
                },
                
                // í´ë¼ìš°ë“œ
                {
                    id: assetIdCounter++,
                    code: 'CLD-001',
                    category: 'í´ë¼ìš°ë“œ',
                    type: 'AWS',
                    name: 'AWS EC2 - Production',
                    manufacturer: 'Amazon',
                    status: 'ì‚¬ìš©ì¤‘',
                    currentUser: 'ITíŒ€',
                    licenseType: 'Subscription',
                    monthlyFee: 450000,
                    specs: { instance: 't3.large', region: 'ap-northeast-2', storage: '200GB' },
                    assignedAt: '2024-01-01',
                    history: [{ date: '2024-01-01', user: 'ITíŒ€', action: 'êµ¬ë… ì‹œì‘' }]
                },
                {
                    id: assetIdCounter++,
                    code: 'CLD-002',
                    category: 'í´ë¼ìš°ë“œ',
                    type: 'Azure',
                    name: 'Azure Database',
                    manufacturer: 'Microsoft',
                    status: 'ì‚¬ìš©ì¤‘',
                    currentUser: 'ITíŒ€',
                    licenseType: 'Subscription',
                    monthlyFee: 280000,
                    specs: { tier: 'Standard S2', storage: '250GB' },
                    assignedAt: '2024-03-01',
                    history: [{ date: '2024-03-01', user: 'ITíŒ€', action: 'êµ¬ë… ì‹œì‘' }]
                },
                {
                    id: assetIdCounter++,
                    code: 'CLD-003',
                    category: 'í´ë¼ìš°ë“œ',
                    type: 'SaaS',
                    name: 'Slack Business+',
                    manufacturer: 'Slack',
                    status: 'ì‚¬ìš©ì¤‘',
                    currentUser: 'ì „ì‚¬',
                    licenseType: 'Subscription',
                    monthlyFee: 600000,
                    maxUsers: 150,
                    expiryDate: '2025-12-31',
                    assignedAt: '2024-01-01',
                    history: [{ date: '2024-01-01', user: 'ì „ì‚¬', action: 'êµ¬ë… ì‹œì‘' }]
                },
                {
                    id: assetIdCounter++,
                    code: 'CLD-004',
                    category: 'í´ë¼ìš°ë“œ',
                    type: 'ìŠ¤í† ë¦¬ì§€',
                    name: 'Google Workspace Business',
                    manufacturer: 'Google',
                    status: 'ì‚¬ìš©ì¤‘',
                    currentUser: 'ì „ì‚¬',
                    licenseType: 'Subscription',
                    monthlyFee: 1200000,
                    maxUsers: 200,
                    specs: { storage: 'ë¬´ì œí•œ', users: 200 },
                    expiryDate: '2025-12-31',
                    assignedAt: '2024-01-01',
                    history: [{ date: '2024-01-01', user: 'ì „ì‚¬', action: 'êµ¬ë… ì‹œì‘' }]
                },
                {
                    id: assetIdCounter++,
                    code: 'CLD-005',
                    category: 'í´ë¼ìš°ë“œ',
                    type: 'GCP',
                    name: 'Google Cloud Storage',
                    manufacturer: 'Google',
                    status: 'ì‚¬ìš©ì¤‘',
                    currentUser: 'ITíŒ€',
                    licenseType: 'Subscription',
                    monthlyFee: 120000,
                    specs: { storage: '5TB', region: 'asia-northeast3' },
                    assignedAt: '2024-05-01',
                    history: [{ date: '2024-05-01', user: 'ITíŒ€', action: 'êµ¬ë… ì‹œì‘' }]
                }
            ];
            
            assets = demoAssets;
            
            // ê¸°ì¡´ í‹°ì¼“ë“¤ì— categoryì™€ linkedTickets í•„ë“œ ì¶”ê°€
            const categories = ['ì˜¤ì•„ì‹œìŠ¤', 'ì¸í”„ë¼', 'ë¶€ë™ì‚°', 'í™˜ê²½', 'GMS', 'ê¸°íƒ€'];
            tickets.forEach((ticket, index) => {
                if (!ticket.category) {
                    ticket.category = categories[index % categories.length];
                }
                if (!ticket.linkedTickets) {
                    ticket.linkedTickets = [];
                }
                // ì½”ë©˜íŠ¸ ë°°ì—´ ì´ˆê¸°í™”
                if (!ticket.comments) {
                    ticket.comments = [];
                }
            });
        }

        // Switch Role
        function switchRole(role) {
            // user ê¶Œí•œë§Œ ITíŒ€ íƒ­ ì ‘ê·¼ ì°¨ë‹¨ (ë§ˆìŠ¤í„°ëŠ” ëª¨ë“  ê¶Œí•œ)
            if (role === 'admin' && currentUser.role === 'user') {
                alert('â›” ITíŒ€ í™”ë©´ì€ IT ê´€ë¦¬ìë§Œ ì ‘ê·¼ ê°€ëŠ¥í•©ë‹ˆë‹¤.\n\nê¶Œí•œì´ í•„ìš”í•˜ì‹  ê²½ìš° ITíŒ€ì— ë¬¸ì˜í•´ì£¼ì„¸ìš”.\nğŸ“§ it-support@company.com');
                return;
            }
            
            currentRole = role;
            
            // Update UI
            document.getElementById('user-role-btn').classList.toggle('active', role === 'user');
            document.getElementById('admin-role-btn').classList.toggle('active', role === 'admin');
            document.getElementById('user-view').classList.toggle('hidden', role !== 'user');
            document.getElementById('admin-view').classList.toggle('hidden', role !== 'admin');
            
            // Update user info
            if (role === 'admin') {
                document.getElementById('current-user-name').textContent = currentUser.name;
                document.getElementById('current-user-role').textContent = currentUser.department;
            } else {
                document.getElementById('current-user-name').textContent = currentUser.name;
                document.getElementById('current-user-role').textContent = currentUser.department;
            }
            
            // Render appropriate view
            if (role === 'user') {
                renderUserView();
            } else {
                renderAdminView();
            }
        }

        // Render User View
        function renderUserView() {
            updateUserStats();
            renderUserTickets();
        }

        // Update User Stats
        function updateUserStats() {
            const userTickets = tickets.filter(t => t.requester === currentUser.name);
            document.getElementById('user-stat-total').textContent = userTickets.length;
            document.getElementById('user-stat-pending').textContent = userTickets.filter(t => t.status === 'ìš”ì²­').length;
            document.getElementById('user-stat-processing').textContent = userTickets.filter(t => t.status === 'ì ‘ìˆ˜' || t.status === 'ì²˜ë¦¬ì¤‘').length;
            document.getElementById('user-stat-completed').textContent = userTickets.filter(t => t.status === 'ì™„ë£Œ').length;
            document.getElementById('user-stat-hold').textContent = userTickets.filter(t => t.status === 'ë³´ë¥˜' || t.status === 'ë°˜ë ¤').length;
        }

        // Render User Tickets
        function renderUserTickets() {
            const container = document.getElementById('user-ticket-list');
            const filter = document.getElementById('user-status-filter').value;
            
            // ë§ˆìŠ¤í„°ëŠ” ëª¨ë“  í‹°ì¼“, ì¼ë°˜ ì‚¬ìš©ìëŠ” ë³¸ì¸ í‹°ì¼“ë§Œ
            let userTickets = currentUser.role === 'master' 
                ? tickets 
                : tickets.filter(t => t.requester === currentUser.name);
            
            // ì§„í–‰ ì¤‘ì¸ ìš”ì²­ í‘œì‹œ (user only)
            if (currentUser.role !== 'master') {
                const activeTickets = userTickets.filter(t => 
                    ['ìš”ì²­', 'ê²¬ì í™•ì¸', 'ìŠ¹ì¸ëŒ€ê¸°', 'ì ‘ìˆ˜', 'ì²˜ë¦¬ì¤‘', 'ì¬ê²€ìˆ˜ì¤‘', 'ê²€ìˆ˜ ëŒ€ê¸°'].includes(t.status)
                );
                renderActiveRequests(activeTickets);
            }
            
            if (filter) {
                userTickets = userTickets.filter(t => t.status === filter);
            }
            
            // í…Œì´ë¸” í—¤ë” ë™ì  ë³€ê²½ (ë§ˆìŠ¤í„°ë§Œ ì‹ ì²­ì ì»¬ëŸ¼ í‘œì‹œ)
            const tableHeader = container.closest('table').querySelector('thead tr');
            if (currentUser.role === 'master') {
                tableHeader.innerHTML = `
                    <th style="width: 80px;">í‹°ì¼“ë²ˆí˜¸</th>
                    <th style="width: 100px;">ì‹ ì²­ì</th>
                    <th style="width: 100px;">ìƒíƒœ</th>
                    <th style="width: 60px;">ìš°ì„ ìˆœìœ„</th>
                    <th>ì œëª©</th>
                    <th style="width: 120px;">ìš”ì²­ì¼</th>
                    <th style="width: 120px;">ì˜ˆìƒì™„ë£Œì¼</th>
                    <th style="width: 120px;">ë‹´ë‹¹ì</th>
                    <th style="width: 100px;">ì§„í–‰ë¥ </th>
                `;
            } else {
                tableHeader.innerHTML = `
                    <th style="width: 80px;">í‹°ì¼“ë²ˆí˜¸</th>
                    <th style="width: 100px;">ìƒíƒœ</th>
                    <th style="width: 60px;">ìš°ì„ ìˆœìœ„</th>
                    <th>ì œëª©</th>
                    <th style="width: 120px;">ìš”ì²­ì¼</th>
                    <th style="width: 120px;">ì˜ˆìƒì™„ë£Œì¼</th>
                    <th style="width: 120px;">ë‹´ë‹¹ì</th>
                    <th style="width: 100px;">ì§„í–‰ë¥ </th>
                `;
            }
            
            if (userTickets.length === 0) {
                const colspan = currentUser.role === 'master' ? 9 : 8;
                container.innerHTML = `<tr><td colspan="${colspan}" class="text-center py-12 text-gray-500">í‹°ì¼“ì´ ì—†ìŠµë‹ˆë‹¤.</td></tr>`;
                return;
            }
            
            container.innerHTML = userTickets.map(ticket => {
                const progress = calculateProgress(ticket);
                const isMyTicket = ticket.requester === currentUser.name;
                return `
                    <tr onclick="openTicketDetail(${ticket.id})" class="${!isMyTicket && currentUser.role === 'master' ? 'bg-blue-50' : ''}">
                        <td><span class="font-mono text-sm font-semibold text-blue-600">${ticket.ticketNumber}</span></td>
                        ${currentUser.role === 'master' ? `
                            <td class="font-semibold text-gray-700">
                                <i class="fas fa-user text-blue-500 mr-1"></i>${ticket.requester}
                                ${isMyTicket ? '<span class="text-xs text-green-600 ml-1">(ë³¸ì¸)</span>' : ''}
                            </td>
                        ` : ''}
                        <td><span class="status-badge status-${ticket.status}">${ticket.status}</span></td>
                        <td>
                            <i class="fas fa-flag priority-${ticket.priority === 'ë†’ìŒ' ? 'high' : ticket.priority === 'ë³´í†µ' ? 'medium' : 'low'}"></i>
                            <span class="text-sm ml-1">${ticket.priority}</span>
                        </td>
                        <td class="font-medium text-gray-800">${ticket.title}</td>
                        <td class="text-gray-600 text-sm">${ticket.createdAt}</td>
                        <td class="text-gray-600 text-sm">${ticket.dueDate || '-'}</td>
                        <td class="text-sm">
                            ${ticket.assignees.length > 0 ? 
                                `<span class="text-blue-600">${ticket.assignees[0]}${ticket.assignees.length > 1 ? ` ì™¸ ${ticket.assignees.length - 1}ëª…` : ''}</span>` 
                                : '<span class="text-gray-400">ë¯¸ë°°ì •</span>'}
                        </td>
                        <td>
                            <div class="flex items-center space-x-2">
                                <div class="flex-1 bg-gray-200 rounded-full h-2">
                                    <div class="bg-gradient-to-r from-blue-500 to-purple-500 h-2 rounded-full transition-all" style="width: ${progress}%"></div>
                                </div>
                                <span class="text-sm font-semibold text-gray-600">${progress}%</span>
                            </div>
                        </td>
                    </tr>
                `;
            }).join('');
        }

        // Calculate Progress
        function calculateProgress(ticket) {
            if (ticket.status === 'ì™„ë£Œ') return 100;
            if (ticket.status === 'ìš”ì²­') return 0;
            if (ticket.subtasks.length === 0) {
                if (ticket.status === 'ì²˜ë¦¬ì¤‘') return 50;
                if (ticket.status === 'ì ‘ìˆ˜') return 20;
                return 0;
            }
            const completed = ticket.subtasks.filter(st => st.status === 'ì™„ë£Œ').length;
            return Math.round((completed / ticket.subtasks.length) * 100);
        }

        // í•˜ìœ„ì—…ë¬´ ìƒíƒœ ê¸°ë°˜ í‹°ì¼“ ìƒíƒœ ìë™ ì—…ë°ì´íŠ¸
        function updateTicketStatusFromSubtasks(ticketId) {
            const ticket = tickets.find(t => t.id === ticketId);
            if (!ticket || ticket.subtasks.length === 0) return;
            
            const allCompleted = ticket.subtasks.every(st => st.status === 'ì™„ë£Œ');
            const anyInProgress = ticket.subtasks.some(st => st.status === 'ì§„í–‰ì¤‘');
            
            // ëª¨ë“  í•˜ìœ„ì—…ë¬´ê°€ ì™„ë£Œë˜ë©´ í‹°ì¼“ ìë™ ê²€ìˆ˜ ëŒ€ê¸°
            if (allCompleted && ticket.status !== 'ì™„ë£Œ' && ticket.status !== 'ê²€ìˆ˜ ëŒ€ê¸°') {
                ticket.status = 'ê²€ìˆ˜ ëŒ€ê¸°';
                console.log(`ğŸ”„ ìë™ ìƒíƒœ ì „í™˜: ${ticket.ticketNumber} â†’ ê²€ìˆ˜ ëŒ€ê¸° (ëª¨ë“  í•˜ìœ„ì—…ë¬´ ì™„ë£Œ)`);
            }
            // í•˜ë‚˜ë¼ë„ ì§„í–‰ì¤‘ì´ë©´ í‹°ì¼“ ìë™ ì²˜ë¦¬ì¤‘
            else if (anyInProgress && ticket.status === 'ì ‘ìˆ˜' && ticket.approved) {
                ticket.status = 'ì²˜ë¦¬ì¤‘';
                console.log(`ğŸ”„ ìë™ ìƒíƒœ ì „í™˜: ${ticket.ticketNumber} â†’ ì²˜ë¦¬ì¤‘ (í•˜ìœ„ì—…ë¬´ ì§„í–‰ ì‹œì‘)`);
            }
            // ê·¸ ì™¸ëŠ” ê¸°ì¡´ ìƒíƒœ ìœ ì§€ (ìš”ì²­, ì ‘ìˆ˜, ë³´ë¥˜ ë“±)
        }

        // Render Admin View
        function renderAdminView() {
            // Admin ê¶Œí•œë³„ í† ê¸€ í‘œì‹œ
            if (currentRole === 'admin') {
                const toggle = document.getElementById('admin-view-toggle');
                if (toggle) toggle.style.display = 'block';
            }
            
            renderKanban();
            updateAdminStats();
        }
        
        // ì¹¸ë°˜ í•„í„° ğŸ†•
        function filterKanban(type) {
            kanbanFilter = type;
            
            // ë²„íŠ¼ ìŠ¤íƒ€ì¼ ì—…ë°ì´íŠ¸
            document.getElementById('kanban-filter-all').className = 
                type === 'ì „ì²´' ? 'px-4 py-2 rounded-lg font-semibold transition bg-blue-600 text-white' 
                               : 'px-4 py-2 rounded-lg font-semibold transition bg-gray-200 text-gray-700 hover:bg-gray-300';
            document.getElementById('kanban-filter-itsm').className = 
                type === 'ITSM' ? 'px-4 py-2 rounded-lg font-semibold transition bg-blue-600 text-white' 
                                : 'px-4 py-2 rounded-lg font-semibold transition bg-gray-200 text-gray-700 hover:bg-gray-300';
            document.getElementById('kanban-filter-asset').className = 
                type === 'ìì‚°' ? 'px-4 py-2 rounded-lg font-semibold transition bg-blue-600 text-white' 
                                : 'px-4 py-2 rounded-lg font-semibold transition bg-gray-200 text-gray-700 hover:bg-gray-300';
            
            renderKanban();
        }
        
        // í‹°ì¼“ ëª©ë¡ í•„í„° ğŸ†•
        function filterTicketList(type) {
            ticketListFilter = type;
            
            // ë²„íŠ¼ ìŠ¤íƒ€ì¼ ì—…ë°ì´íŠ¸
            document.getElementById('list-filter-all').className = 
                type === 'ì „ì²´' ? 'px-3 py-1.5 rounded-lg text-sm font-semibold transition bg-blue-600 text-white' 
                                : 'px-3 py-1.5 rounded-lg text-sm font-semibold transition bg-gray-200 text-gray-700 hover:bg-gray-300';
            document.getElementById('list-filter-itsm').className = 
                type === 'ITSM' ? 'px-3 py-1.5 rounded-lg text-sm font-semibold transition bg-blue-600 text-white' 
                                : 'px-3 py-1.5 rounded-lg text-sm font-semibold transition bg-gray-200 text-gray-700 hover:bg-gray-300';
            document.getElementById('list-filter-asset').className = 
                type === 'ìì‚°' ? 'px-3 py-1.5 rounded-lg text-sm font-semibold transition bg-blue-600 text-white' 
                                : 'px-3 py-1.5 rounded-lg text-sm font-semibold transition bg-gray-200 text-gray-700 hover:bg-gray-300';
            
            renderAdminTickets();
        }
        
        // Admin ê¶Œí•œë³„ í‘œì‹œ í† ê¸€ ğŸ†•
        function toggleAdminViewScope(scope) {
            if (currentRole !== 'admin') return;
            
            adminViewScope = scope;
            renderKanban();
            renderAdminTickets();
        }
        
        // í‹°ì¼“ í•„í„°ë§ í—¬í¼ í•¨ìˆ˜ ğŸ†•
        function getFilteredTickets(allTickets) {
            let filtered = [...allTickets];
            
            // 1. í‹°ì¼“ ìœ í˜• í•„í„° (ì¹¸ë°˜/ëª©ë¡ ê³µí†µ)
            const activeFilter = kanbanFilter || ticketListFilter;
            if (activeFilter === 'ITSM') {
                filtered = filtered.filter(t => !t.ticketType || t.ticketType === 'ITSM');
            } else if (activeFilter === 'ìì‚°') {
                filtered = filtered.filter(t => t.ticketType === 'ìì‚°');
            }
            
            // 2. Admin ê¶Œí•œë³„ í•„í„° (ë³¸ì¸ê²ƒë§Œ/ì „ì²´)
            if (currentRole === 'admin' && adminViewScope === 'own') {
                filtered = filtered.filter(t => 
                    t.assignees && t.assignees.includes(currentUser.name)
                );
            }
            
            return filtered;
        }

        // í‹°ì¼“ ë¹„ìš© ê³„ì‚° (ë§ˆìŠ¤í„° ì „ìš©)
        function approveTicket(ticketId) {
            const ticket = tickets.find(t => t.id === ticketId);
            if (!ticket) return;
            
            if (currentRole !== 'master') {
                alert('â›” ë§ˆìŠ¤í„° ê¶Œí•œì´ í•„ìš”í•©ë‹ˆë‹¤.');
                return;
            }
            
            if (ticket.status !== 'ìŠ¹ì¸ëŒ€ê¸°') {
                alert('âš ï¸ ìŠ¹ì¸ëŒ€ê¸° ìƒíƒœê°€ ì•„ë‹™ë‹ˆë‹¤.');
                return;
            }
            
            if (confirm(`í‹°ì¼“ì„ ìŠ¹ì¸í•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n\n${ticket.ticketNumber}: ${ticket.title}\n${ticket.estimate ? `ê²¬ì : â‚©${ticket.estimate.totalCost.toLocaleString()}` : ''}`)) {
                ticket.status = 'ì ‘ìˆ˜';
                ticket.approved = true;
                ticket.approvedBy = currentUser.name;
                ticket.approvedAt = new Date().toLocaleString('ko-KR');
                
                ticket.comments.push({
                    id: `cmt${Date.now()}`,
                    author: currentUser.name,
                    content: `[ìŠ¹ì¸ ì™„ë£Œ] í‹°ì¼“ì´ ìŠ¹ì¸ë˜ì–´ ì ‘ìˆ˜ë˜ì—ˆìŠµë‹ˆë‹¤. ë‹´ë‹¹ìë¥¼ ë°°ì •í•˜ì„¸ìš”.`,
                    createdAt: new Date().toLocaleString('ko-KR')
                });
                
                closeModal('ticketDetailModal');
                renderAdminView();
                
                alert(`âœ… í‹°ì¼“ì´ ìŠ¹ì¸ë˜ì—ˆìŠµë‹ˆë‹¤!\n\nì ‘ìˆ˜ ì™„ë£Œ - ë‹´ë‹¹ìë¥¼ ë°°ì •í•˜ê³  ì—…ë¬´ë¥¼ ì‹œì‘í•˜ì„¸ìš”.`);
                console.log(`âœ… í‹°ì¼“ ìŠ¹ì¸ (ìŠ¹ì¸ëŒ€ê¸°â†’ì ‘ìˆ˜): ${ticket.ticketNumber} by ${currentUser.name}`);
            }
        }
        
        // Approve Ticket from ìš”ì²­ to ìŠ¹ì¸ëŒ€ê¸°
        function approveTicketToAccept(ticketId) {
            const ticket = tickets.find(t => t.id === ticketId);
            if (!ticket) return;
            
            if (currentRole !== 'master') {
                alert('â›” ë§ˆìŠ¤í„° ê¶Œí•œì´ í•„ìš”í•©ë‹ˆë‹¤.');
                return;
            }
            
            if (ticket.status !== 'ìš”ì²­') {
                alert('âš ï¸ ìš”ì²­ ìƒíƒœê°€ ì•„ë‹™ë‹ˆë‹¤.');
                return;
            }
            
            if (confirm(`í‹°ì¼“ì„ ìŠ¹ì¸í•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n\n${ticket.ticketNumber}: ${ticket.title}\n\nìŠ¹ì¸ í›„ ITíŒ€ì´ ê²¬ì ì„ ì‘ì„±í•©ë‹ˆë‹¤.`)) {
                ticket.status = 'ìŠ¹ì¸ëŒ€ê¸°';
                ticket.approved = true;
                ticket.approvedBy = currentUser.name;
                ticket.approvedAt = new Date().toLocaleString('ko-KR');
                
                ticket.comments.push({
                    id: `cmt${Date.now()}`,
                    author: currentUser.name,
                    content: `[ìŠ¹ì¸ ì™„ë£Œ] í‹°ì¼“ì´ ìŠ¹ì¸ë˜ì—ˆìŠµë‹ˆë‹¤. ITíŒ€ì´ ê²¬ì ì„ ì‘ì„±í•©ë‹ˆë‹¤.`,
                    createdAt: new Date().toLocaleString('ko-KR')
                });
                
                closeModal('ticketDetailModal');
                renderAdminView();
                
                alert(`âœ… í‹°ì¼“ì´ ìŠ¹ì¸ë˜ì—ˆìŠµë‹ˆë‹¤.\n\nITíŒ€ì´ ê²¬ì ì„ ì‘ì„±í•  ì˜ˆì •ì…ë‹ˆë‹¤.`);
                console.log(`âœ… í‹°ì¼“ ìŠ¹ì¸ (ìš”ì²­â†’ìŠ¹ì¸ëŒ€ê¸°): ${ticket.ticketNumber} by ${currentUser.name}`);
            }
        }
        
        // Approve Ticket from ì ‘ìˆ˜ to ì²˜ë¦¬ì¤‘
        function approveTicketFromAccept(ticketId) {
            const ticket = tickets.find(t => t.id === ticketId);
            if (!ticket) return;
            
            if (currentRole !== 'master') {
                alert('â›” ë§ˆìŠ¤í„° ê¶Œí•œì´ í•„ìš”í•©ë‹ˆë‹¤.');
                return;
            }
            
            if (ticket.status !== 'ì ‘ìˆ˜') {
                alert('âš ï¸ ì ‘ìˆ˜ ìƒíƒœê°€ ì•„ë‹™ë‹ˆë‹¤.');
                return;
            }
            
            const estimateInfo = ticket.estimate ? `\nê²¬ì : â‚©${ticket.estimate.totalCost.toLocaleString()}` : '';
            
            if (confirm(`í‹°ì¼“ì„ ìŠ¹ì¸í•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n\n${ticket.ticketNumber}: ${ticket.title}${estimateInfo}\n\nìŠ¹ì¸ í›„ ì—…ë¬´ë¥¼ ì‹œì‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.`)) {
                ticket.status = 'ì²˜ë¦¬ì¤‘';
                ticket.approved = true;
                ticket.approvedBy = currentUser.name;
                ticket.approvedAt = new Date().toLocaleString('ko-KR');
                
                ticket.comments.push({
                    id: `cmt${Date.now()}`,
                    author: currentUser.name,
                    content: `[ìŠ¹ì¸ ì™„ë£Œ] í‹°ì¼“ì´ ìŠ¹ì¸ë˜ì—ˆìŠµë‹ˆë‹¤. ì—…ë¬´ë¥¼ ì§„í–‰í•˜ì„¸ìš”.`,
                    createdAt: new Date().toLocaleString('ko-KR')
                });
                
                closeModal('ticketDetailModal');
                renderAdminView();
                
                alert(`âœ… í‹°ì¼“ì´ ìŠ¹ì¸ë˜ì—ˆìŠµë‹ˆë‹¤.\n\në‹´ë‹¹ìë¥¼ ë°°ì •í•˜ê³  ì—…ë¬´ë¥¼ ì‹œì‘í•˜ì„¸ìš”.`);
                console.log(`âœ… í‹°ì¼“ ìŠ¹ì¸ (ì ‘ìˆ˜â†’ì²˜ë¦¬ì¤‘): ${ticket.ticketNumber} by ${currentUser.name}`);
            }
        }

        // ğŸ’° í‹°ì¼“ ì´ ë¹„ìš© ê³„ì‚°
        function calculateTicketCost(ticket) {
            let totalCost = 0;
            let costBreakdown = [];
            
            ticket.subtasks.forEach(subtask => {
                if (subtask.actualHours && subtask.assignee) {
                    const staff = itStaff.find(s => s.name === subtask.assignee);
                    if (staff) {
                        const cost = subtask.actualHours * staff.hourlyRate;
                        totalCost += cost;
                        costBreakdown.push({
                            subtask: subtask.title,
                            assignee: subtask.assignee,
                            hours: subtask.actualHours,
                            rate: staff.hourlyRate,
                            cost: cost
                        });
                    }
                }
            });
            
            return { totalCost, costBreakdown };
        }
        
        // ğŸ“‹ ê²¬ì ì„œ ë°ì´í„° ê³„ì‚° (ë§¨ë°ì´/ë§¨ë¨¼ìŠ¤ ê¸°ì¤€)
        function calculateQuotation(ticket) {
            try {
                console.log('ğŸ’° ê²¬ì ì„œ ê³„ì‚° ì‹œì‘:', ticket.ticketNumber);
                
                const workingDaysPerMonth = 21; // ì›” ê·¼ë¬´ì¼ìˆ˜
                const workingHoursPerDay = 8; // 1ì¼ ê·¼ë¬´ì‹œê°„
                
                // ë“±ê¸‰ë³„ ê¸°ì¤€ë‹¨ê°€ (ì›” ê¸°ì¤€, ì†Œí”„íŠ¸ì›¨ì–´ ê¸°ìˆ ì í‰ê·  ì„ê¸ˆ)
                const monthlyRates = {
                    'ê³ ê¸‰': 7500000,  // 8ë…„ ì´ìƒ
                    'ì¤‘ê¸‰': 6300000,  // 3-7ë…„ì°¨
                    'ì´ˆê¸‰': 5500000   // 1-2ë…„ì°¨
                };
                
                // ë“±ê¸‰ë³„ ë°ì´í„° ì§‘ê³„
                const gradeData = {
                    'ê³ ê¸‰': { manMonths: 0, workDays: workingDaysPerMonth, rate: monthlyRates['ê³ ê¸‰'], amount: 0 },
                    'ì¤‘ê¸‰': { manMonths: 0, workDays: workingDaysPerMonth, rate: monthlyRates['ì¤‘ê¸‰'], amount: 0 },
                    'ì´ˆê¸‰': { manMonths: 0, workDays: workingDaysPerMonth, rate: monthlyRates['ì´ˆê¸‰'], amount: 0 }
                };
                
                console.log('ğŸ“Š í•˜ìœ„ì—…ë¬´ ì§‘ê³„ ì‹œì‘...');
                
                // í•˜ìœ„ì—…ë¬´ ê¸°ë°˜ íˆ¬ì… ì‹œê°„ ì§‘ê³„
                ticket.subtasks.forEach((subtask, index) => {
                    console.log(`  - í•˜ìœ„ì—…ë¬´ ${index + 1}:`, subtask.title, `(${subtask.actualHours}ì‹œê°„)`);
                    
                    if (subtask.actualHours && subtask.assignee) {
                        const staff = itStaff.find(s => s.name === subtask.assignee);
                        console.log(`    ë‹´ë‹¹ì:`, staff);
                        
                        if (staff) {
                            if (!staff.grade) {
                                console.warn(`    âš ï¸ ê²½ê³ : ${staff.name}ì˜ ë“±ê¸‰(grade)ì´ ì—†ìŠµë‹ˆë‹¤!`);
                                // ë“±ê¸‰ì´ ì—†ìœ¼ë©´ ê²½ë ¥ ê¸°ì¤€ìœ¼ë¡œ ìë™ í• ë‹¹
                                if (staff.yearsOfExperience >= 8) {
                                    staff.grade = 'ê³ ê¸‰';
                                } else if (staff.yearsOfExperience >= 3) {
                                    staff.grade = 'ì¤‘ê¸‰';
                                } else {
                                    staff.grade = 'ì´ˆê¸‰';
                                }
                                console.log(`    âœ… ìë™ í• ë‹¹: ${staff.grade}`);
                            }
                            
                            // ì‹œê°„ â†’ ë§¨ë¨¼ìŠ¤ ë³€í™˜ (1 ë§¨ë¨¼ìŠ¤ = 21ì¼ * 8ì‹œê°„ = 168ì‹œê°„)
                            const manMonths = subtask.actualHours / (workingDaysPerMonth * workingHoursPerDay);
                            gradeData[staff.grade].manMonths += manMonths;
                            console.log(`    âœ… ${staff.grade}: +${manMonths.toFixed(3)} M/M`);
                        } else {
                            console.warn(`    âš ï¸ ê²½ê³ : ë‹´ë‹¹ì ${subtask.assignee}ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤!`);
                        }
                    }
                });
                
                console.log('ğŸ“Š ë“±ê¸‰ë³„ ì§‘ê³„:', gradeData);
                
                // ê¸ˆì•¡ ê³„ì‚°
                let directLaborCost = 0;
                Object.keys(gradeData).forEach(grade => {
                    gradeData[grade].amount = Math.round(gradeData[grade].manMonths * gradeData[grade].rate);
                    directLaborCost += gradeData[grade].amount;
                });
                
                console.log('ğŸ’µ ì§ì ‘ì¸ê±´ë¹„:', directLaborCost.toLocaleString());
                
                // ì œê²½ë¹„ (ì§ì ‘ì¸ê±´ë¹„ì˜ 75%)
                const overheadRate = 0.75;
                const overhead = Math.round(directLaborCost * overheadRate);
                console.log('ğŸ’µ ì œê²½ë¹„(75%):', overhead.toLocaleString());
                
                // ê¸°ìˆ ë£Œ ((ì§ì ‘ì¸ê±´ë¹„ + ì œê²½ë¹„) * 10%)
                const techFeeRate = 0.10;
                const techFee = Math.round((directLaborCost + overhead) * techFeeRate);
                console.log('ğŸ’µ ê¸°ìˆ ë£Œ(10%):', techFee.toLocaleString());
                
                // ì†Œê³„
                const subtotal = directLaborCost + overhead + techFee;
                console.log('ğŸ’µ ì†Œê³„:', subtotal.toLocaleString());
                
                // VAT 10%
                const vat = Math.round(subtotal * 0.10);
                console.log('ğŸ’µ VAT(10%):', vat.toLocaleString());
                
                // í•©ê³„
                const total = subtotal + vat;
                console.log('ğŸ’µ í•©ê³„:', total.toLocaleString());
                
                // ì œì•ˆê°€ (ë°˜ì˜¬ë¦¼)
                const proposedAmount = Math.ceil(total / 100000) * 100000;
                console.log('ğŸ’µ ì œì•ˆê°€:', proposedAmount.toLocaleString());
                
                return {
                    gradeData,
                    directLaborCost,
                    overhead,
                    overheadRate,
                    techFee,
                    techFeeRate,
                    subtotal,
                    vat,
                    total,
                    proposedAmount,
                    workingDaysPerMonth
                };
            } catch (error) {
                console.error('âŒ ê²¬ì ì„œ ê³„ì‚° ì¤‘ ì˜¤ë¥˜:', error);
                throw error;
            }
        }
        
        // ğŸ“„ ê²¬ì ì„œ HTML ìƒì„±
        function generateQuotationHTML(ticket) {
            try {
                console.log('ğŸ“ ê²¬ì ì„œ ë°ì´í„° ê³„ì‚° ì‹œì‘...');
                const quotation = calculateQuotation(ticket);
                console.log('âœ… ê²¬ì ì„œ ê³„ì‚° ì™„ë£Œ:', quotation);
                
                const currentDate = getCurrentDate();
                
                // ì˜ˆìƒ ì‘ì—…ê¸°ê°„ ê³„ì‚° (í•˜ìœ„ì—…ë¬´ ì‹œì‘~ì¢…ë£Œì¼ ê¸°ì¤€)
                let workPeriod = 'ì°©ìˆ˜ í›„ í˜‘ì˜';
                if (ticket.subtasks.length > 0) {
                    const dates = ticket.subtasks
                        .filter(s => s.startDate && s.endDate)
                        .map(s => ({ start: new Date(s.startDate), end: new Date(s.endDate) }));
                    
                    if (dates.length > 0) {
                        const minStart = new Date(Math.min(...dates.map(d => d.start)));
                        const maxEnd = new Date(Math.max(...dates.map(d => d.end)));
                        const days = Math.ceil((maxEnd - minStart) / (1000 * 60 * 60 * 24));
                        workPeriod = `ì°©ìˆ˜ í›„ ${days}ì¼(í† ,ì¼,ê³µíœ´ì¼ ì œì™¸)`;
                    }
                }
                
                console.log('âœ… ì‘ì—…ê¸°ê°„ ê³„ì‚°:', workPeriod);
                
                return `
                <div id="quotation-print-area" class="p-8 bg-white" style="font-family: 'Noto Sans KR', sans-serif;">
                    <!-- í—¤ë” -->
                    <div class="text-center mb-8 pb-4 border-b-2 border-gray-800">
                        <h1 class="text-3xl font-bold text-gray-800 mb-2">IT ìš©ì—­ ê²¬ì ì„œ</h1>
                        <p class="text-sm text-gray-600">Quotation for IT Service</p>
                    </div>
                    
                    <!-- ê¸°ë³¸ ì •ë³´ -->
                    <div class="mb-6 grid grid-cols-2 gap-4">
                        <div>
                            <p class="text-sm text-gray-600 mb-1">ìˆ˜ì‹ </p>
                            <p class="font-semibold text-gray-800">${ticket.requester} (${ticket.department})</p>
                        </div>
                        <div class="text-right">
                            <p class="text-sm text-gray-600 mb-1">ê²¬ì ì¼ì</p>
                            <p class="font-semibold text-gray-800">${currentDate}</p>
                        </div>
                    </div>
                    
                    <!-- í”„ë¡œì íŠ¸ ì •ë³´ -->
                    <div class="mb-6 bg-gray-50 p-4 rounded-lg">
                        <p class="text-sm text-gray-600 mb-1">í”„ë¡œì íŠ¸ëª…</p>
                        <p class="font-semibold text-gray-800 text-lg">${ticket.title}</p>
                        <p class="text-sm text-gray-600 mt-2">${ticket.description || ''}</p>
                    </div>
                    
                    <!-- ë¹„ìš© ì‚°ì¶œ í…Œì´ë¸” -->
                    <div class="mb-6">
                        <table class="w-full border-collapse" style="border: 2px solid #000;">
                            <thead>
                                <tr style="background-color: #000; color: #fff;">
                                    <th class="border border-white px-4 py-3 text-center font-bold">ìš©ì—­êµ¬ë¶„</th>
                                    <th class="border border-white px-4 py-3 text-center font-bold">íˆ¬ì…M/M</th>
                                    <th class="border border-white px-4 py-3 text-center font-bold">ê·¼ë¬´ì¼ìˆ˜</th>
                                    <th class="border border-white px-4 py-3 text-center font-bold">ê¸°ì¤€ë‹¨ê°€</th>
                                    <th class="border border-white px-4 py-3 text-center font-bold">ê¸ˆì•¡</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${Object.keys(quotation.gradeData).map(grade => `
                                    <tr style="border: 1px solid #000;">
                                        <td class="border border-gray-300 px-4 py-3 text-center font-semibold">${grade}</td>
                                        <td class="border border-gray-300 px-4 py-3 text-center">${quotation.gradeData[grade].manMonths.toFixed(3)}</td>
                                        <td class="border border-gray-300 px-4 py-3 text-center">${quotation.gradeData[grade].workDays}</td>
                                        <td class="border border-gray-300 px-4 py-3 text-right">${quotation.gradeData[grade].rate.toLocaleString()}</td>
                                        <td class="border border-gray-300 px-4 py-3 text-right font-semibold">${quotation.gradeData[grade].amount.toLocaleString()}</td>
                                    </tr>
                                `).join('')}
                                <tr style="border: 1px solid #000; background-color: #f3f4f6;">
                                    <td colspan="3" class="border border-gray-300 px-4 py-3 text-center font-bold">í•©ê³„</td>
                                    <td class="border border-gray-300 px-4 py-3 text-center font-semibold">ìš”ìœ¨</td>
                                    <td class="border border-gray-300 px-4 py-3 text-right font-bold">${quotation.directLaborCost.toLocaleString()}</td>
                                </tr>
                                <tr style="border: 1px solid #000;">
                                    <td class="border border-gray-300 px-4 py-3 text-center font-semibold">ì œê²½ë¹„</td>
                                    <td colspan="2" class="border border-gray-300 px-4 py-3 text-center">ì§ì ‘ì¸ê±´ë¹„*ìš”ìœ¨</td>
                                    <td class="border border-gray-300 px-4 py-3 text-center font-semibold">${(quotation.overheadRate * 100).toFixed(0)}%</td>
                                    <td class="border border-gray-300 px-4 py-3 text-right font-semibold">${quotation.overhead.toLocaleString()}</td>
                                </tr>
                                <tr style="border: 1px solid #000;">
                                    <td class="border border-gray-300 px-4 py-3 text-center font-semibold">ê¸°ìˆ ë£Œ</td>
                                    <td colspan="2" class="border border-gray-300 px-4 py-3 text-center">(ì§ì ‘ì¸ê±´ë¹„+ì œê²½ë¹„)*ìš”ìœ¨</td>
                                    <td class="border border-gray-300 px-4 py-3 text-center font-semibold">${(quotation.techFeeRate * 100).toFixed(0)}%</td>
                                    <td class="border border-gray-300 px-4 py-3 text-right font-semibold">${quotation.techFee.toLocaleString()}</td>
                                </tr>
                                <tr style="border: 1px solid #000; background-color: #dbeafe;">
                                    <td colspan="4" class="border border-gray-300 px-4 py-3 text-center font-bold">ì†Œê³„</td>
                                    <td class="border border-gray-300 px-4 py-3 text-right font-bold text-lg">${quotation.subtotal.toLocaleString()}</td>
                                </tr>
                                <tr style="border: 1px solid #000; background-color: #3b82f6; color: #fff;">
                                    <td colspan="4" class="border border-white px-4 py-3 text-center font-bold">í•©ê³„</td>
                                    <td class="border border-white px-4 py-3 text-right font-bold text-lg">${quotation.total.toLocaleString()}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    
                    <!-- ì œì•ˆê°€ -->
                    <div class="mb-6 bg-black text-white p-4 rounded-lg text-center">
                        <p class="text-xl font-bold">ì œì•ˆê°€</p>
                        <p class="text-3xl font-bold mt-2">â‚© ${quotation.proposedAmount.toLocaleString()}</p>
                    </div>
                    
                    <!-- ì„¸ë¶€ ì¡°ê±´ -->
                    <div class="mb-6">
                        <table class="w-full border-collapse" style="border: 1px solid #000;">
                            <tr style="border: 1px solid #000;">
                                <td class="border border-gray-300 px-4 py-3 bg-gray-100 font-semibold" style="width: 20%;">ì‘ì—…ê³µìˆ˜</td>
                                <td class="border border-gray-300 px-4 py-3">${workPeriod}</td>
                            </tr>
                            <tr style="border: 1px solid #000;">
                                <td class="border border-gray-300 px-4 py-3 bg-gray-100 font-semibold">ì§€ë¶ˆì¡°ê±´</td>
                                <td class="border border-gray-300 px-4 py-3">ë°œì£¼ì„œ ìˆ˜ë ¹ ì¦‰ì‹œ ì„ ê¸ˆ 50% ì„¸ê¸ˆê³„ì‚°ì„œ ë°œí–‰ / ê²€ìˆ˜ ì™„ë£Œ í›„ ì”ê¸ˆ 50% ì„¸ê¸ˆê³„ì‚°ì„œ ë°œí–‰ (ì„¸ê¸ˆê³„ì‚°ì„œ ë°œí–‰ì¼ë¡œë¶€í„° 30ì¼ ì´ë‚´ ì§€ê¸‰)</td>
                            </tr>
                            <tr style="border: 1px solid #000;">
                                <td class="border border-gray-300 px-4 py-3 bg-gray-100 font-semibold">ìš©ì—­ë‹¨ê°€ê¸°ì¤€</td>
                                <td class="border border-gray-300 px-4 py-3">ë‹¹í•´ë…„ë„ ì†Œí”„íŠ¸ì›¨ì–´ ê¸°ìˆ ì í‰ê·  ì„ê¸ˆ</td>
                            </tr>
                            <tr style="border: 1px solid #000;">
                                <td class="border border-gray-300 px-4 py-3 bg-gray-100 font-semibold">ê¸°íƒ€ì‚¬í•­</td>
                                <td class="border border-gray-300 px-4 py-3">ì¶”ê°€ê°œë°œ ì‘ì—…ì€ ë¹„ìƒì£¼ë¡œ ì§„í–‰ë˜ë©°, ìƒê¸° ê¸ˆì•¡ì€ ë‹¤ìŒ ìœ ì§€ë³´ìˆ˜ ê³„ì•½ ì‹œ ì‚°ì¶œë‚´ì—­ì— í¬í•¨ ë©ë‹ˆë‹¤.</td>
                            </tr>
                        </table>
                    </div>
                    
                    <!-- íšŒì‚¬ ì •ë³´ -->
                    <div class="text-right text-sm text-gray-600 pt-4 border-t border-gray-300">
                        <p class="font-semibold text-gray-800">YIDO ITì‚¬ì—…íŒ€</p>
                        <p>Tel: 02-xxxx-xxxx</p>
                        <p>Email: it@yido.com</p>
                    </div>
                </div>
            `;
            } catch (error) {
                console.error('âŒ ê²¬ì ì„œ HTML ìƒì„± ì¤‘ ì˜¤ë¥˜:', error);
                throw error; // ìƒìœ„ í•¨ìˆ˜ë¡œ ì—ëŸ¬ ì „íŒŒ
            }
        }
        
        // ê²¬ì ì„œ ë³´ê¸° ë²„íŠ¼ í´ë¦­
        function openQuotationModal(ticketId) {
            console.log('ğŸ” ê²¬ì ì„œ ëª¨ë‹¬ ì—´ê¸° ì‹œë„:', ticketId);
            
            try {
                const ticket = tickets.find(t => t.id === ticketId);
                if (!ticket) {
                    console.error('âŒ í‹°ì¼“ì„ ì°¾ì„ ìˆ˜ ì—†ìŒ:', ticketId);
                    alert('â›” í‹°ì¼“ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                    return;
                }
                
                console.log('âœ… í‹°ì¼“ ì°¾ìŒ:', ticket.ticketNumber);
                
                // í•˜ìœ„ì—…ë¬´ê°€ ì—†ìœ¼ë©´ ê²¬ì ì„œ ìƒì„± ë¶ˆê°€
                if (!ticket.subtasks || ticket.subtasks.length === 0) {
                    console.warn('âš ï¸ í•˜ìœ„ì—…ë¬´ ì—†ìŒ');
                    alert('â›” í•˜ìœ„ì—…ë¬´ê°€ ì—†ì–´ ê²¬ì ì„œë¥¼ ìƒì„±í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                    return;
                }
                
                console.log('âœ… í•˜ìœ„ì—…ë¬´ ê°œìˆ˜:', ticket.subtasks.length);
                
                // ê²¬ì ì„œ HTML ìƒì„±
                console.log('ğŸ“ ê²¬ì ì„œ HTML ìƒì„± ì¤‘...');
                const quotationHTML = generateQuotationHTML(ticket);
                console.log('âœ… ê²¬ì ì„œ HTML ìƒì„± ì™„ë£Œ');
                
                const contentElement = document.getElementById('quotation-content');
                if (!contentElement) {
                    console.error('âŒ quotation-content ì—˜ë¦¬ë¨¼íŠ¸ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ');
                    alert('â›” ì‹œìŠ¤í…œ ì˜¤ë¥˜: ê²¬ì ì„œ ì˜ì—­ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                    return;
                }
                
                contentElement.innerHTML = quotationHTML;
                console.log('âœ… ê²¬ì ì„œ HTML ì‚½ì… ì™„ë£Œ');
                
                // ëª¨ë‹¬ ì—´ê¸°
                console.log('ğŸš€ ëª¨ë‹¬ ì—´ê¸°...');
                openModal('quotationModal');
                console.log('âœ… ê²¬ì ì„œ ëª¨ë‹¬ ì—´ê¸° ì™„ë£Œ!');
                
            } catch (error) {
                console.error('âŒ ê²¬ì ì„œ ìƒì„± ì¤‘ ì˜¤ë¥˜:', error);
                alert(`â›” ê²¬ì ì„œ ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.\n\n${error.message}\n\në¸Œë¼ìš°ì € ì½˜ì†”(F12)ì—ì„œ ìì„¸í•œ ë‚´ìš©ì„ í™•ì¸í•˜ì„¸ìš”.`);
            }
        }
        
        // ê²¬ì ì„œ ì¸ì‡„
        function printQuotation() {
            const printContent = document.getElementById('quotation-print-area').innerHTML;
            const originalContent = document.body.innerHTML;
            
            document.body.innerHTML = printContent;
            window.print();
            document.body.innerHTML = originalContent;
            
            // í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨í•˜ì—¬ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë³µêµ¬
            location.reload();
        }
        
        // ê²¬ì ì„œ ë‹¤ìš´ë¡œë“œ (HTML â†’ PDFëŠ” ë¸Œë¼ìš°ì € ì¸ì‡„ ê¸°ëŠ¥ í™œìš©)
        function downloadQuotation() {
            alert('ğŸ’¡ ë¸Œë¼ìš°ì €ì˜ ì¸ì‡„ ê¸°ëŠ¥ì„ ì‚¬ìš©í•´ PDFë¡œ ì €ì¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n[ì¸ì‡„] ë²„íŠ¼ â†’ [ëŒ€ìƒ: PDFë¡œ ì €ì¥] â†’ [ì €ì¥]');
            printQuotation();
        }
        
        // ğŸ“Š ë‹´ë‹¹ìë³„ ì—…ë¬´ëŸ‰ ë° ë¹„ìš© ê³„ì‚°
        function calculateStaffWorkload() {
            const workload = {};
            
            itStaff.forEach(staff => {
                workload[staff.name] = {
                    name: staff.name,
                    role: staff.role,
                    yearsOfExperience: staff.yearsOfExperience,
                    hourlyRate: staff.hourlyRate,
                    activeTickets: 0,
                    totalHours: 0,
                    totalCost: 0,
                    completedTasks: 0,
                    inProgressTasks: 0
                };
            });
            
            tickets.forEach(ticket => {
                ticket.subtasks.forEach(subtask => {
                    if (subtask.assignee && workload[subtask.assignee]) {
                        if (ticket.status !== 'ì™„ë£Œ' && ticket.status !== 'ë°˜ë ¤') {
                            workload[subtask.assignee].activeTickets++;
                        }
                        
                        if (subtask.actualHours) {
                            workload[subtask.assignee].totalHours += subtask.actualHours;
                            workload[subtask.assignee].totalCost += 
                                subtask.actualHours * workload[subtask.assignee].hourlyRate;
                        }
                        
                        if (subtask.status === 'ì™„ë£Œ') {
                            workload[subtask.assignee].completedTasks++;
                        } else if (subtask.status === 'ì§„í–‰ì¤‘') {
                            workload[subtask.assignee].inProgressTasks++;
                        }
                    }
                });
            });
            
            return Object.values(workload);
        }

        // ğŸ¯ í•˜ìœ„ì—…ë¬´ ìƒíƒœ ì—…ë°ì´íŠ¸
        function updateSubtaskStatus(ticketId, subtaskId, newStatus) {
            const ticket = tickets.find(t => t.id === ticketId);
            if (!ticket) return;
            
            const subtask = ticket.subtasks.find(st => st.id === subtaskId);
            if (!subtask) return;
            
            subtask.status = newStatus;
            
            // í‹°ì¼“ ìƒíƒœ ìë™ ì—…ë°ì´íŠ¸
            updateTicketStatusFromSubtasks(ticketId);
            
            // í™”ë©´ ìƒˆë¡œê³ ì¹¨
            openTicketDetail(ticketId);
            renderAdminView();
            renderUserView();
            
            console.log(`âœ… í•˜ìœ„ì—…ë¬´ ìƒíƒœ ë³€ê²½: ${subtask.title} â†’ ${newStatus}`);
        }

        // ğŸ“ ì½”ë©˜íŠ¸ ì¶”ê°€
        function addComment(ticketId) {
            const ticket = tickets.find(t => t.id === ticketId);
            if (!ticket) return;
            
            const commentInput = document.getElementById(`comment-input-${ticketId}`);
            const content = commentInput.value.trim();
            
            if (!content) {
                alert('ì½”ë©˜íŠ¸ ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            // ì½”ë©˜íŠ¸ ë°°ì—´ ì´ˆê¸°í™” (ì—†ìœ¼ë©´)
            if (!ticket.comments) {
                ticket.comments = [];
            }
            
            // ìƒˆ ì½”ë©˜íŠ¸ ì¶”ê°€
            const newComment = {
                id: 'cmt' + Date.now(),
                author: currentUser.name,
                content: content,
                createdAt: new Date().toLocaleString('ko-KR', { 
                    year: 'numeric', 
                    month: '2-digit', 
                    day: '2-digit', 
                    hour: '2-digit', 
                    minute: '2-digit' 
                })
            };
            
            ticket.comments.push(newComment);
            commentInput.value = '';
            
            // í™”ë©´ ìƒˆë¡œê³ ì¹¨
            openTicketDetail(ticketId);
            
            console.log(`âœ… ì½”ë©˜íŠ¸ ì¶”ê°€: ${newComment.content}`);
        }

        // ğŸ—‘ï¸ ì½”ë©˜íŠ¸ ì‚­ì œ
        function deleteComment(ticketId, commentId) {
            if (!confirm('ì´ ì½”ë©˜íŠ¸ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;
            
            const ticket = tickets.find(t => t.id === ticketId);
            if (!ticket || !ticket.comments) return;
            
            ticket.comments = ticket.comments.filter(c => c.id !== commentId);
            
            // í™”ë©´ ìƒˆë¡œê³ ì¹¨
            openTicketDetail(ticketId);
            
            console.log(`âœ… ì½”ë©˜íŠ¸ ì‚­ì œ ì™„ë£Œ`);
        }

        // ==================== í”„ë¡œì íŠ¸ ê´€ë¦¬ í•¨ìˆ˜ ====================

        // í”„ë¡œì íŠ¸ ëª©ë¡ ë Œë”ë§
        // ğŸ“Š ì—…ë¬´ëŸ‰ ë¶„ì„ ë Œë”ë§
        function renderWorkload() {
            const workloadData = calculateStaffWorkload();
            const container = document.getElementById('workload-grid');
            
            // ì´ ë¹„ìš© í•©ê³„
            const totalCost = workloadData.reduce((sum, staff) => sum + staff.totalCost, 0);
            const totalHours = workloadData.reduce((sum, staff) => sum + staff.totalHours, 0);
            
            container.innerHTML = `
                <!-- ì „ì²´ ìš”ì•½ -->
                <div class="bg-gradient-to-r from-purple-500 to-blue-500 text-white rounded-xl p-6 mb-4">
                    <div class="grid grid-cols-3 gap-4">
                        <div>
                            <div class="text-sm opacity-90">ì´ íˆ¬ì… ì‹œê°„</div>
                            <div class="text-3xl font-bold">${totalHours.toLocaleString()}h</div>
                        </div>
                        <div>
                            <div class="text-sm opacity-90">ì´ ì˜ˆìƒ ë¹„ìš©</div>
                            <div class="text-3xl font-bold">â‚©${totalCost.toLocaleString()}</div>
                        </div>
                        <div>
                            <div class="text-sm opacity-90">í‰ê·  ì‹œê°„ë‹¹ ë¹„ìš©</div>
                            <div class="text-3xl font-bold">â‚©${totalHours > 0 ? Math.round(totalCost / totalHours).toLocaleString() : 0}</div>
                        </div>
                    </div>
                </div>
                
                <!-- ì‹¤ë¬´ìë³„ ì¹´ë“œ -->
                ${workloadData.map(staff => {
                    const utilizationRate = staff.totalHours > 0 ? Math.min(100, (staff.totalHours / 160 * 100)) : 0; // ì›” 160ì‹œê°„ ê¸°ì¤€
                    let utilizationColor = 'bg-green-100 text-green-700';
                    if (utilizationRate > 80) utilizationColor = 'bg-red-100 text-red-700';
                    else if (utilizationRate > 60) utilizationColor = 'bg-yellow-100 text-yellow-700';
                    
                    return `
                        <div class="bg-white rounded-xl shadow-md hover:shadow-xl transition-all border-2 border-gray-100 hover:border-blue-300 p-6">
                            <div class="flex items-start justify-between mb-4">
                                <div class="flex items-center">
                                    <div class="w-16 h-16 rounded-full bg-gradient-to-br from-blue-400 to-purple-500 flex items-center justify-center text-white text-2xl font-bold mr-4">
                                        ${staff.name.charAt(0)}
                                    </div>
                                    <div>
                                        <h3 class="text-xl font-bold text-gray-800">${staff.name}</h3>
                                        <p class="text-sm text-gray-500">${staff.role}</p>
                                        <p class="text-xs text-purple-600 font-semibold mt-1">${staff.yearsOfExperience}ë…„ì°¨ Â· â‚©${staff.hourlyRate.toLocaleString()}/h</p>
                                    </div>
                                </div>
                                <div class="text-right">
                                    <div class="text-2xl font-bold text-blue-600">â‚©${staff.totalCost.toLocaleString()}</div>
                                    <div class="text-sm text-gray-500">${staff.totalHours}ì‹œê°„</div>
                                </div>
                            </div>
                            
                            <div class="grid grid-cols-3 gap-3 mb-4">
                                <div class="bg-blue-50 rounded-lg p-3 text-center">
                                    <div class="text-2xl font-bold text-blue-600">${staff.activeTickets}</div>
                                    <div class="text-xs text-gray-600">ì§„í–‰ ì¤‘</div>
                                </div>
                                <div class="bg-green-50 rounded-lg p-3 text-center">
                                    <div class="text-2xl font-bold text-green-600">${staff.completedTasks}</div>
                                    <div class="text-xs text-gray-600">ì™„ë£Œ</div>
                                </div>
                                <div class="bg-yellow-50 rounded-lg p-3 text-center">
                                    <div class="text-2xl font-bold text-yellow-600">${staff.inProgressTasks}</div>
                                    <div class="text-xs text-gray-600">ì§„í–‰ ì¤‘</div>
                                </div>
                            </div>
                            
                            <div class="space-y-2">
                                <div class="flex justify-between items-center text-sm">
                                    <span class="text-gray-600">ì—…ë¬´ ì§‘ì¤‘ë„</span>
                                    <span class="${utilizationColor} px-3 py-1 rounded-full text-xs font-bold">
                                        ${utilizationRate.toFixed(1)}%
                                    </span>
                                </div>
                                <div class="w-full bg-gray-200 rounded-full h-2">
                                    <div class="bg-gradient-to-r from-blue-500 to-purple-500 h-2 rounded-full transition-all" style="width: ${utilizationRate}%"></div>
                                </div>
                            </div>
                        </div>
                    `;
                }).join('')}
            `;
        }

        function renderProjects() {
            const container = document.getElementById('projects-grid');
            
            if (projects.length === 0) {
                container.innerHTML = `
                    <div class="col-span-3 text-center py-16">
                        <i class="fas fa-folder-open text-gray-300 text-6xl mb-4"></i>
                        <p class="text-gray-500">ë“±ë¡ëœ í”„ë¡œì íŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤.</p>
                        <button onclick="openNewProjectModal()" class="mt-4 px-6 py-3 bg-purple-600 text-white rounded-lg hover:bg-purple-700">
                            ì²« í”„ë¡œì íŠ¸ ìƒì„±í•˜ê¸°
                        </button>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = projects.map(project => {
                const linkedTicketsCount = project.linkedTickets.length;
                
                // í‹°ì¼“ ìƒíƒœë³„ ê°œìˆ˜ ê³„ì‚°
                const ticketStatuses = project.linkedTickets.map(ticketId => {
                    const ticket = tickets.find(t => t.id === ticketId);
                    return ticket ? ticket.status : null;
                }).filter(s => s !== null);
                
                const completedTickets = ticketStatuses.filter(s => s === 'ì™„ë£Œ').length;
                const inProgressTickets = ticketStatuses.filter(s => s === 'ì²˜ë¦¬ì¤‘').length;
                const pendingTickets = ticketStatuses.filter(s => s === 'ì ‘ìˆ˜' || s === 'ìš”ì²­').length;
                
                const progress = linkedTicketsCount > 0 ? Math.round((completedTickets / linkedTicketsCount) * 100) : 0;
                
                // í”„ë¡œì íŠ¸ ìƒíƒœ ìë™ ê³„ì‚°
                let autoStatus = 'ì¤€ë¹„ì¤‘';
                if (linkedTicketsCount === 0) {
                    autoStatus = 'ì¤€ë¹„ì¤‘';
                } else if (completedTickets === linkedTicketsCount) {
                    autoStatus = 'ì™„ë£Œ';
                } else if (inProgressTickets > 0 || completedTickets > 0) {
                    autoStatus = 'ì§„í–‰ì¤‘';
                } else if (pendingTickets > 0) {
                    autoStatus = 'ì¤€ë¹„ì¤‘';
                }
                
                // í”„ë¡œì íŠ¸ ìƒíƒœ ìë™ ì—…ë°ì´íŠ¸
                project.status = autoStatus;
                
                let statusColor = 'bg-gray-100 text-gray-700';
                if (project.status === 'ì§„í–‰ì¤‘') statusColor = 'bg-blue-100 text-blue-700';
                else if (project.status === 'ì™„ë£Œ') statusColor = 'bg-green-100 text-green-700';
                else if (project.status === 'ë³´ë¥˜') statusColor = 'bg-yellow-100 text-yellow-700';
                
                return `
                    <div class="bg-white rounded-xl shadow-md hover:shadow-xl transition-all duration-300 overflow-hidden cursor-pointer border-2 border-transparent hover:border-purple-300"
                         onclick="openProjectDetail(${project.id})">
                        <div class="p-6">
                            <div class="flex items-start justify-between mb-3">
                                <div class="flex-1">
                                    <span class="text-xs font-semibold text-purple-600">${project.projectNumber}</span>
                                    <h3 class="text-xl font-bold text-gray-800 mt-1 mb-2">${project.title}</h3>
                                </div>
                                <span class="px-3 py-1 ${statusColor} rounded-full text-xs font-semibold">${project.status}</span>
                            </div>
                            
                            <p class="text-sm text-gray-600 mb-4 line-clamp-2">${project.description}</p>
                            
                            <div class="space-y-2 mb-4">
                                <div class="flex items-center text-sm text-gray-500">
                                    <i class="fas fa-calendar-alt w-5"></i>
                                    <span>${project.startDate} ~ ${project.endDate}</span>
                                </div>
                                <div class="flex items-center text-sm text-gray-500">
                                    <i class="fas fa-ticket-alt w-5"></i>
                                    <span>ì—°ê²°ëœ í‹°ì¼“: ${linkedTicketsCount}ê°œ</span>
                                </div>
                            </div>
                            
                            <div class="space-y-2">
                                <div class="flex justify-between text-sm">
                                    <span class="text-gray-600">ì§„í–‰ë¥ </span>
                                    <span class="font-semibold text-purple-600">${progress}%</span>
                                </div>
                                <div class="w-full bg-gray-200 rounded-full h-2">
                                    <div class="bg-gradient-to-r from-purple-600 to-pink-600 h-2 rounded-full transition-all duration-500" 
                                         style="width: ${progress}%"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // ìƒˆ í”„ë¡œì íŠ¸ ëª¨ë‹¬ ì—´ê¸°
        function openNewProjectModal() {
            openModal('newProjectModal');
            document.getElementById('newProjectForm').reset();
            document.getElementById('project-links-container').innerHTML = `
                <div class="flex gap-2">
                    <input type="text" placeholder="ë§í¬ ì œëª©" class="flex-1 border border-gray-300 rounded-lg px-4 py-2 text-sm">
                    <input type="url" placeholder="URL" class="flex-1 border border-gray-300 rounded-lg px-4 py-2 text-sm">
                    <button type="button" onclick="removeProjectLink(this)" class="px-3 py-2 bg-red-100 text-red-600 rounded-lg hover:bg-red-200 text-sm">
                        <i class="fas fa-trash"></i>
                    </button>
                </div>
            `;
        }

        // í”„ë¡œì íŠ¸ ë§í¬ ì¶”ê°€
        function addProjectLink() {
            const container = document.getElementById('project-links-container');
            const linkDiv = document.createElement('div');
            linkDiv.className = 'flex gap-2';
            linkDiv.innerHTML = `
                <input type="text" placeholder="ë§í¬ ì œëª©" class="flex-1 border border-gray-300 rounded-lg px-4 py-2 text-sm">
                <input type="url" placeholder="URL" class="flex-1 border border-gray-300 rounded-lg px-4 py-2 text-sm">
                <button type="button" onclick="removeProjectLink(this)" class="px-3 py-2 bg-red-100 text-red-600 rounded-lg hover:bg-red-200 text-sm">
                    <i class="fas fa-trash"></i>
                </button>
            `;
            container.appendChild(linkDiv);
        }

        // í”„ë¡œì íŠ¸ ë§í¬ ì œê±°
        function removeProjectLink(button) {
            const container = document.getElementById('project-links-container');
            if (container.children.length > 1) {
                button.closest('.flex').remove();
            }
        }

        // í”„ë¡œì íŠ¸ ìƒì„±
        function submitProject(event) {
            event.preventDefault();
            
            const form = event.target;
            const formData = new FormData(form);
            
            // ë§í¬ ìˆ˜ì§‘
            const linkInputs = document.getElementById('project-links-container').querySelectorAll('.flex');
            const links = [];
            linkInputs.forEach((linkDiv, index) => {
                const inputs = linkDiv.querySelectorAll('input');
                const title = inputs[0].value.trim();
                const url = inputs[1].value.trim();
                if (title && url) {
                    links.push({
                        id: `link${Date.now()}-${index}`,
                        title,
                        url
                    });
                }
            });
            
            const newProject = {
                id: projectIdCounter++,
                projectNumber: `PRJ-2024-${String(projectIdCounter - 1).padStart(3, '0')}`,
                title: formData.get('title'),
                description: formData.get('description'),
                startDate: formData.get('startDate'),
                endDate: formData.get('endDate'),
                status: 'ì¤€ë¹„ì¤‘',
                links: links,
                linkedTickets: [],
                createdBy: currentUser.name,
                createdAt: new Date().toISOString().split('T')[0]
            };
            
            projects.push(newProject);
            closeModal('newProjectModal');
            renderProjects();
            
            console.log('âœ… í”„ë¡œì íŠ¸ ìƒì„± ì™„ë£Œ:', newProject);
        }

        // í”„ë¡œì íŠ¸ ìƒì„¸ ë³´ê¸°
        function openProjectDetail(projectId) {
            const project = projects.find(p => p.id === projectId);
            if (!project) return;
            
            document.getElementById('detail-project-title').textContent = project.title;
            document.getElementById('detail-project-number').textContent = project.projectNumber;
            
            const linkedTicketsCount = project.linkedTickets.length;
            const completedTickets = project.linkedTickets.filter(ticketId => {
                const ticket = tickets.find(t => t.id === ticketId);
                return ticket && ticket.status === 'ì™„ë£Œ';
            }).length;
            const progress = linkedTicketsCount > 0 ? Math.round((completedTickets / linkedTicketsCount) * 100) : 0;
            
            let statusColor = 'bg-gray-100 text-gray-700';
            if (project.status === 'ì§„í–‰ì¤‘') statusColor = 'bg-blue-100 text-blue-700';
            else if (project.status === 'ì™„ë£Œ') statusColor = 'bg-green-100 text-green-700';
            else if (project.status === 'ë³´ë¥˜') statusColor = 'bg-yellow-100 text-yellow-700';
            
            const content = document.getElementById('project-detail-content');
            content.innerHTML = `
                <div class="space-y-6">
                    <!-- í”„ë¡œì íŠ¸ ì •ë³´ -->
                    <div class="bg-gradient-to-r from-purple-50 to-pink-50 rounded-xl p-6">
                        <div class="grid grid-cols-2 gap-6">
                            <div>
                                <label class="text-sm font-semibold text-gray-600">ìƒíƒœ</label>
                                <div class="mt-1">
                                    <span class="px-4 py-2 ${statusColor} rounded-lg text-sm font-semibold inline-block">${project.status}</span>
                                </div>
                            </div>
                            <div>
                                <label class="text-sm font-semibold text-gray-600">ê¸°ê°„</label>
                                <p class="text-gray-800 mt-1">${project.startDate} ~ ${project.endDate}</p>
                            </div>
                            <div class="col-span-2">
                                <label class="text-sm font-semibold text-gray-600">ì„¤ëª…</label>
                                <p class="text-gray-800 mt-1">${project.description}</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- ì§„í–‰ë¥  -->
                    <div>
                        <div class="flex justify-between items-center mb-2">
                            <h4 class="font-semibold text-gray-800">í”„ë¡œì íŠ¸ ì§„í–‰ë¥ </h4>
                            <span class="text-2xl font-bold text-purple-600">${progress}%</span>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-4">
                            <div class="bg-gradient-to-r from-purple-600 to-pink-600 h-4 rounded-full transition-all duration-500" 
                                 style="width: ${progress}%"></div>
                        </div>
                        <p class="text-sm text-gray-500 mt-2">${completedTickets} / ${linkedTicketsCount} í‹°ì¼“ ì™„ë£Œ</p>
                    </div>
                    
                    <!-- ë§í¬ -->
                    ${project.links.length > 0 ? `
                        <div>
                            <h4 class="font-semibold text-gray-800 mb-3">ê´€ë ¨ ë§í¬</h4>
                            <div class="space-y-2">
                                ${project.links.map(link => `
                                    <a href="${link.url}" target="_blank" class="flex items-center p-3 bg-blue-50 rounded-lg hover:bg-blue-100 transition">
                                        <i class="fas fa-external-link-alt text-blue-600 mr-3"></i>
                                        <span class="text-blue-700 font-medium">${link.title}</span>
                                    </a>
                                `).join('')}
                            </div>
                        </div>
                    ` : ''}
                    
                    <!-- ì—°ê²°ëœ í‹°ì¼“ -->
                    <div>
                        <div class="flex justify-between items-center mb-4">
                            <h4 class="font-semibold text-gray-800">ì—°ê²°ëœ í‹°ì¼“ (${linkedTicketsCount})</h4>
                            <button onclick="openLinkTicketToProject(${project.id})" class="px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 text-sm">
                                <i class="fas fa-link mr-2"></i>í‹°ì¼“ ì—°ê²°
                            </button>
                        </div>
                        
                        ${linkedTicketsCount > 0 ? `
                            <div class="space-y-3">
                                ${project.linkedTickets.map(ticketId => {
                                    const ticket = tickets.find(t => t.id === ticketId);
                                    if (!ticket) return '';
                                    
                                    let statusColor = 'bg-gray-100 text-gray-700';
                                    if (ticket.status === 'ì²˜ë¦¬ì¤‘') statusColor = 'bg-blue-100 text-blue-700';
                                    else if (ticket.status === 'ì™„ë£Œ') statusColor = 'bg-green-100 text-green-700';
                                    else if (ticket.status === 'ìš”ì²­') statusColor = 'bg-yellow-100 text-yellow-700';
                                    
                                    return `
                                        <div class="flex items-center justify-between p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition">
                                            <div class="flex-1 cursor-pointer" onclick="openTicketDetail(${ticket.id})">
                                                <div class="flex items-center gap-3 mb-2">
                                                    <span class="text-sm font-mono text-purple-600">${ticket.ticketNumber}</span>
                                                    <span class="px-3 py-1 ${statusColor} rounded-full text-xs font-semibold">${ticket.status}</span>
                                                    <span class="px-3 py-1 bg-gray-200 text-gray-700 rounded-full text-xs">${ticket.category}</span>
                                                </div>
                                                <h5 class="font-semibold text-gray-800">${ticket.title}</h5>
                                                <p class="text-sm text-gray-500 mt-1">ë‹´ë‹¹: ${ticket.assignees.join(', ')}</p>
                                            </div>
                                            <button onclick="event.stopPropagation(); unlinkTicketFromProject(${project.id}, ${ticket.id})" 
                                                    class="ml-4 px-3 py-2 text-red-600 hover:bg-red-50 rounded-lg transition">
                                                <i class="fas fa-unlink"></i>
                                            </button>
                                        </div>
                                    `;
                                }).join('')}
                            </div>
                        ` : `
                            <div class="text-center py-12 bg-gray-50 rounded-lg">
                                <i class="fas fa-inbox text-gray-300 text-5xl mb-3"></i>
                                <p class="text-gray-500">ì—°ê²°ëœ í‹°ì¼“ì´ ì—†ìŠµë‹ˆë‹¤.</p>
                                <button onclick="openLinkTicketToProject(${project.id})" class="mt-3 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 text-sm">
                                    í‹°ì¼“ ì—°ê²°í•˜ê¸°
                                </button>
                            </div>
                        `}
                    </div>
                </div>
            `;
            
            openModal('projectDetailModal');
        }

        // í”„ë¡œì íŠ¸ì— í‹°ì¼“ ì—°ê²° ëª¨ë‹¬
        function openLinkTicketToProject(projectId) {
            const project = projects.find(p => p.id === projectId);
            if (!project) return;
            
            const availableTickets = tickets.filter(t => !project.linkedTickets.includes(t.id));
            
            // ê¸°ì¡´ ëª¨ë‹¬ì´ ìˆìœ¼ë©´ ì œê±°
            const existingModal = document.getElementById('linkTicketProjectModal');
            if (existingModal) {
                existingModal.remove();
            }
            
            const modal = document.createElement('div');
            modal.id = 'linkTicketProjectModal';
            modal.className = 'modal';
            modal.innerHTML = `
                <div class="bg-white rounded-2xl shadow-2xl max-w-3xl w-full mx-4 p-8 max-h-[90vh] overflow-y-auto">
                    <div class="flex items-center justify-between mb-6">
                        <h3 class="text-2xl font-bold text-gray-800">í‹°ì¼“ ì—°ê²°</h3>
                        <button onclick="closeLinkTicketProjectModal()" class="text-gray-400 hover:text-gray-600">
                            <i class="fas fa-times text-2xl"></i>
                        </button>
                    </div>
                    
                    ${availableTickets.length > 0 ? `
                        <div class="space-y-3">
                            ${availableTickets.map(ticket => {
                                let statusColor = 'bg-gray-100 text-gray-700';
                                if (ticket.status === 'ì²˜ë¦¬ì¤‘') statusColor = 'bg-blue-100 text-blue-700';
                                else if (ticket.status === 'ì™„ë£Œ') statusColor = 'bg-green-100 text-green-700';
                                
                                return `
                                    <div class="p-4 border-2 border-gray-200 rounded-lg hover:border-purple-300 transition cursor-pointer"
                                         onclick="linkTicketToProject(${projectId}, ${ticket.id})">
                                        <div class="flex items-center gap-3 mb-2">
                                            <span class="text-sm font-mono text-purple-600">${ticket.ticketNumber}</span>
                                            <span class="px-3 py-1 ${statusColor} rounded-full text-xs font-semibold">${ticket.status}</span>
                                            <span class="px-3 py-1 bg-gray-200 text-gray-700 rounded-full text-xs">${ticket.category}</span>
                                        </div>
                                        <h5 class="font-semibold text-gray-800">${ticket.title}</h5>
                                        <p class="text-sm text-gray-500 mt-1">ë‹´ë‹¹: ${ticket.assignees.join(', ')}</p>
                                    </div>
                                `;
                            }).join('')}
                        </div>
                    ` : `
                        <div class="text-center py-12">
                            <i class="fas fa-check-circle text-green-400 text-5xl mb-3"></i>
                            <p class="text-gray-500">ëª¨ë“  í‹°ì¼“ì´ ì´ë¯¸ ì—°ê²°ë˜ì–´ ìˆìŠµë‹ˆë‹¤.</p>
                        </div>
                    `}
                </div>
            `;
            
            document.body.appendChild(modal);
            // active í´ë˜ìŠ¤ ì‚¬ìš©
            setTimeout(() => modal.classList.add('active'), 10);
        }

        // í‹°ì¼“ ì—°ê²° ëª¨ë‹¬ ë‹«ê¸°
        function closeLinkTicketProjectModal() {
            const modal = document.getElementById('linkTicketProjectModal');
            if (modal) {
                modal.classList.remove('active');
                setTimeout(() => modal.remove(), 300);
            }
        }

        // í‹°ì¼“ì„ í”„ë¡œì íŠ¸ì— ì—°ê²°
        function linkTicketToProject(projectId, ticketId) {
            const project = projects.find(p => p.id === projectId);
            if (!project) return;
            
            if (!project.linkedTickets.includes(ticketId)) {
                project.linkedTickets.push(ticketId);
                console.log(`âœ… í‹°ì¼“ ${ticketId}ë¥¼ í”„ë¡œì íŠ¸ ${projectId}ì— ì—°ê²°`);
            }
            
            closeLinkTicketProjectModal();
            openProjectDetail(projectId);
            renderProjects();
        }

        // í‹°ì¼“ ì—°ê²° í•´ì œ
        function unlinkTicketFromProject(projectId, ticketId) {
            if (!confirm('ì´ í‹°ì¼“ì˜ ì—°ê²°ì„ í•´ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;
            
            const project = projects.find(p => p.id === projectId);
            if (!project) return;
            
            project.linkedTickets = project.linkedTickets.filter(id => id !== ticketId);
            
            openProjectDetail(projectId);
            renderProjects();
            
            console.log(`âœ… í‹°ì¼“ ${ticketId} ì—°ê²° í•´ì œ`);
        }

        // Switch Admin Tab
        function switchAdminTab(tab) {
            document.querySelectorAll('.nav-tab').forEach(btn => btn.classList.remove('active'));
            event.target.closest('.nav-tab').classList.add('active');
            
            document.querySelectorAll('.admin-tab-content').forEach(content => content.classList.add('hidden'));
            document.getElementById(`admin-${tab}-tab`).classList.remove('hidden');
            
            if (tab === 'kanban') renderKanban();
            else if (tab === 'list') renderAdminTickets();
            else if (tab === 'gantt') renderGantt();
            else if (tab === 'analytics') updateAdminStats();
            else if (tab === 'workload') renderWorkload();
            else if (tab === 'projects') renderProjects();
            else if (tab === 'assets') renderAssetManagement();
            else if (tab === 'board') renderAdminBoard(); // ğŸ†•
            else if (tab === 'account') {
                renderRatesDisplay();
                renderStaffList();
            }
        }

        // Render Kanban Board
        function renderKanban() {
            const container = document.getElementById('kanban-board');
            const statuses = ['ìš”ì²­', 'ê²¬ì í™•ì¸', 'ìŠ¹ì¸ëŒ€ê¸°', 'ì ‘ìˆ˜', 'ì²˜ë¦¬ì¤‘', 'ì¬ê²€ìˆ˜ì¤‘', 'ê²€ìˆ˜ ëŒ€ê¸°', 'ì™„ë£Œ', 'ë³´ë¥˜', 'ë°˜ë ¤', 'ì·¨ì†Œ'];
            
            // í•„í„° ì ìš© ğŸ†•
            const filteredTickets = getFilteredTickets(tickets);
            
            container.innerHTML = statuses.map(status => {
                const statusTickets = filteredTickets.filter(t => t.status === status);
                
                // ìƒíƒœë³„ ìƒ‰ìƒ ì„¤ì •
                let headerColor = 'bg-gray-100';
                let textColor = 'text-gray-700';
                if (status === 'ìš”ì²­') {
                    headerColor = 'bg-yellow-50';
                    textColor = 'text-yellow-700';
                } else if (status === 'ì ‘ìˆ˜') {
                    headerColor = 'bg-blue-50';
                    textColor = 'text-blue-700';
                } else if (status === 'ê²¬ì í™•ì¸') {
                    headerColor = 'bg-cyan-50';
                    textColor = 'text-cyan-700';
                } else if (status === 'ìŠ¹ì¸ëŒ€ê¸°') {
                    headerColor = 'bg-teal-50';
                    textColor = 'text-teal-700';
                } else if (status === 'ì²˜ë¦¬ì¤‘') {
                    headerColor = 'bg-indigo-50';
                    textColor = 'text-indigo-700';
                } else if (status === 'ì¬ê²€ìˆ˜ì¤‘') {
                    headerColor = 'bg-pink-50';
                    textColor = 'text-pink-700';
                } else if (status === 'ê²€ìˆ˜ ëŒ€ê¸°') {
                    headerColor = 'bg-purple-50';
                    textColor = 'text-purple-700';
                } else if (status === 'ì™„ë£Œ') {
                    headerColor = 'bg-green-50';
                    textColor = 'text-green-700';
                } else if (status === 'ë³´ë¥˜') {
                    headerColor = 'bg-orange-50';
                    textColor = 'text-orange-700';
                } else if (status === 'ë°˜ë ¤') {
                    headerColor = 'bg-red-50';
                    textColor = 'text-red-700';
                } else if (status === 'ì·¨ì†Œ') {
                    headerColor = 'bg-gray-100';
                    textColor = 'text-gray-600';
                }
                
                return `
                    <div class="kanban-column">
                        <div class="flex items-center justify-between mb-4 ${headerColor} p-3 rounded-lg">
                            <h3 class="font-bold ${textColor}">${status}</h3>
                            <span class="bg-white ${textColor} text-xs px-2.5 py-1 rounded-full font-semibold shadow-sm">${statusTickets.length}</span>
                        </div>
                        <div class="space-y-3 min-h-[400px]">
                            ${statusTickets.map(ticket => `
                                <div class="kanban-card relative" onclick="openTicketDetail(${ticket.id})">
                                    ${status === 'ì ‘ìˆ˜' && ticket.approved === false ? `
                                        <div class="absolute -top-2 -right-2 bg-red-500 text-white text-xs px-2 py-1 rounded-full font-bold shadow-lg z-10">
                                            <i class="fas fa-exclamation-circle mr-1"></i>ë¯¸ìŠ¹ì¸
                                        </div>
                                    ` : ''}
                                    ${status === 'ì ‘ìˆ˜' && ticket.approved === true ? `
                                        <div class="absolute -top-2 -right-2 bg-green-500 text-white text-xs px-2 py-1 rounded-full font-bold shadow-lg z-10">
                                            <i class="fas fa-check-circle mr-1"></i>ìŠ¹ì¸ì™„ë£Œ
                                        </div>
                                    ` : ''}
                                    ${(() => {
                                        const slaStatus = getSLAStatus(ticket.createdAt, ticket.priority, ticket.status);
                                        const deadline = calculateSLADeadline(ticket.createdAt, ticket.priority);
                                        const hoursRemaining = Math.round((deadline - new Date()) / (1000 * 60 * 60));
                                        
                                        if (slaStatus === 'overdue') {
                                            return `
                                                <div class="absolute top-2 left-2 bg-red-600 text-white text-xs px-2 py-1 rounded font-bold shadow-lg z-10">
                                                    <i class="fas fa-exclamation-triangle mr-1"></i>ì§€ì—° ${Math.abs(hoursRemaining)}h
                                                </div>
                                            `;
                                        } else if (slaStatus === 'urgent') {
                                            return `
                                                <div class="absolute top-2 left-2 bg-orange-500 text-white text-xs px-2 py-1 rounded font-bold shadow-lg z-10 animate-pulse">
                                                    <i class="fas fa-clock mr-1"></i>${hoursRemaining}h ë‚¨ìŒ
                                                </div>
                                            `;
                                        }
                                        return '';
                                    })()}
                                    <div class="flex items-start justify-between mb-2">
                                        <span class="font-mono text-xs text-blue-600 font-semibold">${ticket.ticketNumber}</span>
                                        <i class="fas fa-flag text-sm priority-${ticket.priority === 'ë†’ìŒ' ? 'high' : ticket.priority === 'ë³´í†µ' ? 'medium' : 'low'}"></i>
                                    </div>
                                    ${ticket.ticketType === 'ìì‚°' ? `
                                        <div class="mb-2">
                                            ${ticket.assetCategory === 'í•˜ë“œì›¨ì–´' ? `
                                                <span class="inline-flex items-center px-2 py-1 bg-purple-100 text-purple-700 text-xs rounded-full font-semibold">
                                                    <i class="fas fa-laptop mr-1"></i>í•˜ë“œì›¨ì–´
                                                </span>
                                            ` : ticket.assetCategory === 'ì†Œí”„íŠ¸ì›¨ì–´' ? `
                                                <span class="inline-flex items-center px-2 py-1 bg-blue-100 text-blue-700 text-xs rounded-full font-semibold">
                                                    <i class="fas fa-code mr-1"></i>ì†Œí”„íŠ¸ì›¨ì–´
                                                </span>
                                            ` : ticket.assetCategory === 'í´ë¼ìš°ë“œ' ? `
                                                <span class="inline-flex items-center px-2 py-1 bg-cyan-100 text-cyan-700 text-xs rounded-full font-semibold">
                                                    <i class="fas fa-cloud mr-1"></i>í´ë¼ìš°ë“œ
                                                </span>
                                            ` : ''}
                                        </div>
                                    ` : ''}
                                    <h4 class="font-semibold text-sm text-gray-800 mb-2 line-clamp-2">${ticket.title}</h4>
                                    <div class="flex items-center justify-between text-xs text-gray-500 mb-2">
                                        <span><i class="fas fa-user mr-1"></i>${ticket.requester}</span>
                                        <div class="flex items-center space-x-2">
                                            ${ticket.linkedTickets && ticket.linkedTickets.length > 0 ? `
                                                <span class="text-blue-600 font-semibold" title="ì—°ê²°ëœ í‹°ì¼“ ${ticket.linkedTickets.length}ê°œ">
                                                    <i class="fas fa-link mr-1"></i>${ticket.linkedTickets.length}
                                                </span>
                                            ` : ''}
                                            ${ticket.subtasks.length > 0 ? `<span><i class="fas fa-tasks mr-1"></i>${ticket.subtasks.length}</span>` : ''}
                                        </div>
                                    </div>
                                    ${ticket.assignees.length > 0 ? `
                                        <div class="mt-3 flex items-center space-x-1">
                                            ${ticket.assignees.slice(0, 3).map(assignee => `
                                                <div class="w-7 h-7 rounded-full bg-gradient-to-br from-blue-400 to-purple-500 flex items-center justify-center text-white text-xs font-semibold" title="${assignee}">
                                                    ${assignee.charAt(0)}
                                                </div>
                                            `).join('')}
                                            ${ticket.assignees.length > 3 ? `<span class="text-xs text-gray-500 ml-1">+${ticket.assignees.length - 3}</span>` : ''}
                                        </div>
                                    ` : `
                                        ${status === 'ìš”ì²­' ? '<div class="mt-3 text-xs text-yellow-600 font-semibold"><i class="fas fa-clock mr-1"></i>ê²€í†  ëŒ€ê¸°</div>' : ''}
                                        ${status === 'ì ‘ìˆ˜' && ticket.approved === false ? '<div class="mt-3 text-xs text-red-600 font-semibold"><i class="fas fa-user-shield mr-1"></i>ë§ˆìŠ¤í„° ìŠ¹ì¸ ëŒ€ê¸°</div>' : ''}
                                    `}
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
            }).join('');
        }

        // Confirm Reject
        function confirmReject(ticketId) {
            if (confirm('ì´ í‹°ì¼“ì„ ë°˜ë ¤í•˜ì‹œê² ìŠµë‹ˆê¹Œ?\në°˜ë ¤ ì‚¬ìœ ë¥¼ ì‹ ì²­ìì—ê²Œ ì „ë‹¬í•´ì•¼ í•©ë‹ˆë‹¤.')) {
                const reason = prompt('ë°˜ë ¤ ì‚¬ìœ ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”:');
                if (reason && reason.trim()) {
                    const ticket = tickets.find(t => t.id === ticketId);
                    if (ticket) {
                        ticket.status = 'ë°˜ë ¤';
                        ticket.rejectReason = reason;
                        closeModal('ticketDetailModal');
                        renderAdminView();
                        alert('í‹°ì¼“ì´ ë°˜ë ¤ë˜ì—ˆìŠµë‹ˆë‹¤.');
                    }
                } else if (reason !== null) {
                    alert('ë°˜ë ¤ ì‚¬ìœ ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                }
            }
        }

        // Render Admin Tickets
        function renderAdminTickets() {
            const container = document.getElementById('admin-ticket-list');
            const filter = document.getElementById('admin-status-filter').value;
            const categoryMainFilter = document.getElementById('admin-categoryMain-filter').value;
            const categoryMiddleFilter = document.getElementById('admin-categoryMiddle-filter').value;
            const categorySubFilter = document.getElementById('admin-categorySub-filter').value;
            const search = document.getElementById('admin-search').value.toLowerCase();
            
            // í•„í„° ì ìš© (ITSM/ìì‚° + Admin ê¶Œí•œ) ğŸ†•
            let filteredTickets = getFilteredTickets(tickets);
            
            if (filter) filteredTickets = filteredTickets.filter(t => t.status === filter);
            if (categoryMainFilter) filteredTickets = filteredTickets.filter(t => 
                (t.categoryMain === categoryMainFilter) || (t.category === categoryMainFilter)
            );
            if (categoryMiddleFilter) filteredTickets = filteredTickets.filter(t => 
                t.categoryMiddle === categoryMiddleFilter
            );
            if (categorySubFilter) filteredTickets = filteredTickets.filter(t => 
                t.categorySub === categorySubFilter
            );
            if (search) filteredTickets = filteredTickets.filter(t => 
                t.title.toLowerCase().includes(search) || 
                t.ticketNumber.toLowerCase().includes(search) ||
                t.requester.toLowerCase().includes(search)
            );
            
            if (filteredTickets.length === 0) {
                container.innerHTML = '<tr><td colspan="11" class="text-center py-12 text-gray-500">í‹°ì¼“ì´ ì—†ìŠµë‹ˆë‹¤.</td></tr>';
                return;
            }
            
            container.innerHTML = filteredTickets.map(ticket => {
                const progress = calculateProgress(ticket);
                
                // ì¹´í…Œê³ ë¦¬ 3ë‹¨ê³„ í‘œì‹œ
                let categoryDisplay = '';
                if (ticket.categoryMain || ticket.category) {
                    categoryDisplay = `<span class="text-xs bg-blue-100 text-blue-700 px-2 py-1 rounded font-semibold">${ticket.categoryMain || ticket.category}</span>`;
                    if (ticket.categoryMiddle) {
                        categoryDisplay += ` <span class="text-xs text-gray-400">â€º</span> <span class="text-xs bg-gray-100 text-gray-600 px-2 py-1 rounded">${ticket.categoryMiddle}</span>`;
                    }
                    if (ticket.categorySub) {
                        categoryDisplay += ` <span class="text-xs text-gray-400">â€º</span> <span class="text-xs bg-gray-50 text-gray-500 px-2 py-1 rounded">${ticket.categorySub}</span>`;
                    }
                } else {
                    categoryDisplay = '<span class="text-xs text-gray-400">ë¯¸ë¶„ë¥˜</span>';
                }
                
                return `
                    <tr onclick="openTicketDetail(${ticket.id})">
                        <td><span class="font-mono text-sm font-semibold text-blue-600">${ticket.ticketNumber}</span></td>
                        <td><span class="status-badge status-${ticket.status}">${ticket.status}</span></td>
                        <td>
                            <i class="fas fa-flag priority-${ticket.priority === 'ë†’ìŒ' ? 'high' : ticket.priority === 'ë³´í†µ' ? 'medium' : 'low'}"></i>
                        </td>
                        <td>${categoryDisplay}</td>
                        <td class="font-medium text-gray-800">${ticket.title}</td>
                        <td class="text-sm text-gray-600">${ticket.requester}</td>
                        <td class="text-sm text-gray-600">${ticket.createdAt}</td>
                        <td class="text-sm">
                            ${ticket.assignees.length > 0 ? 
                                `<span class="text-blue-600">${ticket.assignees.join(', ')}</span>` 
                                : '<span class="text-yellow-600">ë¯¸ë°°ì •</span>'}
                        </td>
                        <td class="text-center">
                            ${ticket.subtasks.length > 0 ? 
                                `<span class="bg-purple-100 text-purple-700 px-2 py-1 rounded text-xs font-semibold">${ticket.subtasks.length}ê°œ</span>` 
                                : '-'}
                        </td>
                        <td class="text-center" onclick="event.stopPropagation()">
                            ${ticket.linkedTickets && ticket.linkedTickets.length > 0 ? 
                                `<div class="relative inline-block group">
                                    <span class="bg-blue-100 text-blue-700 px-2 py-1 rounded text-xs font-semibold cursor-help">
                                        <i class="fas fa-link mr-1"></i>${ticket.linkedTickets.length}ê°œ
                                    </span>
                                    <div class="hidden group-hover:block absolute z-10 w-48 bg-white border border-gray-300 rounded-lg shadow-xl p-2 -left-20 top-8">
                                        <div class="text-xs font-semibold text-gray-700 mb-2">ì—°ê²°ëœ í‹°ì¼“</div>
                                        ${ticket.linkedTickets.map(linkedId => {
                                            const linkedTicket = tickets.find(t => t.id === linkedId);
                                            if (!linkedTicket) return '';
                                            return `
                                                <div class="flex items-center justify-between hover:bg-gray-50 p-1 rounded cursor-pointer" 
                                                     onclick="event.stopPropagation(); openTicketDetail(${linkedId})">
                                                    <span class="font-mono text-xs text-blue-600 font-semibold">${linkedTicket.ticketNumber}</span>
                                                    <span class="text-xs text-gray-600 truncate ml-2" style="max-width: 100px;" title="${linkedTicket.title}">${linkedTicket.title}</span>
                                                </div>
                                            `;
                                        }).join('')}
                                    </div>
                                </div>` 
                                : '-'}
                        </td>
                        <td>
                            <div class="flex items-center space-x-2">
                                <div class="flex-1 bg-gray-200 rounded-full h-2">
                                    <div class="bg-gradient-to-r from-blue-500 to-purple-500 h-2 rounded-full" style="width: ${progress}%"></div>
                                </div>
                                <span class="text-xs font-semibold">${progress}%</span>
                            </div>
                        </td>
                        <td onclick="event.stopPropagation()">
                            ${ticket.status === 'ìš”ì²­' ? `
                                <button onclick="openAssignModal(${ticket.id})" class="text-blue-600 hover:text-blue-700 text-sm font-semibold">
                                    ë°°ì •
                                </button>
                            ` : ''}
                        </td>
                    </tr>
                `;
            }).join('');
        }

        // Render Gantt Chart
        function renderGantt() {
            const container = document.getElementById('gantt-container');
            const groupBy = document.getElementById('gantt-group-by').value;
            const ticketsWithDates = tickets.filter(t => t.subtasks.some(st => st.startDate));
            
            if (ticketsWithDates.length === 0) {
                container.innerHTML = '<div class="p-12 text-center text-gray-500">ì¼ì •ì´ ë“±ë¡ëœ í‹°ì¼“ì´ ì—†ìŠµë‹ˆë‹¤.</div>';
                return;
            }
            
            // Calculate date range
            let minDate = new Date();
            let maxDate = new Date();
            
            ticketsWithDates.forEach(ticket => {
                ticket.subtasks.forEach(sub => {
                    if (sub.startDate) {
                        const start = new Date(sub.startDate);
                        if (start < minDate) minDate = start;
                    }
                    if (sub.endDate) {
                        const end = new Date(sub.endDate);
                        if (end > maxDate) maxDate = end;
                    }
                });
            });
            
            minDate.setDate(minDate.getDate() - 7);
            maxDate.setDate(maxDate.getDate() + 7);
            
            const daysDiff = Math.ceil((maxDate - minDate) / (1000 * 60 * 60 * 24));
            const dateHeaders = [];
            for (let i = 0; i <= daysDiff; i++) {
                const date = new Date(minDate);
                date.setDate(date.getDate() + i);
                dateHeaders.push(date);
            }
            
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            const todayPos = Math.ceil((today - minDate) / (1000 * 60 * 60 * 24));
            
            if (groupBy === 'ticket') {
                container.innerHTML = `
                    <div class="gantt-container">
                        <div class="flex border-b-2 border-gray-300 bg-gray-50 sticky top-0 z-10">
                            <div class="gantt-label font-bold">í‹°ì¼“ / í•˜ìœ„ì—…ë¬´</div>
                            <div class="gantt-timeline">
                                ${dateHeaders.map(date => `
                                    <div class="gantt-date-cell">
                                        <div class="font-bold">${date.getMonth() + 1}/${date.getDate()}</div>
                                        <div class="text-gray-500">${['ì¼','ì›”','í™”','ìˆ˜','ëª©','ê¸ˆ','í† '][date.getDay()]}</div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                        
                        ${ticketsWithDates.map((ticket, idx) => {
                            // Calculate overall ticket timeline from subtasks
                            let ticketStartDate = null;
                            let ticketEndDate = null;
                            
                            ticket.subtasks.forEach(sub => {
                                if (sub.startDate) {
                                    const subStart = new Date(sub.startDate);
                                    if (!ticketStartDate || subStart < ticketStartDate) {
                                        ticketStartDate = subStart;
                                    }
                                }
                                if (sub.endDate) {
                                    const subEnd = new Date(sub.endDate);
                                    if (!ticketEndDate || subEnd > ticketEndDate) {
                                        ticketEndDate = subEnd;
                                    }
                                }
                            });
                            
                            let ticketBarStyle = '';
                            if (ticketStartDate && ticketEndDate) {
                                const startPos = Math.ceil((ticketStartDate - minDate) / (1000 * 60 * 60 * 24));
                                const duration = Math.ceil((ticketEndDate - ticketStartDate) / (1000 * 60 * 60 * 24)) + 1;
                                ticketBarStyle = `left: ${startPos * 60}px; width: ${duration * 60}px;`;
                            }
                            
                            return `
                            <div>
                                <div class="gantt-row bg-blue-50">
                                    <div class="gantt-label cursor-pointer" onclick="toggleGanttTicket(${idx})">
                                        <i class="fas fa-chevron-down collapsible-icon mr-2" id="gantt-icon-${idx}"></i>
                                        <strong>${ticket.title}</strong>
                                        <span class="text-xs text-gray-500 ml-2">(${ticket.subtasks.length}ê°œ)</span>
                                    </div>
                                    <div class="gantt-timeline">
                                        ${todayPos >= 0 && todayPos <= daysDiff ? `
                                            <div class="gantt-today" style="left: ${todayPos * 60 + 30}px;"></div>
                                        ` : ''}
                                        ${ticketBarStyle ? `
                                            <div class="gantt-bar gantt-bar-main relative group" style="${ticketBarStyle}" onclick="event.stopPropagation(); openTicketDetail(${ticket.id})">
                                                <i class="fas fa-calendar-alt mr-2"></i>${ticket.title}
                                                ${ticket.linkedTickets && ticket.linkedTickets.length > 0 ? `
                                                    <span class="ml-2 text-xs bg-white bg-opacity-30 px-2 py-0.5 rounded-full">
                                                        <i class="fas fa-link"></i> ${ticket.linkedTickets.length}
                                                    </span>
                                                    <div class="hidden group-hover:block absolute z-50 bg-white border-2 border-blue-500 rounded-lg shadow-2xl p-3 left-0 top-full mt-2 min-w-[250px]">
                                                        <div class="text-xs font-bold text-gray-700 mb-2 border-b pb-2">
                                                            <i class="fas fa-link text-blue-600 mr-1"></i>ì—°ê²°ëœ í‹°ì¼“ (${ticket.linkedTickets.length}ê°œ)
                                                        </div>
                                                        <div class="space-y-1 max-h-[200px] overflow-y-auto">
                                                            ${ticket.linkedTickets.map(linkedId => {
                                                                const linkedTicket = tickets.find(t => t.id === linkedId);
                                                                if (!linkedTicket) return '';
                                                                return '<div class="flex items-center justify-between hover:bg-blue-50 p-2 rounded cursor-pointer transition" onclick="event.stopPropagation(); openTicketDetail(' + linkedId + ');">' +
                                                                    '<div class="flex-1">' +
                                                                        '<div class="font-mono text-xs text-blue-600 font-bold">' + linkedTicket.ticketNumber + '</div>' +
                                                                        '<div class="text-xs text-gray-700 mt-0.5 line-clamp-1">' + linkedTicket.title + '</div>' +
                                                                    '</div>' +
                                                                    '<span class="status-badge status-' + linkedTicket.status + ' ml-2">' + linkedTicket.status + '</span>' +
                                                                '</div>';
                                                            }).join('')}
                                                        </div>
                                                        <div class="text-xs text-gray-500 mt-2 pt-2 border-t">
                                                            <i class="fas fa-info-circle mr-1"></i>í´ë¦­í•˜ì—¬ í‹°ì¼“ìœ¼ë¡œ ì´ë™
                                                        </div>
                                                    </div>
                                                ` : ''}
                                            </div>
                                        ` : ''}
                                    </div>
                                </div>
                                
                                <div id="gantt-subtasks-${idx}">
                                    ${ticket.subtasks.map(sub => {
                                        if (!sub.startDate || !sub.endDate) return '';
                                        
                                        const startDate = new Date(sub.startDate);
                                        const endDate = new Date(sub.endDate);
                                        const startPos = Math.ceil((startDate - minDate) / (1000 * 60 * 60 * 24));
                                        const duration = Math.ceil((endDate - startDate) / (1000 * 60 * 60 * 24)) + 1;
                                        
                                        return `
                                            <div class="gantt-row">
                                                <div class="gantt-label pl-12 text-sm text-gray-700">
                                                    ${sub.title}
                                                    <div class="text-xs text-gray-500 mt-1">${sub.assignee}</div>
                                                </div>
                                                <div class="gantt-timeline">
                                                    ${todayPos >= 0 && todayPos <= daysDiff ? `
                                                        <div class="gantt-today" style="left: ${todayPos * 60 + 30}px;"></div>
                                                    ` : ''}
                                                    <div class="gantt-bar gantt-bar-sub" style="left: ${startPos * 60}px; width: ${duration * 60}px;" 
                                                         onclick="event.stopPropagation(); openSubtaskQuickEdit(${ticket.id}, '${sub.id}')"
                                                         oncontextmenu="event.preventDefault(); event.stopPropagation(); openSubtaskContextMenu(event, ${ticket.id}, '${sub.id}')">
                                                        ${sub.title}
                                                    </div>
                                                </div>
                                            </div>
                                        `;
                                    }).join('')}
                                </div>
                            </div>
                        `;
                        }).join('')}
                    </div>
                `;
            } else {
                // Group by assignee
                const assignees = {};
                ticketsWithDates.forEach(ticket => {
                    ticket.subtasks.forEach(sub => {
                        if (sub.assignee && sub.startDate) {
                            if (!assignees[sub.assignee]) assignees[sub.assignee] = [];
                            assignees[sub.assignee].push({...sub, ticketTitle: ticket.title, ticketId: ticket.id});
                        }
                    });
                });
                
                container.innerHTML = `
                    <div class="gantt-container">
                        <div class="flex border-b-2 border-gray-300 bg-gray-50 sticky top-0 z-10">
                            <div class="gantt-label font-bold">ë‹´ë‹¹ì / ì—…ë¬´</div>
                            <div class="gantt-timeline">
                                ${dateHeaders.map(date => `
                                    <div class="gantt-date-cell">
                                        <div class="font-bold">${date.getMonth() + 1}/${date.getDate()}</div>
                                        <div class="text-gray-500">${['ì¼','ì›”','í™”','ìˆ˜','ëª©','ê¸ˆ','í† '][date.getDay()]}</div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                        
                        ${Object.entries(assignees).map(([assignee, tasks], idx) => {
                            // Calculate merged timelines for this assignee
                            const timelines = [];
                            tasks.forEach(task => {
                                if (task.startDate && task.endDate) {
                                    timelines.push({
                                        startDate: new Date(task.startDate),
                                        endDate: new Date(task.endDate)
                                    });
                                }
                            });
                            
                            // Sort by start date
                            timelines.sort((a, b) => a.startDate - b.startDate);
                            
                            // Merge overlapping/adjacent timelines
                            const mergedTimelines = [];
                            timelines.forEach(timeline => {
                                if (mergedTimelines.length === 0) {
                                    mergedTimelines.push({...timeline});
                                } else {
                                    const last = mergedTimelines[mergedTimelines.length - 1];
                                    const dayDiff = (timeline.startDate - last.endDate) / (1000 * 60 * 60 * 24);
                                    if (dayDiff <= 1) {
                                        // Merge
                                        last.endDate = new Date(Math.max(last.endDate, timeline.endDate));
                                    } else {
                                        // New segment
                                        mergedTimelines.push({...timeline});
                                    }
                                }
                            });
                            
                            return `
                            <div>
                                <div class="gantt-row bg-purple-50">
                                    <div class="gantt-label cursor-pointer" onclick="toggleGanttAssignee(${idx})">
                                        <i class="fas fa-chevron-down collapsible-icon mr-2" id="gantt-assignee-icon-${idx}"></i>
                                        <div class="w-8 h-8 rounded-full bg-gradient-to-br from-blue-400 to-purple-500 flex items-center justify-center text-white text-sm font-semibold inline-flex mr-2">
                                            ${assignee.charAt(0)}
                                        </div>
                                        <strong>${assignee}</strong>
                                        <span class="text-xs text-gray-500 ml-2">(${tasks.length}ê°œ ì—…ë¬´)</span>
                                    </div>
                                    <div class="gantt-timeline">
                                        ${todayPos >= 0 && todayPos <= daysDiff ? `
                                            <div class="gantt-today" style="left: ${todayPos * 60 + 30}px;"></div>
                                        ` : ''}
                                        ${mergedTimelines.map(timeline => {
                                            const startPos = Math.ceil((timeline.startDate - minDate) / (1000 * 60 * 60 * 24));
                                            const duration = Math.ceil((timeline.endDate - timeline.startDate) / (1000 * 60 * 60 * 24)) + 1;
                                            return `
                                                <div class="gantt-bar gantt-bar-assignee" style="left: ${startPos * 60}px; width: ${duration * 60}px;" title="${assignee} ë‹´ë‹¹ ê¸°ê°„">
                                                    <i class="fas fa-user-clock mr-2"></i>${assignee} ë‹´ë‹¹
                                                </div>
                                            `;
                                        }).join('')}
                                    </div>
                                </div>
                                
                                <div id="gantt-assignee-tasks-${idx}">
                                    ${tasks.map(task => {
                                        const startDate = new Date(task.startDate);
                                        const endDate = new Date(task.endDate);
                                        const startPos = Math.ceil((startDate - minDate) / (1000 * 60 * 60 * 24));
                                        const duration = Math.ceil((endDate - startDate) / (1000 * 60 * 60 * 24)) + 1;
                                        
                                        return `
                                            <div class="gantt-row">
                                                <div class="gantt-label pl-12 text-sm">
                                                    ${task.title}
                                                    <div class="text-xs text-gray-500 mt-1">${task.ticketTitle}</div>
                                                </div>
                                                <div class="gantt-timeline">
                                                    ${todayPos >= 0 && todayPos <= daysDiff ? `
                                                        <div class="gantt-today" style="left: ${todayPos * 60 + 30}px;"></div>
                                                    ` : ''}
                                                    <div class="gantt-bar gantt-bar-sub" style="left: ${startPos * 60}px; width: ${duration * 60}px;" 
                                                         onclick="event.stopPropagation(); openSubtaskQuickEdit(${task.ticketId}, '${task.id}')"
                                                         oncontextmenu="event.preventDefault(); event.stopPropagation(); openSubtaskContextMenu(event, ${task.ticketId}, '${task.id}')">
                                                        ${task.title}
                                                    </div>
                                                </div>
                                            </div>
                                        `;
                                    }).join('')}
                                </div>
                            </div>
                        `;
                        }).join('')}
                    </div>
                `;
            }
        }

        // Toggle Gantt Sections
        function toggleGanttTicket(idx) {
            const icon = document.getElementById(`gantt-icon-${idx}`);
            const content = document.getElementById(`gantt-subtasks-${idx}`);
            icon.classList.toggle('collapsed');
            content.classList.toggle('collapsed-content');
        }

        function toggleGanttAssignee(idx) {
            const icon = document.getElementById(`gantt-assignee-icon-${idx}`);
            const content = document.getElementById(`gantt-assignee-tasks-${idx}`);
            icon.classList.toggle('collapsed');
            content.classList.toggle('collapsed-content');
        }

        // Update Admin Stats
        function updateAdminStats() {
            document.getElementById('admin-stat-total').textContent = tickets.length;
            document.getElementById('admin-stat-waiting').textContent = tickets.filter(t => t.status === 'ìš”ì²­').length;
            document.getElementById('admin-stat-progress').textContent = tickets.filter(t => t.status === 'ì ‘ìˆ˜' || t.status === 'ì²˜ë¦¬ì¤‘').length;
            document.getElementById('admin-stat-done').textContent = tickets.filter(t => t.status === 'ì™„ë£Œ').length;
            
            // Render real-time status
            renderRealtimeStatus();
            
            // Render assignee real-time status
            renderAssigneeRealtimeStatus();
            
            // Render monthly completion
            renderMonthlyCompletion();
            
            // Render team performance
            renderTeamPerformance();
        }

        // Render Assignee Real-time Status
        function renderAssigneeRealtimeStatus() {
            const container = document.getElementById('assignee-realtime-status');
            const assignees = ['ê¹€ê°œë°œ', 'ì´í”„ë¡ íŠ¸', 'ë°•ë””ìì¸', 'ìµœì¸í”„ë¼', 'ì •ê¸°íš'];
            
            container.innerHTML = assignees.map(assignee => {
                const assignedTickets = tickets.filter(t => t.assignees.includes(assignee));
                const total = assignedTickets.length;
                const inProgress = assignedTickets.filter(t => t.status === 'ì ‘ìˆ˜' || t.status === 'ì²˜ë¦¬ì¤‘').length;
                const completed = assignedTickets.filter(t => t.status === 'ì™„ë£Œ').length;
                const waiting = assignedTickets.filter(t => t.status === 'ìš”ì²­').length;
                const onHold = assignedTickets.filter(t => t.status === 'ë³´ë¥˜').length;
                
                const completionRate = total > 0 ? Math.round((completed / total) * 100) : 0;
                const rateColor = completionRate >= 80 ? 'green' : completionRate >= 60 ? 'blue' : 'yellow';
                
                return `
                    <div class="bg-gradient-to-br from-gray-50 to-gray-100 rounded-lg p-4 border border-gray-200">
                        <div class="flex items-center justify-between mb-3">
                            <div class="flex items-center">
                                <div class="w-10 h-10 rounded-full bg-gradient-to-br from-blue-400 to-purple-500 flex items-center justify-center text-white font-semibold mr-2">
                                    ${assignee.charAt(0)}
                                </div>
                                <div>
                                    <div class="font-bold text-gray-800">${assignee}</div>
                                    <div class="text-xs text-gray-500">ì´ ${total}ê±´</div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="space-y-2 mb-3">
                            <div class="flex items-center justify-between text-xs">
                                <span class="text-gray-600">ì§„í–‰ì¤‘</span>
                                <span class="font-semibold text-indigo-600">${inProgress}ê±´</span>
                            </div>
                            <div class="flex items-center justify-between text-xs">
                                <span class="text-gray-600">ì™„ë£Œ</span>
                                <span class="font-semibold text-green-600">${completed}ê±´</span>
                            </div>
                            ${waiting > 0 ? `
                                <div class="flex items-center justify-between text-xs">
                                    <span class="text-gray-600">ëŒ€ê¸°</span>
                                    <span class="font-semibold text-yellow-600">${waiting}ê±´</span>
                                </div>
                            ` : ''}
                            ${onHold > 0 ? `
                                <div class="flex items-center justify-between text-xs">
                                    <span class="text-gray-600">ë³´ë¥˜</span>
                                    <span class="font-semibold text-orange-600">${onHold}ê±´</span>
                                </div>
                            ` : ''}
                        </div>
                        
                        <div class="pt-3 border-t border-gray-300">
                            <div class="flex items-center justify-between mb-1">
                                <span class="text-xs text-gray-600">ì™„ë£Œìœ¨</span>
                                <span class="text-lg font-bold text-${rateColor}-600">${completionRate}%</span>
                            </div>
                            <div class="w-full bg-gray-200 rounded-full h-2">
                                <div class="bg-${rateColor}-500 h-2 rounded-full transition-all" style="width: ${completionRate}%"></div>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // Render Real-time Status
        function renderRealtimeStatus() {
            const container = document.getElementById('realtime-status');
            const statuses = ['ìš”ì²­', 'ì ‘ìˆ˜', 'ì²˜ë¦¬ì¤‘', 'ê²€ìˆ˜ ëŒ€ê¸°', 'ì™„ë£Œ', 'ë³´ë¥˜', 'ë°˜ë ¤'];
            const colors = ['yellow', 'blue', 'indigo', 'purple', 'green', 'orange', 'red'];
            
            container.innerHTML = statuses.map((status, index) => {
                const count = tickets.filter(t => t.status === status).length;
                const percentage = tickets.length > 0 ? Math.round((count / tickets.length) * 100) : 0;
                const color = colors[index];
                
                return `
                    <div>
                        <div class="flex items-center justify-between mb-2">
                            <span class="text-sm font-semibold text-gray-700">${status}</span>
                            <span class="text-sm font-bold text-${color}-600">${count}ê±´ (${percentage}%)</span>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-2.5">
                            <div class="bg-${color}-500 h-2.5 rounded-full transition-all" style="width: ${percentage}%"></div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // Render Monthly Completion (2 months dummy data)
        function renderMonthlyCompletion() {
            const container = document.getElementById('monthly-completion');
            const today = new Date();
            const currentMonth = today.getMonth();
            const currentYear = today.getFullYear();
            
            // Generate 2 months data
            const monthsData = [];
            for (let i = 1; i >= 0; i--) {
                const date = new Date(currentYear, currentMonth - i, 1);
                const monthName = `${date.getFullYear()}ë…„ ${date.getMonth() + 1}ì›”`;
                
                // Calculate dummy stats based on month
                const totalTickets = 15 + Math.floor(Math.random() * 10);
                const completedTickets = Math.floor(totalTickets * (0.7 + Math.random() * 0.25));
                const completionRate = Math.round((completedTickets / totalTickets) * 100);
                
                monthsData.push({
                    month: monthName,
                    total: totalTickets,
                    completed: completedTickets,
                    rate: completionRate
                });
            }
            
            container.innerHTML = monthsData.map(data => {
                const colorClass = data.rate >= 90 ? 'green' : data.rate >= 70 ? 'blue' : 'yellow';
                
                return `
                    <div class="bg-gray-50 rounded-lg p-4">
                        <div class="flex items-center justify-between mb-2">
                            <span class="font-semibold text-gray-700">${data.month}</span>
                            <span class="text-2xl font-bold text-${colorClass}-600">${data.rate}%</span>
                        </div>
                        <div class="text-sm text-gray-600 mb-2">
                            ì™„ë£Œ: ${data.completed}ê±´ / ì „ì²´: ${data.total}ê±´
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-2">
                            <div class="bg-${colorClass}-500 h-2 rounded-full transition-all" style="width: ${data.rate}%"></div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // Render Team Performance (2 months dummy data)
        function renderTeamPerformance() {
            const container = document.getElementById('team-performance');
            const assignees = ['ê¹€ê°œë°œ', 'ì´í”„ë¡ íŠ¸', 'ë°•ë””ìì¸', 'ìµœì¸í”„ë¼', 'ì •ê¸°íš'];
            
            const performanceData = assignees.map(assignee => {
                // Calculate actual current data
                const assignedTickets = tickets.filter(t => t.assignees.includes(assignee));
                const completedTickets = assignedTickets.filter(t => t.status === 'ì™„ë£Œ');
                const inProgressTickets = assignedTickets.filter(t => t.status === 'ì ‘ìˆ˜' || t.status === 'ì²˜ë¦¬ì¤‘');
                
                // Add dummy historical data for realistic numbers
                const totalAssigned = assignedTickets.length + Math.floor(Math.random() * 15) + 10;
                const totalCompleted = completedTickets.length + Math.floor(Math.random() * 12) + 8;
                const totalInProgress = inProgressTickets.length + Math.floor(Math.random() * 5);
                
                const completionRate = totalAssigned > 0 ? Math.round((totalCompleted / totalAssigned) * 100) : 0;
                const avgProcessingTime = Math.floor(Math.random() * 3) + 2; // 2-5 days
                
                return {
                    name: assignee,
                    assigned: totalAssigned,
                    completed: totalCompleted,
                    inProgress: totalInProgress,
                    completionRate: completionRate,
                    avgTime: avgProcessingTime
                };
            });
            
            container.innerHTML = performanceData.map(data => {
                const rateColor = data.completionRate >= 80 ? 'text-green-600' : data.completionRate >= 60 ? 'text-blue-600' : 'text-yellow-600';
                
                return `
                    <tr class="border-b hover:bg-gray-50">
                        <td class="px-4 py-3">
                            <div class="flex items-center">
                                <div class="w-8 h-8 rounded-full bg-gradient-to-br from-blue-400 to-purple-500 flex items-center justify-center text-white text-sm font-semibold mr-3">
                                    ${data.name.charAt(0)}
                                </div>
                                <span class="font-medium text-gray-800">${data.name}</span>
                            </div>
                        </td>
                        <td class="px-4 py-3 text-center font-semibold text-gray-700">${data.assigned}</td>
                        <td class="px-4 py-3 text-center">
                            <span class="bg-green-100 text-green-700 px-3 py-1 rounded-full text-sm font-semibold">${data.completed}</span>
                        </td>
                        <td class="px-4 py-3 text-center">
                            <span class="bg-blue-100 text-blue-700 px-3 py-1 rounded-full text-sm font-semibold">${data.inProgress}</span>
                        </td>
                        <td class="px-4 py-3 text-center">
                            <div class="flex items-center justify-center space-x-2">
                                <span class="text-lg font-bold ${rateColor}">${data.completionRate}%</span>
                            </div>
                        </td>
                        <td class="px-4 py-3 text-center text-gray-600 font-medium">${data.avgTime}ì¼</td>
                    </tr>
                `;
            }).join('');
        }

        // Open Ticket Detail
        function openTicketDetail(ticketId) {
            const ticket = tickets.find(t => t.id === ticketId);
            if (!ticket) return;
            
            document.getElementById('detail-ticket-title').textContent = ticket.title;
            document.getElementById('detail-ticket-number').textContent = ticket.ticketNumber;
            
            const progress = calculateProgress(ticket);
            
            const content = document.getElementById('ticket-detail-content');
            content.innerHTML = `
                <div class="space-y-6">
                    ${(currentRole === 'admin' || currentRole === 'master') ? `
                        <div class="bg-gray-50 border border-gray-200 rounded-lg p-3 mb-4">
                            <div class="flex items-center justify-between">
                                <span class="text-sm font-semibold text-gray-600">
                                    <i class="fas fa-bolt text-yellow-500 mr-2"></i>ë¹ ë¥¸ ë°ëª¨ ì•¡ì…˜
                                </span>
                                <div class="flex items-center space-x-2">
                                    ${ticket.assignees.length === 0 && (ticket.approved || currentRole === 'master') ? `
                                        <button onclick="quickAssignRandom(${ticket.id}); closeModal('ticketDetailModal');" class="text-xs bg-blue-100 text-blue-700 px-3 py-1 rounded hover:bg-blue-200 transition font-semibold">
                                            <i class="fas fa-random mr-1"></i>ëœë¤ ë‹´ë‹¹ì ë°°ì •
                                        </button>
                                    ` : ''}
                                    ${ticket.subtasks.length === 0 && ticket.status !== 'ë°˜ë ¤' && ticket.status !== 'ì™„ë£Œ' && (ticket.approved || currentRole === 'master') ? `
                                        <button onclick="addRandomSubtasks(${ticket.id}); closeModal('ticketDetailModal');" class="text-xs bg-purple-100 text-purple-700 px-3 py-1 rounded hover:bg-purple-200 transition font-semibold">
                                            <i class="fas fa-magic mr-1"></i>í•˜ìœ„ì—…ë¬´ 3ê°œ ìë™ìƒì„±
                                        </button>
                                    ` : ''}
                                </div>
                            </div>
                        </div>
                    ` : ''}
                    
                    ${ticket.status === 'ì ‘ìˆ˜' && ticket.approved === false && currentRole === 'master' ? `
                        <div class="bg-yellow-50 border-2 border-yellow-400 rounded-lg p-4">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center">
                                    <i class="fas fa-exclamation-triangle text-yellow-600 text-2xl mr-3"></i>
                                    <div>
                                        <h4 class="font-bold text-yellow-800">ìŠ¹ì¸ ëŒ€ê¸° ì¤‘</h4>
                                        <p class="text-sm text-yellow-700">ë§ˆìŠ¤í„° ìŠ¹ì¸ì´ í•„ìš”í•œ ìš”ì²­ì…ë‹ˆë‹¤</p>
                                    </div>
                                </div>
                                <button onclick="approveTicket(${ticket.id})" 
                                        class="px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition font-bold shadow-lg">
                                    <i class="fas fa-check-circle mr-2"></i>ìŠ¹ì¸í•˜ê¸°
                                </button>
                            </div>
                        </div>
                    ` : ''}
                    
                    ${ticket.status === 'ì ‘ìˆ˜' && ticket.approved === true ? `
                        <div class="bg-green-50 border border-green-400 rounded-lg p-3">
                            <div class="flex items-center">
                                <i class="fas fa-check-circle text-green-600 text-xl mr-2"></i>
                                <div>
                                    <span class="font-semibold text-green-800">ìŠ¹ì¸ ì™„ë£Œ</span>
                                    <span class="text-sm text-green-700 ml-2">by ${ticket.approvedBy} (${ticket.approvedAt})</span>
                                </div>
                            </div>
                        </div>
                    ` : ''}
                    
                    ${ticket.status === 'ì ‘ìˆ˜' && ticket.approved === false && currentRole === 'admin' ? `
                        <div class="bg-red-50 border border-red-400 rounded-lg p-3">
                            <div class="flex items-center">
                                <i class="fas fa-user-shield text-red-600 text-xl mr-2"></i>
                                <div>
                                    <span class="font-semibold text-red-800">ë§ˆìŠ¤í„° ìŠ¹ì¸ ëŒ€ê¸° ì¤‘</span>
                                    <span class="text-sm text-red-700 ml-2">ìŠ¹ì¸ í›„ ì‘ì—… ê°€ëŠ¥í•©ë‹ˆë‹¤</span>
                                </div>
                            </div>
                        </div>
                    ` : ''}
                    
                    <div class="flex items-center gap-3">
                        <span class="status-badge status-${ticket.status}">${ticket.status}</span>
                        <span class="text-sm">
                            <i class="fas fa-flag priority-${ticket.priority === 'ë†’ìŒ' ? 'high' : ticket.priority === 'ë³´í†µ' ? 'medium' : 'low'} mr-1"></i>
                            <strong>${ticket.priority}</strong> ìš°ì„ ìˆœìœ„
                        </span>
                    </div>

                    ${ticket.status === 'ë°˜ë ¤' && ticket.rejectReason ? `
                        <div class="bg-red-50 border border-red-200 rounded-lg p-4">
                            <div class="flex items-start">
                                <i class="fas fa-exclamation-circle text-red-600 mt-1 mr-3"></i>
                                <div>
                                    <h4 class="font-semibold text-red-800 mb-1">ë°˜ë ¤ ì‚¬ìœ </h4>
                                    <p class="text-red-700 text-sm">${ticket.rejectReason}</p>
                                </div>
                            </div>
                        </div>
                    ` : ''}
                    
                    ${(ticket.status === 'ê²€ìˆ˜ ëŒ€ê¸°' || ticket.status === 'ì™„ë£Œ') && ticket.completionComment ? `
                        <div class="bg-gradient-to-r from-green-50 to-blue-50 border-2 border-green-300 rounded-lg p-5">
                            <div class="flex items-start mb-4">
                                <div class="w-12 h-12 rounded-full bg-green-500 flex items-center justify-center text-white mr-4">
                                    <i class="fas fa-check-circle text-2xl"></i>
                                </div>
                                <div class="flex-1">
                                    <h4 class="font-bold text-gray-800 text-lg mb-1">
                                        ${ticket.status === 'ì™„ë£Œ' ? 'âœ… ìµœì¢… ì™„ë£Œ' : 'ğŸ” ì‘ì—… ì™„ë£Œ - ê²€ìˆ˜ ìš”ì²­'}
                                    </h4>
                                    <p class="text-sm text-gray-600">
                                        <i class="fas fa-user mr-1"></i>${ticket.completedBy || 'ITíŒ€'} Â· 
                                        <i class="fas fa-clock mr-1"></i>${ticket.completedAt}
                                    </p>
                                </div>
                            </div>
                            
                            <div class="bg-white rounded-lg p-4 mb-3">
                                <h5 class="font-semibold text-gray-700 mb-2">
                                    <i class="fas fa-comment-dots text-green-500 mr-2"></i>ì™„ë£Œ ë‚´ìš©
                                </h5>
                                <div class="text-gray-700 whitespace-pre-line">${ticket.completionComment}</div>
                            </div>
                            
                            ${ticket.completionLinks && ticket.completionLinks.length > 0 ? `
                                <div class="bg-white rounded-lg p-4">
                                    <h5 class="font-semibold text-gray-700 mb-2">
                                        <i class="fas fa-link text-blue-500 mr-2"></i>ì°¸ê³  ë§í¬
                                    </h5>
                                    <div class="space-y-2">
                                        ${ticket.completionLinks.map(link => `
                                            <a href="${link}" target="_blank" class="block text-blue-600 hover:text-blue-700 hover:underline text-sm">
                                                <i class="fas fa-external-link-alt mr-1"></i>${link}
                                            </a>
                                        `).join('')}
                                    </div>
                                </div>
                            ` : ''}
                        </div>
                    ` : ''}

                    <div class="bg-gray-50 rounded-lg p-4">
                        <h4 class="font-semibold text-gray-700 mb-2">ìš”ì²­ ë‚´ìš©</h4>
                        <p class="text-gray-600">${ticket.description}</p>
                    </div>

                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <h4 class="font-semibold text-gray-700 mb-2">ìš”ì²­ì</h4>
                            <p class="text-gray-600"><i class="fas fa-user mr-2"></i>${ticket.requester} (${ticket.department})</p>
                        </div>
                        <div>
                            <h4 class="font-semibold text-gray-700 mb-2">ì¹´í…Œê³ ë¦¬</h4>
                            <div class="text-gray-600">
                                <i class="fas fa-tag mr-2"></i>
                                <span class="font-semibold text-blue-600">${ticket.categoryMain || ticket.category || 'ë¯¸ë¶„ë¥˜'}</span>
                                ${ticket.categoryMiddle ? `
                                    <span class="mx-1">â€º</span>
                                    <span class="text-gray-700">${ticket.categoryMiddle}</span>
                                ` : ''}
                                ${ticket.categorySub ? `
                                    <span class="mx-1">â€º</span>
                                    <span class="text-gray-600">${ticket.categorySub}</span>
                                ` : ''}
                            </div>
                        </div>
                    </div>

                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <h4 class="font-semibold text-gray-700 mb-2">ë‹´ë‹¹ì</h4>
                            ${ticket.assignees.length > 0 ? `
                                <p class="text-gray-600"><i class="fas fa-users mr-2"></i>${ticket.assignees.join(', ')}</p>
                            ` : `
                                <p class="text-yellow-600"><i class="fas fa-exclamation-circle mr-2"></i>ë¯¸ë°°ì •</p>
                                ${currentRole === 'admin' ? `
                                    <button onclick="openAssignModal(${ticket.id}); closeModal('ticketDetailModal');" class="mt-2 text-sm text-blue-600 hover:text-blue-700 font-semibold">
                                        <i class="fas fa-plus mr-1"></i>ë‹´ë‹¹ì ë°°ì •í•˜ê¸°
                                    </button>
                                ` : ''}
                            `}
                        </div>
                    </div>

                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <h4 class="font-semibold text-gray-700 mb-2">ìš”ì²­ì¼</h4>
                            <p class="text-gray-600"><i class="fas fa-calendar mr-2"></i>${ticket.createdAt}</p>
                        </div>
                        <div>
                            <h4 class="font-semibold text-gray-700 mb-2">í¬ë§ ì™„ë£Œì¼</h4>
                            <p class="text-gray-600"><i class="fas fa-calendar-check mr-2"></i>${ticket.dueDate || 'ë¯¸ì •'}</p>
                        </div>
                    </div>

                    <div>
                        <h4 class="font-semibold text-gray-700 mb-2">ì§„í–‰ë¥ </h4>
                        <div class="flex items-center space-x-3">
                            <div class="flex-1 bg-gray-200 rounded-full h-3">
                                <div class="bg-gradient-to-r from-blue-500 to-purple-500 h-3 rounded-full transition-all" style="width: ${progress}%"></div>
                            </div>
                            <span class="text-lg font-bold text-gray-700">${progress}%</span>
                        </div>
                    </div>

                    <!-- Linked Tickets Section -->
                    <div class="bg-gradient-to-r from-blue-50 to-purple-50 border border-blue-200 rounded-lg p-4">
                        <div class="flex items-center justify-between mb-3">
                            <h4 class="font-semibold text-gray-700">
                                <i class="fas fa-link mr-2 text-blue-600"></i>ì—°ê²°ëœ í‹°ì¼“ (${ticket.linkedTickets ? ticket.linkedTickets.length : 0}ê°œ)
                            </h4>
                            ${currentRole === 'admin' ? `
                                <button onclick="openLinkTicketModal(${ticket.id})" class="text-sm bg-blue-600 text-white px-3 py-1 rounded-lg hover:bg-blue-700 transition font-semibold">
                                    <i class="fas fa-plus mr-1"></i>í‹°ì¼“ ì—°ê²°
                                </button>
                            ` : ''}
                        </div>
                        ${ticket.linkedTickets && ticket.linkedTickets.length > 0 ? `
                            <div class="space-y-2">
                                ${ticket.linkedTickets.map(linkedId => {
                                    const linkedTicket = tickets.find(t => t.id === linkedId);
                                    if (!linkedTicket) return '';
                                    return `
                                        <div class="bg-white rounded-lg p-3 flex items-center justify-between hover:shadow-md transition">
                                            <div class="flex-1" onclick="openTicketDetail(${linkedTicket.id})" style="cursor: pointer;">
                                                <div class="flex items-center gap-2 mb-1">
                                                    <span class="font-mono text-xs text-blue-600 font-semibold">${linkedTicket.ticketNumber}</span>
                                                    <span class="status-badge status-${linkedTicket.status}">${linkedTicket.status}</span>
                                                </div>
                                                <p class="text-sm font-medium text-gray-800">${linkedTicket.title}</p>
                                                <p class="text-xs text-gray-500 mt-1">
                                                    <i class="fas fa-tag mr-1"></i>${linkedTicket.category || 'ë¯¸ë¶„ë¥˜'}
                                                </p>
                                            </div>
                                            ${currentRole === 'admin' ? `
                                                <button onclick="event.stopPropagation(); unlinkTicket(${ticket.id}, ${linkedId})" class="text-red-500 hover:text-red-700 ml-2">
                                                    <i class="fas fa-unlink"></i>
                                                </button>
                                            ` : ''}
                                        </div>
                                    `;
                                }).join('')}
                            </div>
                        ` : `
                            <p class="text-sm text-gray-500 italic">ì—°ê²°ëœ í‹°ì¼“ì´ ì—†ìŠµë‹ˆë‹¤</p>
                        `}
                    </div>

                    ${ticket.subtasks.length > 0 ? `
                        <div>
                            <div class="flex items-center justify-between mb-3">
                                <h4 class="font-semibold text-gray-700">í•˜ìœ„ ì—…ë¬´ (${ticket.subtasks.length}ê°œ)</h4>
                            </div>
                            <div class="space-y-2">
                                ${ticket.subtasks.map(sub => `
                                    <div class="bg-gray-50 rounded-lg p-4">
                                        <div class="flex items-start justify-between">
                                            <div class="flex-1">
                                                <h5 class="font-semibold text-gray-800 mb-1">${sub.title}</h5>
                                                ${sub.description ? `<p class="text-sm text-gray-600 mb-2">${sub.description}</p>` : ''}
                                                <div class="flex items-center gap-3 text-sm text-gray-500">
                                                    <span><i class="fas fa-user"></i> ${sub.assignee}</span>
                                                    ${sub.startDate ? `<span><i class="fas fa-calendar"></i> ${sub.startDate} ~ ${sub.endDate}</span>` : ''}
                                                </div>
                                            </div>
                                            ${(currentRole === 'admin' || currentRole === 'master') ? `
                                                <div class="ml-4">
                                                    <select onchange="updateSubtaskStatus(${ticket.id}, '${sub.id}', this.value)" 
                                                            class="text-sm border border-gray-300 rounded-lg px-3 py-1.5 focus:ring-2 focus:ring-blue-500">
                                                        <option value="ëŒ€ê¸°" ${sub.status === 'ëŒ€ê¸°' ? 'selected' : ''}>ëŒ€ê¸°</option>
                                                        <option value="ì§„í–‰ì¤‘" ${sub.status === 'ì§„í–‰ì¤‘' ? 'selected' : ''}>ì§„í–‰ì¤‘</option>
                                                        <option value="ì™„ë£Œ" ${sub.status === 'ì™„ë£Œ' ? 'selected' : ''}>ì™„ë£Œ</option>
                                                        <option value="ë³´ë¥˜" ${sub.status === 'ë³´ë¥˜' ? 'selected' : ''}>ë³´ë¥˜</option>
                                                    </select>
                                                </div>
                                            ` : `
                                                <span class="status-badge status-${sub.status} ml-4">${sub.status}</span>
                                            `}
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    ` : ''}
                    
                    ${(currentRole === 'admin' || currentRole === 'master') && ticket.subtasks.length > 0 ? (() => {
                        const { totalCost, costBreakdown } = calculateTicketCost(ticket);
                        return totalCost > 0 ? `
                            <details class="bg-gray-50 border border-gray-300 rounded-lg overflow-hidden">
                                <summary class="cursor-pointer px-4 py-3 hover:bg-gray-100 transition flex items-center justify-between">
                                    <span class="font-semibold text-gray-700">
                                        <i class="fas fa-coins text-yellow-500 mr-2"></i>
                                        ì˜ˆìƒ ë¹„ìš© ì‚°ì¶œ (ì°¸ê³ ìš©)
                                    </span>
                                    <div class="flex items-center space-x-2">
                                        <span class="text-lg font-bold text-blue-600">â‚©${totalCost.toLocaleString()}</span>
                                        <i class="fas fa-chevron-down text-gray-400"></i>
                                    </div>
                                </summary>
                                <div class="px-4 pb-4 pt-2 border-t border-gray-200 bg-white">
                                    <p class="text-xs text-gray-500 mb-3">
                                        <i class="fas fa-info-circle mr-1"></i>
                                        ì‹¤ë¬´ì íˆ¬ì… ì‹œê°„ ê¸°ë°˜ ëŒ€ëµì  ë¹„ìš© ì‚°ì¶œì…ë‹ˆë‹¤. ì‹¤ì œ ì²­êµ¬ ê¸ˆì•¡ê³¼ ë‹¤ë¥¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                                    </p>
                                    <div class="space-y-2">
                                        ${costBreakdown.map(item => `
                                            <div class="flex justify-between items-center text-sm">
                                                <div class="flex-1">
                                                    <span class="font-semibold text-gray-700">${item.assignee}</span>
                                                    <span class="text-gray-500 ml-2">${item.hours}ì‹œê°„</span>
                                                </div>
                                                <div class="text-right">
                                                    <span class="text-gray-600">â‚©${item.rate.toLocaleString()}/h</span>
                                                    <span class="ml-2 font-semibold text-blue-600">â‚©${item.cost.toLocaleString()}</span>
                                                </div>
                                            </div>
                                        `).join('')}
                                    </div>
                                </div>
                            </details>
                        ` : '';
                    })() : ''}
                    
                    <!-- ê²¬ì ì„œ ë³´ê¸° ë²„íŠ¼ -->
                    ${ticket.subtasks.length > 0 && (currentUser.role === 'admin' || currentUser.role === 'master' || ticket.requester === currentUser.name) ? `
                        <div class="bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-300 rounded-lg p-4">
                            <div class="flex items-center justify-between">
                                <div>
                                    <h4 class="font-semibold text-gray-800 mb-1">
                                        <i class="fas fa-file-invoice-dollar text-blue-600 mr-2"></i>ê³µì‹ ê²¬ì ì„œ
                                    </h4>
                                    <p class="text-xs text-gray-600">
                                        ë§¨ë°ì´/ë§¨ë¨¼ìŠ¤ ê¸°ì¤€ ê³µì‹ ê²¬ì ì„œë¥¼ í™•ì¸í•˜ê³  ì¶œë ¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤
                                    </p>
                                </div>
                                <button onclick="openQuotationModal(${ticket.id})" 
                                        class="px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition font-semibold shadow-lg">
                                    <i class="fas fa-file-contract mr-2"></i>ê²¬ì ì„œ ë³´ê¸°
                                </button>
                            </div>
                        </div>
                    ` : ''}

                    <!-- ê²¬ì  í™•ì¸ ì„¹ì…˜ -->
                    ${ticket.status === 'ê²¬ì í™•ì¸' && ticket.estimate && !ticket.ticketType && (currentUser.role === 'master' || ticket.requester === currentUser.name) ? `
                        <div class="bg-gradient-to-r from-cyan-50 to-blue-50 border border-cyan-300 rounded-lg p-6">
                            <h4 class="font-bold text-gray-800 text-lg mb-4 flex items-center">
                                <i class="fas fa-file-invoice-dollar text-cyan-600 mr-2"></i>ê²¬ì ì„œ í™•ì¸
                            </h4>
                            
                            <!-- ê²¬ì  ë‚´ì—­ -->
                            <div class="bg-white rounded-lg p-4 mb-4 border border-gray-200">
                                <div class="text-sm font-semibold text-gray-700 mb-3">ğŸ“Š ê²¬ì  ë‚´ì—­</div>
                                <table class="w-full text-sm">
                                    <thead class="bg-gray-50">
                                        <tr>
                                            <th class="text-left py-2 px-3 text-gray-600">ë“±ê¸‰</th>
                                            <th class="text-right py-2 px-3 text-gray-600">ë§¨ë°ì´</th>
                                            <th class="text-right py-2 px-3 text-gray-600">ì¼ê¸‰</th>
                                            <th class="text-right py-2 px-3 text-gray-600">ë¹„ìš©</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        ${ticket.estimate.items.map(item => `
                                            <tr class="border-t">
                                                <td class="py-2 px-3 font-semibold">${item.grade}</td>
                                                <td class="text-right py-2 px-3">${item.manDays} MD</td>
                                                <td class="text-right py-2 px-3">â‚©${item.dailyRate.toLocaleString()}</td>
                                                <td class="text-right py-2 px-3 font-semibold">â‚©${item.cost.toLocaleString()}</td>
                                            </tr>
                                        `).join('')}
                                        <tr class="border-t-2 border-gray-300 font-bold">
                                            <td class="py-2 px-3">í•©ê³„</td>
                                            <td class="text-right py-2 px-3">${ticket.estimate.totalManDays} MD</td>
                                            <td class="text-right py-2 px-3"></td>
                                            <td class="text-right py-2 px-3 text-blue-600">â‚©${ticket.estimate.totalCost.toLocaleString()}</td>
                                        </tr>
                                    </tbody>
                                </table>
                                
                                <div class="mt-3 pt-3 border-t text-sm text-gray-600">
                                    <div class="flex justify-between mb-1">
                                        <span>ğŸ“… ì˜ˆìƒ ê¸°ê°„:</span>
                                        <span class="font-semibold">${ticket.estimate.estimatedDays}ì¼</span>
                                    </div>
                                    ${ticket.estimate.note ? `
                                        <div class="mt-2 p-2 bg-gray-50 rounded">
                                            <div class="text-xs text-gray-500 mb-1">ê²¬ì  ê·¼ê±°:</div>
                                            <div class="text-xs text-gray-700">${ticket.estimate.note}</div>
                                        </div>
                                    ` : ''}
                                </div>
                            </div>
                            
                            <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-3 mb-4">
                                <p class="text-sm text-yellow-800">
                                    <i class="fas fa-info-circle mr-2"></i>
                                    <strong>ì•ˆë‚´:</strong> ê²¬ì  ë‚´ìš©ì„ í™•ì¸í•˜ì‹œê³  ì§„í–‰ ì—¬ë¶€ë¥¼ ê²°ì •í•´ì£¼ì„¸ìš”.
                                </p>
                            </div>
                            
                            <div class="grid grid-cols-3 gap-3">
                                <button onclick="confirmEstimate(${ticket.id})" 
                                    class="px-4 py-3 bg-gradient-to-r from-green-600 to-blue-600 text-white rounded-lg hover:from-green-700 hover:to-blue-700 transition font-semibold shadow-md">
                                    <i class="fas fa-check mr-2"></i>ì§„í–‰í•˜ê¸°
                                </button>
                                <button onclick="requestAdjustment(${ticket.id})" 
                                    class="px-4 py-3 border-2 border-orange-400 text-orange-600 rounded-lg hover:bg-orange-50 transition font-semibold">
                                    <i class="fas fa-exchange-alt mr-2"></i>ì¡°ì • ìš”ì²­
                                </button>
                                <button onclick="cancelAfterEstimate(${ticket.id})" 
                                    class="px-4 py-3 border-2 border-red-400 text-red-600 rounded-lg hover:bg-red-50 transition font-semibold">
                                    <i class="fas fa-times mr-2"></i>ì·¨ì†Œí•˜ê¸°
                                </button>
                            </div>
                        </div>
                    ` : ''}

                    <!-- ê²€ìˆ˜ ëŒ€ê¸° / ì™„ë£Œ í™•ì¸ ì„¹ì…˜ -->
                    ${ticket.status === 'ê²€ìˆ˜ ëŒ€ê¸°' && (currentUser.role === 'master' || ticket.requester === currentUser.name) ? `
                        <div class="bg-gradient-to-r from-green-50 to-blue-50 border-2 border-green-300 rounded-lg p-5">
                            <h5 class="font-semibold text-gray-700 mb-3 text-lg">
                                <i class="fas fa-clipboard-check text-green-600 mr-2"></i>ì‘ì—… ê²°ê³¼ ìµœì¢… í™•ì¸
                            </h5>
                            
                            <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4">
                                <p class="text-sm text-blue-800">
                                    <i class="fas fa-info-circle mr-2"></i>
                                    <strong>ìµœì¢… í™•ì¸ ì•ˆë‚´</strong>
                                </p>
                                <p class="text-xs text-blue-700 mt-2">
                                    â€¢ ì‘ì—… ê²°ê³¼ë¬¼ì„ í™•ì¸í•˜ì‹  í›„ <strong>ìµœì¢… í™•ì¸ ë²„íŠ¼</strong>ì„ í´ë¦­í•´ì£¼ì„¸ìš”<br>
                                    â€¢ <strong>ìµœì¢… í™•ì¸ ì‹œì </strong>ì´ ë¹„ìš© ì§‘í–‰ì˜ ê·¼ê±°ê°€ ë©ë‹ˆë‹¤<br>
                                    â€¢ ë§Œì¡±ë„ í‰ê°€ëŠ” ì„ íƒì‚¬í•­ì´ë©°, ì—…ë¬´ í’ˆì§ˆ ê°œì„ ì— ì°¸ê³ ë©ë‹ˆë‹¤<br>
                                    â€¢ ì‘ì—… ë‚´ìš©ì´ ë¯¸í¡í•œ ê²½ìš° ì¬ê²€ìˆ˜ë¥¼ ìš”ì²­í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤
                                </p>
                            </div>
                            
                            <div class="space-y-4">
                                <!-- ìµœì¢… í™•ì¸ ë²„íŠ¼ (ë©”ì¸) -->
                                <button onclick="approveCompletion(${ticket.id})" 
                                        class="w-full px-6 py-4 bg-green-600 text-white rounded-lg hover:bg-green-700 transition font-bold text-lg shadow-lg">
                                    <i class="fas fa-check-circle mr-2"></i>ìµœì¢… í™•ì¸ ì™„ë£Œ (ë¹„ìš© ì§‘í–‰ ìŠ¹ì¸)
                                </button>
                                
                                <!-- ë§Œì¡±ë„ í‰ê°€ (ì²´í¬ë¦¬ìŠ¤íŠ¸) -->
                                <details class="bg-gray-50 rounded-lg border border-gray-200">
                                    <summary class="cursor-pointer px-4 py-3 font-semibold text-gray-700 hover:bg-gray-100 transition">
                                        <i class="fas fa-clipboard-check text-blue-500 mr-2"></i>ì—…ë¬´ í’ˆì§ˆ í‰ê°€ (ì„ íƒì‚¬í•­)
                                    </summary>
                                    <div class="px-4 py-4 border-t border-gray-200">
                                        <p class="text-xs text-gray-600 mb-4">
                                            <i class="fas fa-info-circle text-blue-500 mr-1"></i>
                                            ê° í•­ëª©ì„ 1-3ì ìœ¼ë¡œ í‰ê°€í•´ì£¼ì„¸ìš”. (ì´ 12ì  ë§Œì )
                                        </p>
                                        
                                        <!-- í‰ê°€ í•­ëª© 1: ì†Œìš”ì‹œê°„ ì¤€ìˆ˜ -->
                                        <div class="bg-white rounded-lg p-3 mb-3 border border-gray-200">
                                            <div class="flex items-center justify-between mb-2">
                                                <label class="text-sm font-semibold text-gray-700">
                                                    <i class="fas fa-clock text-blue-500 mr-2"></i>1. ì†Œìš”ì‹œê°„ ì¤€ìˆ˜
                                                </label>
                                                <div class="flex space-x-2">
                                                    ${[1,2,3].map(score => `
                                                        <button type="button" onclick="selectScore(${ticket.id}, 'time', ${score})" 
                                                            id="score-time-${score}-${ticket.id}"
                                                            class="w-10 h-10 rounded-lg border-2 border-gray-300 hover:border-blue-500 transition font-semibold
                                                            ${score === 2 ? 'text-yellow-600' : score === 3 ? 'text-green-600' : 'text-red-600'}">
                                                            ${score}
                                                        </button>
                                                    `).join('')}
                                                </div>
                                            </div>
                                            <p class="text-xs text-gray-500">ì˜ˆì •ëœ ì¼ì • ë‚´ì— ì™„ë£Œë˜ì—ˆëŠ”ì§€ í‰ê°€</p>
                                        </div>
                                        
                                        <!-- í‰ê°€ í•­ëª© 2: ì™„ì„±ë„ -->
                                        <div class="bg-white rounded-lg p-3 mb-3 border border-gray-200">
                                            <div class="flex items-center justify-between mb-2">
                                                <label class="text-sm font-semibold text-gray-700">
                                                    <i class="fas fa-check-double text-green-500 mr-2"></i>2. ì‘ì—… ì™„ì„±ë„
                                                </label>
                                                <div class="flex space-x-2">
                                                    ${[1,2,3].map(score => `
                                                        <button type="button" onclick="selectScore(${ticket.id}, 'quality', ${score})" 
                                                            id="score-quality-${score}-${ticket.id}"
                                                            class="w-10 h-10 rounded-lg border-2 border-gray-300 hover:border-blue-500 transition font-semibold
                                                            ${score === 2 ? 'text-yellow-600' : score === 3 ? 'text-green-600' : 'text-red-600'}">
                                                            ${score}
                                                        </button>
                                                    `).join('')}
                                                </div>
                                            </div>
                                            <p class="text-xs text-gray-500">ìš”êµ¬ì‚¬í•­ì´ ì¶©ì‹¤íˆ ë°˜ì˜ë˜ì—ˆëŠ”ì§€ í‰ê°€</p>
                                        </div>
                                        
                                        <!-- í‰ê°€ í•­ëª© 3: ì»¤ë®¤ë‹ˆì¼€ì´ì…˜ -->
                                        <div class="bg-white rounded-lg p-3 mb-3 border border-gray-200">
                                            <div class="flex items-center justify-between mb-2">
                                                <label class="text-sm font-semibold text-gray-700">
                                                    <i class="fas fa-comments text-purple-500 mr-2"></i>3. ì»¤ë®¤ë‹ˆì¼€ì´ì…˜
                                                </label>
                                                <div class="flex space-x-2">
                                                    ${[1,2,3].map(score => `
                                                        <button type="button" onclick="selectScore(${ticket.id}, 'communication', ${score})" 
                                                            id="score-communication-${score}-${ticket.id}"
                                                            class="w-10 h-10 rounded-lg border-2 border-gray-300 hover:border-blue-500 transition font-semibold
                                                            ${score === 2 ? 'text-yellow-600' : score === 3 ? 'text-green-600' : 'text-red-600'}">
                                                            ${score}
                                                        </button>
                                                    `).join('')}
                                                </div>
                                            </div>
                                            <p class="text-xs text-gray-500">ì§„í–‰ ìƒí™© ê³µìœ  ë° ì‘ëŒ€ê°€ ì›í™œí–ˆëŠ”ì§€ í‰ê°€</p>
                                        </div>
                                        
                                        <!-- í‰ê°€ í•­ëª© 4: ì „ë¬¸ì„± -->
                                        <div class="bg-white rounded-lg p-3 mb-3 border border-gray-200">
                                            <div class="flex items-center justify-between mb-2">
                                                <label class="text-sm font-semibold text-gray-700">
                                                    <i class="fas fa-star text-yellow-500 mr-2"></i>4. ê¸°ìˆ  ì „ë¬¸ì„±
                                                </label>
                                                <div class="flex space-x-2">
                                                    ${[1,2,3].map(score => `
                                                        <button type="button" onclick="selectScore(${ticket.id}, 'expertise', ${score})" 
                                                            id="score-expertise-${score}-${ticket.id}"
                                                            class="w-10 h-10 rounded-lg border-2 border-gray-300 hover:border-blue-500 transition font-semibold
                                                            ${score === 2 ? 'text-yellow-600' : score === 3 ? 'text-green-600' : 'text-red-600'}">
                                                            ${score}
                                                        </button>
                                                    `).join('')}
                                                </div>
                                            </div>
                                            <p class="text-xs text-gray-500">ê¸°ìˆ ì  í•´ê²° ëŠ¥ë ¥ ë° í’ˆì§ˆì´ ìš°ìˆ˜í–ˆëŠ”ì§€ í‰ê°€</p>
                                        </div>
                                        
                                        <!-- ì´ì  í‘œì‹œ -->
                                        <div class="bg-blue-50 border border-blue-200 rounded-lg p-3 mt-4">
                                            <div class="flex items-center justify-between">
                                                <span class="text-sm font-semibold text-gray-700">ì´ì </span>
                                                <span class="text-xl font-bold text-blue-600" id="total-score-${ticket.id}">0 / 12ì </span>
                                            </div>
                                        </div>
                                        
                                        <!-- í‰ê°€ ì ìˆ˜ ì €ì¥ìš© hidden inputs -->
                                        <input type="hidden" id="evaluation-time-${ticket.id}" value="0">
                                        <input type="hidden" id="evaluation-quality-${ticket.id}" value="0">
                                        <input type="hidden" id="evaluation-communication-${ticket.id}" value="0">
                                        <input type="hidden" id="evaluation-expertise-${ticket.id}" value="0">
                                        
                                        <label class="block text-sm font-semibold text-gray-600 mb-2 mt-4">ì˜ê²¬ (ì„ íƒ)</label>
                                        <textarea id="userFeedback-${ticket.id}" rows="2" placeholder="ê°œì„  ì˜ê²¬ì´ë‚˜ í”¼ë“œë°±ì„ ë‚¨ê²¨ì£¼ì„¸ìš” (ì„ íƒì‚¬í•­)"
                                            class="w-full border border-gray-300 rounded-lg px-3 py-2 text-sm"></textarea>
                                    </div>
                                </details>
                                
                                <!-- ì¬ê²€ìˆ˜ ìš”ì²­ -->
                                <button onclick="requestRework(${ticket.id})" 
                                        class="w-full px-5 py-3 border-2 border-orange-400 text-orange-600 rounded-lg hover:bg-orange-50 transition font-semibold">
                                    <i class="fas fa-redo mr-2"></i>ì¬ê²€ìˆ˜ ìš”ì²­ (ì‘ì—… ë¯¸í¡)
                                </button>
                            </div>
                        </div>
                    ` : ''}
                    
                    ${ticket.status === 'ì™„ë£Œ' && ticket.userApprovedAt ? `
                        <div class="bg-green-50 border border-green-200 rounded-lg p-4">
                            <div class="flex items-center justify-between mb-3">
                                <span class="font-bold text-green-800 text-lg">
                                    <i class="fas fa-check-double text-green-600 mr-2"></i>ìµœì¢… í™•ì¸ ì™„ë£Œ
                                </span>
                                ${ticket.evaluationScore ? `
                                    <div class="text-right">
                                        <span class="text-2xl font-bold text-blue-600">${ticket.evaluationScore.total}</span>
                                        <span class="text-sm text-gray-600">/12ì </span>
                                    </div>
                                ` : ''}
                            </div>
                            
                            ${ticket.evaluationScore ? `
                                <div class="bg-white rounded-lg p-3 mb-3 border border-green-200">
                                    <div class="text-xs font-semibold text-gray-700 mb-2">
                                        <i class="fas fa-clipboard-check text-blue-500 mr-1"></i>í’ˆì§ˆ í‰ê°€
                                    </div>
                                    <div class="grid grid-cols-2 gap-2 text-xs">
                                        <div class="flex items-center justify-between">
                                            <span class="text-gray-600">ì†Œìš”ì‹œê°„ ì¤€ìˆ˜:</span>
                                            <span class="font-semibold ${ticket.evaluationScore.time === 3 ? 'text-green-600' : ticket.evaluationScore.time === 2 ? 'text-yellow-600' : 'text-red-600'}">
                                                ${ticket.evaluationScore.time}/3ì 
                                            </span>
                                        </div>
                                        <div class="flex items-center justify-between">
                                            <span class="text-gray-600">ì‘ì—… ì™„ì„±ë„:</span>
                                            <span class="font-semibold ${ticket.evaluationScore.quality === 3 ? 'text-green-600' : ticket.evaluationScore.quality === 2 ? 'text-yellow-600' : 'text-red-600'}">
                                                ${ticket.evaluationScore.quality}/3ì 
                                            </span>
                                        </div>
                                        <div class="flex items-center justify-between">
                                            <span class="text-gray-600">ì»¤ë®¤ë‹ˆì¼€ì´ì…˜:</span>
                                            <span class="font-semibold ${ticket.evaluationScore.communication === 3 ? 'text-green-600' : ticket.evaluationScore.communication === 2 ? 'text-yellow-600' : 'text-red-600'}">
                                                ${ticket.evaluationScore.communication}/3ì 
                                            </span>
                                        </div>
                                        <div class="flex items-center justify-between">
                                            <span class="text-gray-600">ê¸°ìˆ  ì „ë¬¸ì„±:</span>
                                            <span class="font-semibold ${ticket.evaluationScore.expertise === 3 ? 'text-green-600' : ticket.evaluationScore.expertise === 2 ? 'text-yellow-600' : 'text-red-600'}">
                                                ${ticket.evaluationScore.expertise}/3ì 
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            ` : ''}
                            
                            <div class="space-y-2 text-sm">
                                <p class="text-green-700">
                                    <i class="fas fa-user mr-2"></i>
                                    <strong>í™•ì¸ì:</strong> ${ticket.userApprovedBy || ticket.requester}
                                </p>
                                <p class="text-green-700">
                                    <i class="fas fa-clock mr-2"></i>
                                    <strong>í™•ì¸ ì‹œê°„:</strong> ${ticket.userApprovedAt}
                                </p>
                            </div>
                            <div class="mt-3 pt-3 border-t border-green-300">
                                <p class="text-xs text-green-800 font-semibold">
                                    <i class="fas fa-money-check-alt mr-1"></i>
                                    ë³¸ í™•ì¸ ì‹œì ì„ ê·¼ê±°ë¡œ ë¹„ìš©ì´ ì§‘í–‰ë©ë‹ˆë‹¤
                                </p>
                            </div>
                            ${(currentUser.role === 'master' || ticket.requester === currentUser.name) ? `
                                <div class="mt-3 bg-orange-50 border border-orange-200 rounded-lg p-3">
                                    <p class="text-xs text-orange-800 mb-2">
                                        <i class="fas fa-info-circle mr-1"></i>
                                        <strong>ì¶”ê°€ ìˆ˜ì •ì´ í•„ìš”í•œ ê²½ìš°</strong>
                                    </p>
                                    <button onclick="requestRework(${ticket.id})" 
                                            class="w-full px-4 py-2 border-2 border-orange-400 text-orange-600 rounded-lg hover:bg-orange-50 transition font-semibold text-sm">
                                        <i class="fas fa-redo mr-2"></i>ì¬ê²€ìˆ˜ ìš”ì²­ (ì¬ê²€ìˆ˜ì¤‘ìœ¼ë¡œ ë³€ê²½)
                                    </button>
                                    <p class="text-xs text-orange-600 mt-2">
                                        ì¬ê²€ìˆ˜ ìš”ì²­ ì‹œ í‹°ì¼“ì´ ì¬ê²€ìˆ˜ì¤‘ ìƒíƒœë¡œ ë³€ê²½ë˜ë©°, ì‚¬ìœ ê°€ ê¸°ë¡ë©ë‹ˆë‹¤
                                    </p>
                                </div>
                            ` : ''}
                        </div>
                    ` : ''}
                    
                    ${ticket.status === 'ì™„ë£Œ' && !ticket.userApprovedAt ? `
                        <div class="bg-yellow-50 border border-yellow-300 rounded-lg p-4">
                            <p class="text-sm text-yellow-800 mb-2 font-semibold flex items-center">
                                <i class="fas fa-exclamation-triangle mr-2"></i>
                                âš ï¸ ìµœì¢… í™•ì¸ ì ˆì°¨ ì—†ì´ ì™„ë£Œë¨
                            </p>
                            <p class="text-xs text-yellow-700 mb-3">
                                ì´ í‹°ì¼“ì€ ì‚¬ìš©ì ìµœì¢… í™•ì¸ ì ˆì°¨ ì—†ì´ ì™„ë£Œ ì²˜ë¦¬ë˜ì—ˆìŠµë‹ˆë‹¤.<br>
                                ì •í™•í•œ ë¹„ìš© ì§‘í–‰ ê·¼ê±°ë¥¼ ìœ„í•´ ì¬ê²€ìˆ˜ë¥¼ ìš”ì²­í•˜ì—¬ ì •ìƒ í™•ì¸ ì ˆì°¨ë¥¼ ê±°ì¹˜ëŠ” ê²ƒì„ ê¶Œì¥í•©ë‹ˆë‹¤.
                            </p>
                            ${(currentUser.role === 'master' || ticket.requester === currentUser.name) ? `
                                <button onclick="requestRework(${ticket.id})" 
                                        class="w-full px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 transition font-semibold">
                                    <i class="fas fa-redo mr-2"></i>ì¬ê²€ìˆ˜ ìš”ì²­ (ì •ìƒ í™•ì¸ ì ˆì°¨ ì§„í–‰)
                                </button>
                            ` : ''}
                        </div>
                    ` : ''}

                    <!-- Comments Section -->
                    <div class="bg-gradient-to-r from-green-50 to-teal-50 border border-green-200 rounded-lg p-4">
                        <div class="flex items-center justify-between mb-3">
                            <h4 class="font-semibold text-gray-700">
                                <i class="fas fa-comments mr-2 text-green-600"></i>ì½”ë©˜íŠ¸ (${ticket.comments ? ticket.comments.length : 0}ê°œ)
                            </h4>
                        </div>
                        
                        <!-- Comment Input -->
                        <div class="mb-4">
                            <textarea id="comment-input-${ticket.id}" 
                                      placeholder="ì½”ë©˜íŠ¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”..." 
                                      class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-green-500 resize-none" 
                                      rows="3"></textarea>
                            <div class="flex justify-end mt-2">
                                <button onclick="addComment(${ticket.id})" 
                                        class="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition font-semibold text-sm">
                                    <i class="fas fa-paper-plane mr-2"></i>ì½”ë©˜íŠ¸ ì‘ì„±
                                </button>
                            </div>
                        </div>

                        <!-- Comments List -->
                        ${ticket.comments && ticket.comments.length > 0 ? `
                            <div class="space-y-2 max-h-64 overflow-y-auto">
                                ${ticket.comments.map(comment => {
                                    const isReworkRequest = comment.content.includes('[ì¬ê²€ìˆ˜ ìš”ì²­]') || comment.content.includes('[ì™„ë£Œ í›„ ì¬ê²€ìˆ˜ ìš”ì²­]');
                                    const isApproval = comment.content.includes('[ìµœì¢… í™•ì¸ ì™„ë£Œ]');
                                    const isSatisfaction = comment.content.includes('[ë§Œì¡±ë„:');
                                    
                                    return `
                                    <div class="bg-white rounded-lg p-3 border ${isReworkRequest ? 'border-orange-400 bg-orange-50' : isApproval ? 'border-green-400 bg-green-50' : 'border-gray-200'}">
                                        <div class="flex items-start justify-between mb-2">
                                            <div class="flex items-center gap-2">
                                                <div class="w-8 h-8 rounded-full ${isReworkRequest ? 'bg-gradient-to-br from-orange-400 to-red-500' : isApproval ? 'bg-gradient-to-br from-green-400 to-teal-500' : 'bg-gradient-to-br from-blue-400 to-indigo-500'} flex items-center justify-center text-white text-xs font-semibold">
                                                    ${comment.author.charAt(0)}
                                                </div>
                                                <div>
                                                    <div class="font-semibold text-sm ${isReworkRequest ? 'text-orange-800' : isApproval ? 'text-green-800' : 'text-gray-800'}">
                                                        ${comment.author}
                                                        ${isReworkRequest ? '<span class="ml-2 text-xs px-2 py-0.5 bg-orange-600 text-white rounded">ì¬ê²€ìˆ˜</span>' : ''}
                                                        ${isApproval ? '<span class="ml-2 text-xs px-2 py-0.5 bg-green-600 text-white rounded">âœ“ í™•ì¸ì™„ë£Œ</span>' : ''}
                                                    </div>
                                                    <div class="text-xs ${isReworkRequest ? 'text-orange-600' : isApproval ? 'text-green-600' : 'text-gray-500'}">${comment.createdAt}</div>
                                                </div>
                                            </div>
                                            <button onclick="deleteComment(${ticket.id}, '${comment.id}')" 
                                                    class="text-red-500 hover:text-red-700 text-sm">
                                                <i class="fas fa-trash"></i>
                                            </button>
                                        </div>
                                        <p class="text-sm ${isReworkRequest ? 'text-orange-800 font-medium' : isApproval ? 'text-green-800' : 'text-gray-700'} whitespace-pre-wrap">${comment.content}</p>
                                    </div>
                                    `;
                                }).join('')}
                            </div>
                        ` : `
                            <p class="text-sm text-gray-500 italic text-center py-4">ì½”ë©˜íŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤</p>
                        `}
                    </div>

                    ${(currentRole === 'admin' || currentRole === 'master') ? `
                        <div class="flex justify-between items-center pt-4 border-t">
                            <div class="flex items-center space-x-2">
                                ${(ticket.status === 'ì ‘ìˆ˜' || ticket.status === 'ì²˜ë¦¬ì¤‘') && ticket.ticketType === 'ìì‚°' && ticket.assignees.length > 0 && (currentRole === 'admin' || currentRole === 'master') ? `
                                    <!-- ìì‚° í‹°ì¼“ ì²˜ë¦¬ ì™„ë£Œ ë²„íŠ¼ (ì ‘ìˆ˜ or ì²˜ë¦¬ì¤‘) ğŸ†• -->
                                    <button onclick="openAssetProcessingModal(${ticket.id}); closeModal('ticketDetailModal');" 
                                            class="px-5 py-2.5 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition font-semibold">
                                        <i class="fas fa-clipboard-check mr-2"></i>${ticket.assetCategory} ì²˜ë¦¬ ì™„ë£Œ
                                    </button>
                                ` : ''}
                                ${ticket.status === 'ì²˜ë¦¬ì¤‘' && !ticket.ticketType ? `
                                    <button onclick="openCompletionModal(${ticket.id})" class="px-5 py-2.5 bg-green-600 text-white rounded-lg hover:bg-green-700 transition font-semibold">
                                        <i class="fas fa-check-circle mr-2"></i>ê²€ìˆ˜ ìš”ì²­
                                    </button>
                                ` : ''}
                                ${ticket.status === 'ê²€ìˆ˜ ëŒ€ê¸°' ? `
                                    <span class="text-sm text-purple-600 px-4 font-semibold">
                                        <i class="fas fa-user-check mr-1"></i>ì‚¬ìš©ì ê²€ìˆ˜ ëŒ€ê¸° ì¤‘
                                    </span>
                                ` : ''}
                                ${ticket.status === 'ì™„ë£Œ' ? `
                                    <span class="text-sm text-green-600 px-4 font-semibold">
                                        <i class="fas fa-check-double mr-1"></i>ìµœì¢… ì™„ë£Œë¨
                                    </span>
                                ` : ''}
                            </div>
                            <div class="space-x-2">
                                ${ticket.status === 'ìš”ì²­' && ticket.ticketType === 'ìì‚°' && (currentRole === 'admin' || currentRole === 'master') ? `
                                    <!-- ìì‚° í‹°ì¼“ ì „ìš© ì²˜ë¦¬ ë²„íŠ¼ ğŸ†• -->
                                    <div class="bg-purple-50 border-2 border-purple-300 rounded-lg p-4 mb-4">
                                        <h4 class="font-bold text-purple-900 mb-3 flex items-center">
                                            <i class="fas fa-box mr-2"></i>ìì‚° ìš”ì²­ ì²˜ë¦¬
                                        </h4>
                                        <p class="text-sm text-purple-700 mb-4">
                                            ${ticket.assetCategory} ìš”ì²­ì„ ì–´ë–»ê²Œ ì²˜ë¦¬í•˜ì‹œê² ìŠµë‹ˆê¹Œ?
                                        </p>
                                        <div class="grid grid-cols-3 gap-3">
                                            <button onclick="setAssetApprovalPending(${ticket.id}); closeModal('ticketDetailModal');" 
                                                    class="px-4 py-3 bg-amber-500 text-white rounded-lg hover:bg-amber-600 transition font-semibold shadow-md">
                                                <i class="fas fa-hourglass-half mr-2"></i>ìŠ¹ì¸ ëŒ€ê¸°
                                            </button>
                                            <button onclick="acceptAssetDirectly(${ticket.id}); closeModal('ticketDetailModal');" 
                                                    class="px-4 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition font-semibold shadow-md">
                                                <i class="fas fa-check-circle mr-2"></i>ë°”ë¡œ ì ‘ìˆ˜
                                            </button>
                                            <button onclick="openRejectAssetModal(${ticket.id}); closeModal('ticketDetailModal');" 
                                                    class="px-4 py-3 bg-red-600 text-white rounded-lg hover:bg-red-700 transition font-semibold shadow-md">
                                                <i class="fas fa-times-circle mr-2"></i>ë°˜ë ¤í•˜ê¸°
                                            </button>
                                        </div>
                                    </div>
                                ` : ''}
                                ${ticket.status === 'ìš”ì²­' && !ticket.ticketType && (currentRole === 'admin' || currentRole === 'master') ? `
                                    <button onclick="openAcceptModal(${ticket.id}); closeModal('ticketDetailModal');" class="px-5 py-2.5 bg-gradient-to-r from-blue-600 to-green-600 text-white rounded-lg hover:from-blue-700 hover:to-green-700 transition font-semibold shadow-md">
                                        <i class="fas fa-clipboard-check mr-2"></i>ì²˜ë¦¬í•˜ê¸°
                                    </button>
                                ` : ''}
                                ${ticket.status === 'ê²¬ì í™•ì¸' && (currentRole === 'admin' || currentRole === 'master') ? `
                                    <span class="text-sm text-cyan-600 px-4 font-semibold">
                                        <i class="fas fa-user-check mr-1"></i>ì‹ ì²­ì ê²¬ì  í™•ì¸ ëŒ€ê¸° ì¤‘
                                    </span>
                                ` : ''}
                                ${ticket.status === 'ìŠ¹ì¸ëŒ€ê¸°' ? `
                                    ${currentRole === 'master' ? `
                                        <button onclick="approveTicket(${ticket.id})" class="px-5 py-2.5 bg-green-600 text-white rounded-lg hover:bg-green-700 transition font-semibold">
                                            <i class="fas fa-check-circle mr-2"></i>ìŠ¹ì¸í•˜ê¸°
                                        </button>
                                        <button onclick="confirmReject(${ticket.id})" class="px-5 py-2.5 bg-red-600 text-white rounded-lg hover:bg-red-700 transition font-semibold">
                                            <i class="fas fa-times mr-2"></i>ë°˜ë ¤
                                        </button>
                                    ` : `
                                        <span class="text-sm text-teal-600 px-4 font-semibold">
                                            <i class="fas fa-clock mr-1"></i>IT ì„ì› ìŠ¹ì¸ ëŒ€ê¸° ì¤‘
                                        </span>
                                    `}
                                ` : ''}
                                ${(ticket.status === 'ì ‘ìˆ˜' || ticket.status === 'ì²˜ë¦¬ì¤‘') && ticket.assignees.length === 0 ? `
                                    <button onclick="openAssignModal(${ticket.id}); closeModal('ticketDetailModal');" class="px-5 py-2.5 border border-blue-600 text-blue-600 rounded-lg hover:bg-blue-50 transition font-semibold">
                                        ë‹´ë‹¹ì ë°°ì •
                                    </button>
                                ` : ''}
                                ${(ticket.status === 'ì ‘ìˆ˜' || ticket.status === 'ì²˜ë¦¬ì¤‘') && ticket.assignees.length > 0 ? `
                                    <button onclick="openAssignModal(${ticket.id}); closeModal('ticketDetailModal');" class="px-5 py-2.5 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition font-semibold">
                                        <i class="fas fa-user-edit mr-2"></i>ë‹´ë‹¹ì ë³€ê²½
                                    </button>
                                ` : ''}
                                ${ticket.status !== 'ì™„ë£Œ' && ticket.status !== 'ë°˜ë ¤' && ticket.assignees.length > 0 ? `
                                    <button onclick="openAddSubtaskModal(${ticket.id}); closeModal('ticketDetailModal');" class="px-5 py-2.5 border border-gray-300 rounded-lg hover:bg-gray-50 transition font-semibold">
                                        <i class="fas fa-plus mr-2"></i>í•˜ìœ„ ì—…ë¬´ ì¶”ê°€
                                    </button>
                                ` : ''}
                            </div>
                        </div>
                    ` : ''}
                </div>
                
                ${currentRole === 'user' && ticket.status === 'ìš”ì²­' && (ticket.requester === currentUser.name || currentUser.role === 'master') ? `
                    <div class="mt-6 pt-6 border-t border-gray-200">
                        <div class="flex justify-center space-x-3">
                            <button onclick="openEditTicketModal(${ticket.id})" class="px-6 py-3 border-2 border-blue-600 text-blue-600 rounded-lg hover:bg-blue-50 transition font-semibold">
                                <i class="fas fa-edit mr-2"></i>í‹°ì¼“ ìˆ˜ì •
                            </button>
                            <button onclick="deleteTicket(${ticket.id})" class="px-6 py-3 border-2 border-red-600 text-red-600 rounded-lg hover:bg-red-50 transition font-semibold">
                                <i class="fas fa-trash mr-2"></i>í‹°ì¼“ ì‚­ì œ
                            </button>
                        </div>
                        <p class="text-xs text-gray-500 text-center mt-3">
                            <i class="fas fa-info-circle mr-1"></i>
                            ìš”ì²­ ìƒíƒœì—ì„œë§Œ ìˆ˜ì •/ì‚­ì œê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤. ì ‘ìˆ˜ ì´í›„ì—ëŠ” ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤.
                        </p>
                    </div>
                ` : ''}
            `;
            
            openModal('ticketDetailModal');
        }

        // Submit New Ticket
        function submitTicket(event) {
            event.preventDefault();
            const form = event.target;
            
            const categoryMain = form.categoryMain.value;
            const categoryMiddle = form.categoryMiddle.value;
            
            const newTicket = {
                id: ticketIdCounter++,
                ticketNumber: generateTicketNumber(categoryMain, categoryMiddle),
                title: form.title.value,
                description: form.description.value,
                requester: currentUser.name,
                department: currentUser.department,
                categoryMain: categoryMain,                   // ëŒ€ë¶„ë¥˜
                categoryMiddle: categoryMiddle,               // ì¤‘ë¶„ë¥˜
                categorySub: form.categorySub.value,          // ì†Œë¶„ë¥˜
                category: categoryMain,                       // í•˜ìœ„í˜¸í™˜ (ê¸°ì¡´ ì½”ë“œìš©)
                status: 'ìš”ì²­',
                priority: form.priority.value,
                assignees: [],
                createdAt: new Date().toISOString().split('T')[0],
                dueDate: form.dueDate.value,
                linkedTickets: [],
                approved: false,
                comments: [],
                subtasks: []
            };
            
            tickets.unshift(newTicket);
            closeModal('newTicketModal');
            form.reset();
            
            if (currentRole === 'user') {
                renderUserView();
            } else {
                renderAdminView();
            }
            
            alert(`âœ… í‹°ì¼“ì´ ì„±ê³µì ìœ¼ë¡œ ìš”ì²­ë˜ì—ˆìŠµë‹ˆë‹¤!\ní‹°ì¼“ë²ˆí˜¸: ${newTicket.ticketNumber}`);
        }

        // Open Assign Modal
        // ==========================================
        // Accept (ì ‘ìˆ˜) Functions
        // ==========================================
        
        // Open Accept Modal
        function openAcceptModal(ticketId) {
            const ticket = tickets.find(t => t.id === ticketId);
            if (!ticket) return;
            
            document.getElementById('accept-ticket-id').value = ticketId;
            
            // í‹°ì¼“ ìš”ì•½ í‘œì‹œ
            document.getElementById('accept-ticket-summary').innerHTML = `
                <div class="font-semibold text-gray-800 mb-1">${ticket.ticketNumber}: ${ticket.title}</div>
                <div class="text-xs text-gray-600">
                    ëŒ€ë¶„ë¥˜: ${ticket.categoryMain} / ì¤‘ë¶„ë¥˜: ${ticket.categoryMiddle} / ìš°ì„ ìˆœìœ„: ${ticket.priority}
                </div>
            `;
            
            // ê¸°ë³¸ê°’: ê²¬ì  ì‘ì„± ëª¨ë“œ
            document.querySelector('input[name="process-type"][value="estimate"]').checked = true;
            
            // ì¤‘ë¶„ë¥˜ì— ë”°ë¼ ì„ì› ìŠ¹ì¸ ê¸°ë³¸ ì„¤ì •
            if (ticket.categoryMiddle === 'ê°œë°œìš”ì²­') {
                // ê°œë°œìš”ì²­ì€ ì„ì› ìŠ¹ì¸ ê¶Œì¥ (í•˜ì§€ë§Œ ì„ íƒ ê°€ëŠ¥)
                document.getElementById('require-approval').checked = true;
            } else {
                // ìš´ì˜ê´€ë¦¬, ì¥ì•  ë“±ì€ ì„ íƒ
                document.getElementById('require-approval').checked = false;
            }
            
            // ê²¬ì  ì„¹ì…˜ ì´ˆê¸°í™”
            document.getElementById('estimate-íŠ¹ê¸‰-md').value = 0;
            document.getElementById('estimate-ê³ ê¸‰-md').value = 0;
            document.getElementById('estimate-ì¤‘ê¸‰-md').value = 0;
            document.getElementById('estimate-ì´ˆê¸‰-md').value = 0;
            document.getElementById('estimate-note').value = '';
            
            calculateEstimate();
            toggleProcessType(); // ì´ˆê¸° UI ì„¤ì •
            
            openModal('acceptModal');
        }
        
        // Toggle Process Type (ê°„ë‹¨ ì ‘ìˆ˜ vs ê²¬ì  ì‘ì„±)
        function toggleProcessType() {
            const processType = document.querySelector('input[name="process-type"]:checked').value;
            const approvalSection = document.getElementById('approval-checkbox-section');
            const estimateSection = document.getElementById('estimate-section');
            const submitBtn = document.getElementById('accept-submit-btn');
            const btnText = document.getElementById('accept-btn-text');
            const btnIcon = submitBtn.querySelector('i');
            
            if (processType === 'simple') {
                // ê°„ë‹¨ ì ‘ìˆ˜: ê²¬ì  ë¶ˆí•„ìš” + ì„ì› ìŠ¹ì¸ ë¶ˆí•„ìš”
                approvalSection.style.display = 'none';
                estimateSection.style.display = 'none';
                submitBtn.className = 'px-6 py-3 bg-gradient-to-r from-green-600 to-teal-600 text-white rounded-lg hover:from-green-700 hover:to-teal-700 transition font-semibold shadow-md';
                btnIcon.className = 'fas fa-check mr-2';
                btnText.textContent = 'ê°„ë‹¨ ì ‘ìˆ˜';
            } else {
                // ê²¬ì  ì‘ì„±: ê²¬ì  í•„ìˆ˜ + ì„ì› ìŠ¹ì¸ ì„ íƒ
                approvalSection.style.display = 'block';
                estimateSection.style.display = 'block';
                submitBtn.className = 'px-6 py-3 bg-gradient-to-r from-blue-600 to-green-600 text-white rounded-lg hover:from-blue-700 hover:to-green-700 transition font-semibold shadow-md';
                btnIcon.className = 'fas fa-calculator mr-2';
                btnText.textContent = 'ê²¬ì  ì œì¶œ';
            }
        }
        
        // toggleEstimateSection í•¨ìˆ˜ ì œê±° (ë” ì´ìƒ í•„ìš” ì—†ìŒ)
        
        // Calculate Estimate
        function calculateEstimate() {
            const grades = ['íŠ¹ê¸‰', 'ê³ ê¸‰', 'ì¤‘ê¸‰', 'ì´ˆê¸‰'];
            let totalManDays = 0;
            let totalCost = 0;
            
            grades.forEach(grade => {
                const md = parseFloat(document.getElementById(`estimate-${grade}-md`).value) || 0;
                const rate = gradeRates[grade].dailyRate;
                
                totalManDays += md;
                totalCost += md * rate;
            });
            
            // ì˜ˆìƒ ê¸°ê°„ ê³„ì‚° (2ëª… íˆ¬ì… ê°€ì •)
            const estimatedDays = totalManDays > 0 ? Math.ceil(totalManDays / 2) : 0;
            
            document.getElementById('total-mandays').textContent = `${totalManDays.toFixed(1)} MD`;
            document.getElementById('estimated-days').textContent = `${estimatedDays}ì¼`;
            document.getElementById('total-cost').textContent = `â‚©${totalCost.toLocaleString()}`;
        }
        
        // Submit Accept
        function submitAccept(event) {
            event.preventDefault();
            
            const ticketId = parseInt(document.getElementById('accept-ticket-id').value);
            const ticket = tickets.find(t => t.id === ticketId);
            if (!ticket) return;
            
            const processType = document.querySelector('input[name="process-type"]:checked').value;
            
            if (processType === 'simple') {
                // ===== ê°„ë‹¨ ì ‘ìˆ˜ (ê²¬ì  ë¶ˆí•„ìš”) =====
                ticket.status = 'ì ‘ìˆ˜';
                ticket.requireEstimateConfirmation = false;
                ticket.skipApproval = true;
                ticket.skipEstimate = true;
                ticket.acceptedAt = new Date().toLocaleString('ko-KR');
                ticket.acceptedBy = currentUser.name;
                
                ticket.comments.push({
                    id: `cmt${Date.now()}`,
                    author: currentUser.name,
                    content: `[ê°„ë‹¨ ì ‘ìˆ˜] ê²¬ì  ì—†ì´ ì¦‰ì‹œ ì ‘ìˆ˜ë˜ì—ˆìŠµë‹ˆë‹¤.`,
                    createdAt: new Date().toLocaleString('ko-KR')
                });
                
                closeModal('acceptModal');
                renderAdminView();
                
                alert(`âœ… í‹°ì¼“ì´ ì ‘ìˆ˜ë˜ì—ˆìŠµë‹ˆë‹¤!\n\në‹´ë‹¹ìë¥¼ ë°°ì •í•˜ê³  ì‘ì—…ì„ ì‹œì‘í•˜ì„¸ìš”.`);
                return;
            }
            
            // ===== ê²¬ì  ì‘ì„± ëª¨ë“œ =====
            const requireApproval = document.getElementById('require-approval').checked;
            
            // ê²¬ì  ì •ë³´ ìˆ˜ì§‘
            const grades = ['íŠ¹ê¸‰', 'ê³ ê¸‰', 'ì¤‘ê¸‰', 'ì´ˆê¸‰'];
            const estimateItems = [];
            let totalManDays = 0;
            let totalCost = 0;
            
            grades.forEach(grade => {
                const md = parseFloat(document.getElementById(`estimate-${grade}-md`).value) || 0;
                if (md > 0) {
                    const rate = gradeRates[grade];
                    estimateItems.push({
                        grade: grade,
                        manDays: md,
                        dailyRate: rate.dailyRate,
                        cost: md * rate.dailyRate
                    });
                    totalManDays += md;
                    totalCost += md * rate.dailyRate;
                }
            });
            
            if (totalManDays === 0) {
                alert('âš ï¸ ìµœì†Œ 1ê°œ ë“±ê¸‰ì˜ ë§¨ë°ì´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            const estimatedDays = Math.ceil(totalManDays / 2);
            const estimateNote = document.getElementById('estimate-note').value.trim();
            
            // ê²¬ì  ì •ë³´ ì €ì¥
            ticket.estimate = {
                items: estimateItems,
                totalManDays: totalManDays,
                totalCost: totalCost,
                estimatedDays: estimatedDays,
                note: estimateNote,
                createdAt: new Date().toLocaleString('ko-KR'),
                createdBy: currentUser.name
            };
            
            if (requireApproval) {
                // ìŠ¹ì¸ í•„ìš” - ê²¬ì  í™•ì¸ íŒë‹¨
                const requiresConfirmation = requiresEstimateConfirmation(ticket);
                
                if (requiresConfirmation) {
                    // ê³ ì•¡ ë˜ëŠ” ê°œë°œìš”ì²­ â†’ ê²¬ì í™•ì¸
                    ticket.status = 'ê²¬ì í™•ì¸';
                    ticket.requireEstimateConfirmation = true;
                    alert(`âœ… ê²¬ì ì´ ì‘ì„±ë˜ì—ˆìŠµë‹ˆë‹¤.\n\nì´ ë¹„ìš©: â‚©${totalCost.toLocaleString()}\n\nì‹ ì²­ìì˜ ê²¬ì  í™•ì¸ì„ ê¸°ë‹¤ë¦½ë‹ˆë‹¤.`);
                } else {
                    // ì†Œì•¡ â†’ ìŠ¹ì¸ëŒ€ê¸°
                    ticket.status = 'ìŠ¹ì¸ëŒ€ê¸°';
                    ticket.requireEstimateConfirmation = false;
                    alert(`âœ… ê²¬ì ì´ ì‘ì„±ë˜ì—ˆìŠµë‹ˆë‹¤.\n\nì´ ë¹„ìš©: â‚©${totalCost.toLocaleString()}\n\nIT ì„ì›ì˜ ìŠ¹ì¸ì„ ê¸°ë‹¤ë¦½ë‹ˆë‹¤.`);
                }
            } else {
                // ìŠ¹ì¸ ë¶ˆí•„ìš” â†’ ì ‘ìˆ˜ (ë°”ë¡œ ì‘ì—… ê°€ëŠ¥)
                ticket.status = 'ì ‘ìˆ˜';
                ticket.requireEstimateConfirmation = false;
                ticket.skipApproval = true;
                alert(`âœ… ê²¬ì ì´ ì‘ì„±ë˜ì—ˆìŠµë‹ˆë‹¤.\n\nì´ ë¹„ìš©: â‚©${totalCost.toLocaleString()}\n\nìŠ¹ì¸ ì—†ì´ ì¦‰ì‹œ ì‘ì—…ì„ ì‹œì‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.`);
            }
            
            ticket.acceptedAt = new Date().toLocaleString('ko-KR');
            ticket.acceptedBy = currentUser.name;
            
            ticket.comments.push({
                id: `cmt${Date.now()}`,
                author: currentUser.name,
                content: `[ê²¬ì  ì‘ì„± ì™„ë£Œ] ì´ ${totalManDays}MD, â‚©${totalCost.toLocaleString()}`,
                createdAt: new Date().toLocaleString('ko-KR')
            });
            
            closeModal('acceptModal');
            renderAdminView();
        }
        
        // Check if estimate confirmation is required
        function requiresEstimateConfirmation(ticket) {
            const estimate = ticket.estimate;
            
            // 1. ê¸ˆì•¡ ê¸°ì¤€ (ì‹œìŠ¤í…œ ì„¤ì • ê¸ˆì•¡ ì´ìƒ)
            if (estimate.totalCost >= systemSettings.estimateConfirmationThreshold) {
                return true;
            }
            
            // 2. ì¹´í…Œê³ ë¦¬ ê¸°ì¤€ (ê°œë°œìš”ì²­)
            if (ticket.categoryMiddle === 'ê°œë°œìš”ì²­') {
                return true;
            }
            
            // 3. ì‹ ì²­ìê°€ ëª…ì‹œì ìœ¼ë¡œ ìš”ì²­ (í–¥í›„ ì¶”ê°€)
            if (ticket.requestEstimateConfirmation === true) {
                return true;
            }
            
            return false;
        }
        
        // ==========================================
        // Estimate Confirmation Functions
        // ==========================================
        
        // Confirm Estimate (ì§„í–‰í•˜ê¸°)
        function confirmEstimate(ticketId) {
            const ticket = tickets.find(t => t.id === ticketId);
            if (!ticket) return;
            
            if (ticket.status !== 'ê²¬ì í™•ì¸') {
                alert('âš ï¸ ê²¬ì í™•ì¸ ìƒíƒœê°€ ì•„ë‹™ë‹ˆë‹¤.');
                return;
            }
            
            if (confirm(`ê²¬ì ì„ í™•ì¸í•˜ì…¨ìŠµë‹ˆê¹Œ?\n\nì´ ë¹„ìš©: â‚©${ticket.estimate.totalCost.toLocaleString()}\nì˜ˆìƒ ê¸°ê°„: ${ticket.estimate.estimatedDays}ì¼\n\nì§„í–‰í•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
                ticket.status = 'ìŠ¹ì¸ëŒ€ê¸°';
                ticket.estimateConfirmedAt = new Date().toLocaleString('ko-KR');
                ticket.estimateConfirmedBy = currentUser.name;
                
                ticket.comments.push({
                    id: `cmt${Date.now()}`,
                    author: currentUser.name,
                    content: `[ê²¬ì  í™•ì¸ ì™„ë£Œ] ê²¬ì  ë‚´ìš©ì„ í™•ì¸í•˜ê³  ì§„í–‰ì„ ìŠ¹ì¸í–ˆìŠµë‹ˆë‹¤.`,
                    createdAt: new Date().toLocaleString('ko-KR')
                });
                
                closeModal('ticketDetailModal');
                renderUserView();
                
                alert('âœ… ê²¬ì ì„ í™•ì¸í•˜ì…¨ìŠµë‹ˆë‹¤.\n\nIT ì„ì›ì˜ ìµœì¢… ìŠ¹ì¸ì„ ê¸°ë‹¤ë¦½ë‹ˆë‹¤.');
            }
        }
        
        // Request Adjustment (ì¡°ì • ìš”ì²­)
        function requestAdjustment(ticketId) {
            const ticket = tickets.find(t => t.id === ticketId);
            if (!ticket) return;
            
            if (ticket.status !== 'ê²¬ì í™•ì¸') {
                alert('âš ï¸ ê²¬ì í™•ì¸ ìƒíƒœê°€ ì•„ë‹™ë‹ˆë‹¤.');
                return;
            }
            
            const reason = prompt(`ğŸ”„ ê²¬ì  ì¡°ì • ìš”ì²­\n\ní˜„ì¬ ê²¬ì : â‚©${ticket.estimate.totalCost.toLocaleString()}\n\nì¡°ì • ìš”ì²­ ì‚¬ìœ ë¥¼ ì…ë ¥í•˜ì„¸ìš”:\n(ì˜ˆ: ì˜ˆì‚°ì´ 150ë§Œì›ìœ¼ë¡œ ì œí•œë˜ì–´ ìˆìŠµë‹ˆë‹¤)`);
            
            if (reason === null) return;
            
            if (!reason.trim()) {
                alert('âš ï¸ ì¡°ì • ì‚¬ìœ ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            if (reason.trim().length < 10) {
                alert('âš ï¸ ì¡°ì • ì‚¬ìœ ë¥¼ 10ì ì´ìƒ êµ¬ì²´ì ìœ¼ë¡œ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            ticket.status = 'ì ‘ìˆ˜';
            ticket.adjustmentRequest = {
                reason: reason.trim(),
                requestedAt: new Date().toLocaleString('ko-KR'),
                requestedBy: currentUser.name,
                previousEstimate: JSON.parse(JSON.stringify(ticket.estimate))
            };
            
            ticket.comments.push({
                id: `cmt${Date.now()}`,
                author: currentUser.name,
                content: `[ê²¬ì  ì¡°ì • ìš”ì²­] ${reason.trim()}`,
                createdAt: new Date().toLocaleString('ko-KR')
            });
            
            closeModal('ticketDetailModal');
            renderUserView();
            
            alert(`âš ï¸ ê²¬ì  ì¡°ì •ì´ ìš”ì²­ë˜ì—ˆìŠµë‹ˆë‹¤.\n\nITíŒ€ì—ì„œ ì¬ê²€í† í•˜ì—¬ ìƒˆë¡œìš´ ê²¬ì ì„ ì œì‹œí•  ì˜ˆì •ì…ë‹ˆë‹¤.`);
        }
        
        // Cancel After Estimate (ì·¨ì†Œí•˜ê¸°)
        function cancelAfterEstimate(ticketId) {
            const ticket = tickets.find(t => t.id === ticketId);
            if (!ticket) return;
            
            if (ticket.status !== 'ê²¬ì í™•ì¸') {
                alert('âš ï¸ ê²¬ì í™•ì¸ ìƒíƒœê°€ ì•„ë‹™ë‹ˆë‹¤.');
                return;
            }
            
            const reason = prompt(`âŒ í‹°ì¼“ ì·¨ì†Œ\n\ní˜„ì¬ ê²¬ì : â‚©${ticket.estimate.totalCost.toLocaleString()}\n\nì·¨ì†Œ ì‚¬ìœ ë¥¼ ì…ë ¥í•˜ì„¸ìš”:\n(ì˜ˆ: ì˜ˆì‚° ë¶€ì¡±ìœ¼ë¡œ ë³´ë¥˜í•©ë‹ˆë‹¤)`);
            
            if (reason === null) return;
            
            if (!reason.trim()) {
                alert('âš ï¸ ì·¨ì†Œ ì‚¬ìœ ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            if (!confirm(`ì •ë§ë¡œ í‹°ì¼“ì„ ì·¨ì†Œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n\nì·¨ì†Œ ì‚¬ìœ : ${reason.trim()}\n\nâš ï¸ ì·¨ì†Œ í›„ì—ëŠ” ë³µêµ¬í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.`)) {
                return;
            }
            
            ticket.status = 'ì·¨ì†Œ';
            ticket.cancelReason = reason.trim();
            ticket.canceledAt = new Date().toLocaleString('ko-KR');
            ticket.canceledBy = currentUser.name;
            ticket.canceledAfterEstimate = true;
            
            ticket.comments.push({
                id: `cmt${Date.now()}`,
                author: currentUser.name,
                content: `[ê²¬ì  í›„ ì·¨ì†Œ] ${reason.trim()}`,
                createdAt: new Date().toLocaleString('ko-KR')
            });
            
            closeModal('ticketDetailModal');
            renderUserView();
            
            alert(`âŒ í‹°ì¼“ì´ ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤.\n\nì·¨ì†Œ ì‚¬ìœ : ${reason.trim()}`);
        }
        
        // Open Assign Modal
        function openAssignModal(ticketId) {
            document.getElementById('assign-ticket-id').value = ticketId;
            const ticket = tickets.find(t => t.id === ticketId);
            
            // Reset all checkboxes first
            document.querySelectorAll('#assignForm input[type="checkbox"]').forEach(cb => {
                cb.checked = false;
            });
            
            // Check current assignees if ticket has them
            if (ticket && ticket.assignees.length > 0) {
                ticket.assignees.forEach(assignee => {
                    const checkbox = document.querySelector(`#assignForm input[value="${assignee}"]`);
                    if (checkbox) {
                        checkbox.checked = true;
                    }
                });
            }
            
            openModal('assignModal');
        }

        // Submit Assignment
        function submitAssignment(event) {
            event.preventDefault();
            const ticketId = parseInt(document.getElementById('assign-ticket-id').value);
            const ticket = tickets.find(t => t.id === ticketId);
            
            const checkboxes = document.querySelectorAll('#assignForm input[name="assignees"]:checked');
            const assignees = Array.from(checkboxes).map(cb => cb.value);
            
            if (assignees.length === 0) {
                alert('ìµœì†Œ 1ëª…ì˜ ë‹´ë‹¹ìë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.');
                return;
            }
            
            if (ticket) {
                ticket.assignees = assignees;
                // ìƒíƒœ ìë™ ë³€ê²½ ì œê±° - ITíŒ€ì´ ìˆ˜ë™ìœ¼ë¡œ ì ‘ìˆ˜ ë²„íŠ¼ì„ ëˆŒëŸ¬ì•¼ í•¨
                closeModal('assignModal');
                renderAdminView();
                if (currentRole === 'user') {
                    renderUserView();
                }
                alert(`ë‹´ë‹¹ìê°€ ë°°ì •ë˜ì—ˆìŠµë‹ˆë‹¤: ${assignees.join(', ')}`);
            }
        }

        // Open Add Subtask Modal
        function openAddSubtaskModal(ticketId) {
            document.getElementById('subtask-ticket-id').value = ticketId;
            document.getElementById('addSubtaskForm').reset();
            openModal('addSubtaskModal');
        }

        // Submit Subtask
        // Submit Subtask
        function submitSubtask(event) {
            event.preventDefault();
            const form = event.target;
            const ticketId = parseInt(document.getElementById('subtask-ticket-id').value);
            const ticket = tickets.find(t => t.id === ticketId);
            
            if (!ticket) {
                alert('í‹°ì¼“ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            // ë‹´ë‹¹ìê°€ ì„ íƒë˜ì§€ ì•Šì€ ê²½ìš° ê²½ê³ 
            if (!form.assignee.value) {
                if (!confirm('ë‹´ë‹¹ìê°€ ì„ íƒë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ê³„ì†í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                    return;
                }
            }
            
            const subtask = {
                id: 'st' + Date.now(),
                title: form.title.value,
                description: form.description.value,
                assignee: form.assignee.value || 'ë¯¸ë°°ì •',
                startDate: form.startDate.value,
                endDate: form.endDate.value,
                status: 'ì§„í–‰ì¤‘'
            };
            
            ticket.subtasks.push(subtask);
            
            // Update ticket due date if needed
            if (form.endDate.value && (!ticket.dueDate || form.endDate.value > ticket.dueDate)) {
                ticket.dueDate = form.endDate.value;
            }
            
            closeModal('addSubtaskModal');
            form.reset();
            
            // ë‘ í™”ë©´ ëª¨ë‘ ì—…ë°ì´íŠ¸
            if (currentRole === 'user') {
                renderUserView();
            } else {
                renderAdminView();
            }
            
            alert('í•˜ìœ„ ì—…ë¬´ê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.');
        }

        // Update Ticket Status
        function updateTicketStatus(ticketId, newStatus) {
            const ticket = tickets.find(t => t.id === ticketId);
            if (!ticket) return;
            
            // ìš”ì²­ â†’ ì ‘ìˆ˜: ì‹¤ë¬´ìê°€ ë³¸ì¸ì„ ë‹´ë‹¹ìë¡œ ë°°ì •
            if (ticket.status === 'ìš”ì²­' && newStatus === 'ì ‘ìˆ˜') {
                if (currentRole === 'admin' || currentRole === 'master') {
                    // ë‹´ë‹¹ìê°€ ì—†ìœ¼ë©´ í˜„ì¬ ì‚¬ìš©ì ì¶”ê°€
                    if (!ticket.assignees || ticket.assignees.length === 0) {
                        ticket.assignees = [currentUser.name];
                    } else if (!ticket.assignees.includes(currentUser.name)) {
                        ticket.assignees.push(currentUser.name);
                    }
                    ticket.approved = false; // ë§ˆìŠ¤í„° ìŠ¹ì¸ ëŒ€ê¸°
                    console.log(`âœ… ì ‘ìˆ˜: ${currentUser.name}ì´(ê°€) ë‹´ë‹¹ìë¡œ ë°°ì •ë¨`);
                }
            }
            
            // ì ‘ìˆ˜ â†’ ì²˜ë¦¬ì¤‘: ìŠ¹ì¸ ì™„ë£Œëœ í‹°ì¼“ë§Œ ê°€ëŠ¥
            if (ticket.status === 'ì ‘ìˆ˜' && newStatus === 'ì²˜ë¦¬ì¤‘') {
                if (!ticket.approved && currentRole !== 'master') {
                    alert('â›” ë§ˆìŠ¤í„° ìŠ¹ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.');
                    return;
                }
            }
            
            ticket.status = newStatus;
            closeModal('ticketDetailModal');
            
            // ë‘ í™”ë©´ ëª¨ë‘ ì—…ë°ì´íŠ¸
            if (currentRole === 'user') {
                renderUserView();
            } else {
                renderAdminView();
            }
            
            const statusMessage = newStatus === 'ì ‘ìˆ˜' && !ticket.approved 
                ? `í‹°ì¼“ì´ ì ‘ìˆ˜ë˜ì—ˆìŠµë‹ˆë‹¤.\në‹´ë‹¹ì: ${ticket.assignees.join(', ')}\n\nâ³ ë§ˆìŠ¤í„° ìŠ¹ì¸ ëŒ€ê¸° ì¤‘ì…ë‹ˆë‹¤.`
                : `í‹°ì¼“ ìƒíƒœê°€ "${newStatus}"(ìœ¼)ë¡œ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.`;
            
            alert(statusMessage);
        }
        
        // í‹°ì¼“ ì‚­ì œ (ìš”ì²­ ìƒíƒœë§Œ, ë³¸ì¸ í‹°ì¼“ë§Œ)
        function deleteTicket(ticketId) {
            const ticket = tickets.find(t => t.id === ticketId);
            if (!ticket) return;
            
            // ê¶Œí•œ ì²´í¬
            if (currentUser.role !== 'master' && ticket.requester !== currentUser.name) {
                alert('â›” ë³¸ì¸ì´ ìš”ì²­í•œ í‹°ì¼“ë§Œ ì‚­ì œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
                return;
            }
            
            // ìƒíƒœ ì²´í¬
            if (ticket.status !== 'ìš”ì²­') {
                alert('â›” ìš”ì²­ ìƒíƒœì˜ í‹°ì¼“ë§Œ ì‚­ì œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\nì ‘ìˆ˜ ì´í›„ì—ëŠ” ì‚­ì œê°€ ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤.');
                return;
            }
            
            if (!confirm(`ì •ë§ë¡œ ì´ í‹°ì¼“ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n\ní‹°ì¼“: ${ticket.ticketNumber}\nì œëª©: ${ticket.title}\n\nâš ï¸ ì‚­ì œ í›„ ë³µêµ¬í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.`)) {
                return;
            }
            
            const index = tickets.findIndex(t => t.id === ticketId);
            if (index > -1) {
                tickets.splice(index, 1);
                closeModal('ticketDetailModal');
                
                if (currentRole === 'user') {
                    renderUserView();
                } else {
                    renderAdminView();
                }
                
                alert('âœ… í‹°ì¼“ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
            }
        }
        
        // í‹°ì¼“ ìˆ˜ì • ëª¨ë‹¬ ì—´ê¸°
        function openEditTicketModal(ticketId) {
            const ticket = tickets.find(t => t.id === ticketId);
            if (!ticket) return;
            
            // ê¶Œí•œ ì²´í¬
            if (currentUser.role !== 'master' && ticket.requester !== currentUser.name) {
                alert('â›” ë³¸ì¸ì´ ìš”ì²­í•œ í‹°ì¼“ë§Œ ìˆ˜ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
                return;
            }
            
            // ìƒíƒœ ì²´í¬
            if (ticket.status !== 'ìš”ì²­') {
                alert('â›” ìš”ì²­ ìƒíƒœì˜ í‹°ì¼“ë§Œ ìˆ˜ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\nì ‘ìˆ˜ ì´í›„ì—ëŠ” ìˆ˜ì •ì´ ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤.');
                return;
            }
            
            // ìˆ˜ì • í¼ì— ë°ì´í„° ì±„ìš°ê¸°
            document.getElementById('edit-ticket-id').value = ticket.id;
            document.getElementById('edit-ticket-title').value = ticket.title;
            document.getElementById('edit-ticket-description').value = ticket.description;
            document.getElementById('edit-ticket-categoryMain').value = ticket.categoryMain || ticket.category || 'ì˜¤ì•„ì‹œìŠ¤';
            document.getElementById('edit-ticket-categoryMiddle').value = ticket.categoryMiddle || 'ê°œë°œìš”ì²­';
            document.getElementById('edit-ticket-categorySub').value = ticket.categorySub || 'ì‹ ê·œ';
            document.getElementById('edit-ticket-priority').value = ticket.priority;
            document.getElementById('edit-ticket-dueDate').value = ticket.dueDate || '';
            
            closeModal('ticketDetailModal');
            openModal('editTicketModal');
        }
        
        // í‹°ì¼“ ìˆ˜ì • ì €ì¥
        function saveEditedTicket() {
            const ticketId = parseInt(document.getElementById('edit-ticket-id').value);
            const ticket = tickets.find(t => t.id === ticketId);
            if (!ticket) return;
            
            ticket.title = document.getElementById('edit-ticket-title').value;
            ticket.description = document.getElementById('edit-ticket-description').value;
            ticket.categoryMain = document.getElementById('edit-ticket-categoryMain').value;
            ticket.categoryMiddle = document.getElementById('edit-ticket-categoryMiddle').value;
            ticket.categorySub = document.getElementById('edit-ticket-categorySub').value;
            ticket.category = ticket.categoryMain; // í•˜ìœ„í˜¸í™˜
            ticket.priority = document.getElementById('edit-ticket-priority').value;
            ticket.dueDate = document.getElementById('edit-ticket-dueDate').value;
            
            closeModal('editTicketModal');
            
            if (currentRole === 'user') {
                renderUserView();
            } else {
                renderAdminView();
            }
            
            alert(`âœ… í‹°ì¼“ì´ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.\ní‹°ì¼“: ${ticket.ticketNumber}`);
        }

        // ==========================================
        // Account Management Functions (Master Only)
        // ==========================================

        // ==========================================
        // Rate Management Functions
        // ==========================================

        // Render Rates Display
        function renderRatesDisplay() {
            const container = document.getElementById('rates-display');
            if (!container) return;
            
            const grades = ['íŠ¹ê¸‰', 'ê³ ê¸‰', 'ì¤‘ê¸‰', 'ì´ˆê¸‰'];
            const colors = {
                'íŠ¹ê¸‰': { bg: 'bg-purple-200', text: 'text-purple-700', icon: 'ğŸŒŸ' },
                'ê³ ê¸‰': { bg: 'bg-blue-200', text: 'text-blue-700', icon: 'â­' },
                'ì¤‘ê¸‰': { bg: 'bg-green-200', text: 'text-green-700', icon: 'âœ“' },
                'ì´ˆê¸‰': { bg: 'bg-gray-200', text: 'text-gray-700', icon: 'â€¢' }
            };
            
            container.innerHTML = grades.map(grade => {
                const rate = gradeRates[grade];
                const color = colors[grade];
                return `
                    <div class="bg-white rounded-lg p-4 border border-${color.bg}">
                        <div class="font-bold ${color.text} mb-2">${color.icon} ${grade}</div>
                        <div class="text-xs text-gray-600 space-y-1">
                            <div>ì‹œê¸‰: <span class="font-semibold text-gray-800">â‚©${rate.hourlyRate.toLocaleString()}</span></div>
                            <div>ì¼ê¸‰: <span class="font-semibold text-gray-800">â‚©${rate.dailyRate.toLocaleString()}</span></div>
                            <div>ì›”ê¸‰: <span class="font-semibold text-gray-800">â‚©${rate.monthlyRate.toLocaleString()}</span></div>
                            <div class="text-xs text-gray-500 mt-2">${rate.description.split(',')[0]}</div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // Open Edit Rates Modal
        function openEditRatesModal() {
            const grades = ['íŠ¹ê¸‰', 'ê³ ê¸‰', 'ì¤‘ê¸‰', 'ì´ˆê¸‰'];
            grades.forEach(grade => {
                const rate = gradeRates[grade];
                const hourlyInput = document.getElementById(`edit-rate-${grade}-hourly`);
                const dailyInput = document.getElementById(`edit-rate-${grade}-daily`);
                const monthlyInput = document.getElementById(`edit-rate-${grade}-monthly`);
                
                // í˜„ì¬ ê°’ ì„¤ì •
                hourlyInput.value = rate.hourlyRate;
                dailyInput.value = rate.dailyRate;
                monthlyInput.value = rate.monthlyRate;
                
                // ê¸°ì¡´ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì œê±° í›„ ìƒˆë¡œ ì¶”ê°€
                hourlyInput.replaceWith(hourlyInput.cloneNode(true));
                const newHourlyInput = document.getElementById(`edit-rate-${grade}-hourly`);
                
                newHourlyInput.addEventListener('input', function() {
                    const hourly = parseInt(this.value) || 0;
                    const daily = hourly * 8;
                    const monthly = daily * 21;
                    
                    document.getElementById(`edit-rate-${grade}-daily`).value = daily;
                    document.getElementById(`edit-rate-${grade}-monthly`).value = monthly;
                });
            });
            
            document.getElementById('rate-change-note').value = '';
            openModal('editRatesModal');
        }

        // Update Calculated Rates (Daily & Monthly based on Hourly)
        function updateCalculatedRates(grade) {
            const hourly = parseInt(document.getElementById(`edit-rate-${grade}-hourly`).value) || 0;
            const daily = hourly * 8;
            const monthly = daily * 21;
            
            document.getElementById(`edit-rate-${grade}-daily`).value = daily;
            document.getElementById(`edit-rate-${grade}-monthly`).value = monthly;
        }

        // Save Rate Changes
        function saveRateChanges() {
            const note = document.getElementById('rate-change-note').value.trim();
            if (!note) {
                alert('âš ï¸ ë³€ê²½ ì‚¬ìœ ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            const grades = ['íŠ¹ê¸‰', 'ê³ ê¸‰', 'ì¤‘ê¸‰', 'ì´ˆê¸‰'];
            const newRates = {};
            
            // Collect new rates
            grades.forEach(grade => {
                const hourly = parseInt(document.getElementById(`edit-rate-${grade}-hourly`).value);
                const daily = parseInt(document.getElementById(`edit-rate-${grade}-daily`).value);
                const monthly = parseInt(document.getElementById(`edit-rate-${grade}-monthly`).value);
                
                newRates[grade] = { hourlyRate: hourly, dailyRate: daily, monthlyRate: monthly };
            });
            
            // Confirm
            const confirmMsg = `
ì •ë§ë¡œ ë‹¨ê°€ë¥¼ ë³€ê²½í•˜ì‹œê² ìŠµë‹ˆê¹Œ?

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ë³€ê²½ ë‚´ì—­:
${grades.map(grade => {
    const old = gradeRates[grade];
    const newRate = newRates[grade];
    if (old.monthlyRate !== newRate.monthlyRate) {
        return `â€¢ ${grade}: â‚©${old.monthlyRate.toLocaleString()} â†’ â‚©${newRate.monthlyRate.toLocaleString()}`;
    }
    return null;
}).filter(Boolean).join('\n')}

ë³€ê²½ ì‚¬ìœ : ${note}
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

âš ï¸ ëª¨ë“  IT ì§ì›ì˜ ìš”ìœ¨ì´ ì¦‰ì‹œ ë³€ê²½ë©ë‹ˆë‹¤.
            `.trim();
            
            if (!confirm(confirmMsg)) {
                return;
            }
            
            // Save to history
            const history = {
                id: rateHistoryIdCounter++,
                changedAt: new Date().toLocaleString('ko-KR'),
                changedBy: currentUser.name,
                rates: JSON.parse(JSON.stringify(newRates)), // Deep copy
                note: note
            };
            rateHistory.unshift(history);
            
            // Update current rates
            grades.forEach(grade => {
                gradeRates[grade].hourlyRate = newRates[grade].hourlyRate;
                gradeRates[grade].dailyRate = newRates[grade].dailyRate;
                gradeRates[grade].monthlyRate = newRates[grade].monthlyRate;
            });
            
            closeModal('editRatesModal');
            renderRatesDisplay();
            renderStaffList();
            
            alert(`âœ… ë‹¨ê°€ê°€ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤!\n\në³€ê²½ì: ${currentUser.name}\në³€ê²½ ì‹œê°„: ${history.changedAt}\n\nğŸ’¡ ë³€ê²½ ì´ë ¥ì€ [ë³€ê²½ ì´ë ¥] ë²„íŠ¼ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.`);
        }

        // Open Rate History Modal
        function openRateHistoryModal() {
            renderRateHistory();
            openModal('rateHistoryModal');
        }

        // ==========================================
        // System Settings Functions
        // ==========================================
        
        // Open System Settings Modal
        function openSystemSettingsModal() {
            document.getElementById('threshold-input').value = systemSettings.estimateConfirmationThreshold;
            document.getElementById('current-threshold-display').textContent = 
                `â‚©${systemSettings.estimateConfirmationThreshold.toLocaleString()}`;
            openModal('systemSettingsModal');
        }
        
        // Save System Settings
        function saveSystemSettings() {
            const newThreshold = parseInt(document.getElementById('threshold-input').value);
            
            if (isNaN(newThreshold) || newThreshold < 0) {
                alert('âš ï¸ ì˜¬ë°”ë¥¸ ê¸ˆì•¡ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            const oldThreshold = systemSettings.estimateConfirmationThreshold;
            
            if (confirm(`ê²¬ì  í™•ì¸ í•„ìš” ê¸ˆì•¡ì„ ë³€ê²½í•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n\nì´ì „: â‚©${oldThreshold.toLocaleString()}\në³€ê²½: â‚©${newThreshold.toLocaleString()}\n\nì´ ê¸ˆì•¡ ì´ìƒì˜ ê²¬ì ì€ ì‹ ì²­ì í™•ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.`)) {
                systemSettings.estimateConfirmationThreshold = newThreshold;
                
                // UI ì—…ë°ì´íŠ¸
                updateThresholdDisplay();
                
                closeModal('systemSettingsModal');
                
                alert(`âœ… ì„¤ì •ì´ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤!\n\nê²¬ì  í™•ì¸ í•„ìš” ê¸ˆì•¡: â‚©${newThreshold.toLocaleString()}`);
                
                console.log(`âœ… ì‹œìŠ¤í…œ ì„¤ì • ë³€ê²½: ê²¬ì í™•ì¸ ê¸ˆì•¡ ${oldThreshold} â†’ ${newThreshold} by ${currentUser.name}`);
            }
        }
        
        // Update Threshold Display
        function updateThresholdDisplay() {
            const threshold = systemSettings.estimateConfirmationThreshold;
            const display1 = document.getElementById('threshold-amount');
            const display2 = document.getElementById('threshold-amount-2');
            
            if (display1) display1.textContent = threshold.toLocaleString();
            if (display2) display2.textContent = `â‚©${threshold.toLocaleString()}`;
        }

        // Render Rate History
        function renderRateHistory() {
            const container = document.getElementById('rate-history-list');
            if (!container) return;
            
            if (rateHistory.length === 0) {
                container.innerHTML = '<p class="text-center text-gray-500 py-8">ë³€ê²½ ì´ë ¥ì´ ì—†ìŠµë‹ˆë‹¤.</p>';
                return;
            }
            
            container.innerHTML = rateHistory.map((history, index) => `
                <div class="bg-white border ${index === 0 ? 'border-blue-300' : 'border-gray-200'} rounded-lg p-4 ${index === 0 ? 'ring-2 ring-blue-200' : ''}">
                    <div class="flex items-start justify-between mb-3">
                        <div>
                            <div class="flex items-center space-x-2 mb-1">
                                ${index === 0 ? '<span class="px-2 py-1 bg-blue-100 text-blue-700 text-xs font-semibold rounded">í˜„ì¬ ì ìš©ì¤‘</span>' : ''}
                                <span class="text-sm font-semibold text-gray-800">${history.changedAt}</span>
                            </div>
                            <div class="text-xs text-gray-600">
                                <i class="fas fa-user mr-1"></i>ë³€ê²½ì: ${history.changedBy}
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-gray-50 rounded-lg p-3 mb-3">
                        <div class="grid grid-cols-4 gap-3 text-xs">
                            ${['íŠ¹ê¸‰', 'ê³ ê¸‰', 'ì¤‘ê¸‰', 'ì´ˆê¸‰'].map(grade => {
                                const rate = history.rates[grade];
                                return `
                                    <div>
                                        <div class="font-semibold text-gray-700 mb-1">${grade}</div>
                                        <div class="text-gray-600 space-y-0.5">
                                            <div>ì‹œê¸‰: â‚©${rate.hourlyRate.toLocaleString()}</div>
                                            <div>ì¼ê¸‰: â‚©${rate.dailyRate.toLocaleString()}</div>
                                            <div>ì›”ê¸‰: â‚©${rate.monthlyRate.toLocaleString()}</div>
                                        </div>
                                    </div>
                                `;
                            }).join('')}
                        </div>
                    </div>
                    
                    <div class="text-sm text-gray-700">
                        <i class="fas fa-comment-dots text-blue-500 mr-2"></i>
                        <strong>ì‚¬ìœ :</strong> ${history.note}
                    </div>
                </div>
            `).join('');
        }

        // Render Staff List
        function renderStaffList() {
            const container = document.getElementById('staff-list');
            if (!container) return;
            
            container.innerHTML = itStaff.map(staff => `
                <tr>
                    <td class="font-semibold text-gray-800">${staff.name}</td>
                    <td class="text-gray-600">${staff.role}</td>
                    <td class="text-center">${staff.yearsOfExperience}ë…„</td>
                    <td>
                        <span class="inline-block px-3 py-1 rounded-full text-xs font-semibold
                            ${staff.grade === 'íŠ¹ê¸‰' ? 'bg-purple-100 text-purple-700' : 
                              staff.grade === 'ê³ ê¸‰' ? 'bg-blue-100 text-blue-700' : 
                              staff.grade === 'ì¤‘ê¸‰' ? 'bg-green-100 text-green-700' : 
                              'bg-gray-100 text-gray-700'}">
                            ${staff.grade}
                        </span>
                    </td>
                    <td class="text-right font-semibold text-gray-700">â‚©${staff.hourlyRate.toLocaleString()}</td>
                    <td class="text-right font-semibold text-gray-700">â‚©${staff.dailyRate.toLocaleString()}</td>
                    <td class="text-right font-semibold text-gray-700">â‚©${staff.monthlyRate.toLocaleString()}</td>
                    <td>
                        <span class="inline-block px-3 py-1 rounded bg-blue-50 text-blue-700 text-xs font-semibold">
                            ${staff.category}
                        </span>
                    </td>
                    <td class="text-center">
                        <button onclick="openEditStaffModal(${staff.id})" 
                            class="px-3 py-1 bg-blue-500 text-white rounded hover:bg-blue-600 transition text-sm mr-2">
                            <i class="fas fa-edit mr-1"></i>ìˆ˜ì •
                        </button>
                        <button onclick="deleteStaff(${staff.id})" 
                            class="px-3 py-1 bg-red-500 text-white rounded hover:bg-red-600 transition text-sm">
                            <i class="fas fa-trash mr-1"></i>ì‚­ì œ
                        </button>
                    </td>
                </tr>
            `).join('');
        }

        // Open Edit Staff Modal
        function openEditStaffModal(staffId) {
            const staff = itStaff.find(s => s.id === staffId);
            if (!staff) return;
            
            document.getElementById('edit-staff-id').value = staff.id;
            document.getElementById('edit-staff-name').value = staff.name;
            document.getElementById('edit-staff-role').value = staff.role;
            document.getElementById('edit-staff-years').value = staff.yearsOfExperience;
            document.getElementById('edit-staff-grade').value = staff.grade;
            document.getElementById('edit-staff-category').value = staff.category;
            
            updateStaffRatePreview();
            openModal('editStaffModal');
        }

        // Update Staff Rate Preview (Edit Modal)
        function updateStaffRatePreview() {
            const grade = document.getElementById('edit-staff-grade').value;
            const rates = gradeRates[grade];
            
            document.getElementById('preview-hourly').textContent = `â‚©${rates.hourlyRate.toLocaleString()}`;
            document.getElementById('preview-daily').textContent = `â‚©${rates.dailyRate.toLocaleString()}`;
            document.getElementById('preview-monthly').textContent = `â‚©${rates.monthlyRate.toLocaleString()}`;
        }

        // Save Staff Edit
        function saveStaffEdit() {
            const staffId = parseInt(document.getElementById('edit-staff-id').value);
            const staff = itStaff.find(s => s.id === staffId);
            if (!staff) return;
            
            staff.yearsOfExperience = parseInt(document.getElementById('edit-staff-years').value);
            staff.grade = document.getElementById('edit-staff-grade').value;
            staff.category = document.getElementById('edit-staff-category').value;
            
            closeModal('editStaffModal');
            renderStaffList();
            
            alert(`âœ… ${staff.name}ì˜ ì •ë³´ê°€ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.\në“±ê¸‰: ${staff.grade}\nëŒ€ë¶„ë¥˜: ${staff.category}`);
        }

        // Open Add Staff Modal
        function openAddStaffModal() {
            document.getElementById('add-staff-name').value = '';
            document.getElementById('add-staff-role').value = '';
            document.getElementById('add-staff-years').value = '3';
            document.getElementById('add-staff-grade').value = 'ì¤‘ê¸‰';
            document.getElementById('add-staff-category').value = 'ì˜¤ì•„ì‹œìŠ¤';
            
            updateAddStaffRatePreview();
            openModal('addStaffModal');
        }

        // Update Add Staff Rate Preview
        function updateAddStaffRatePreview() {
            const grade = document.getElementById('add-staff-grade').value;
            const rates = gradeRates[grade];
            
            document.getElementById('add-preview-hourly').textContent = `â‚©${rates.hourlyRate.toLocaleString()}`;
            document.getElementById('add-preview-daily').textContent = `â‚©${rates.dailyRate.toLocaleString()}`;
            document.getElementById('add-preview-monthly').textContent = `â‚©${rates.monthlyRate.toLocaleString()}`;
        }

        // Save New Staff
        function saveNewStaff() {
            const name = document.getElementById('add-staff-name').value.trim();
            const role = document.getElementById('add-staff-role').value.trim();
            const years = parseInt(document.getElementById('add-staff-years').value);
            const grade = document.getElementById('add-staff-grade').value;
            const category = document.getElementById('add-staff-category').value;
            
            if (!name || !role) {
                alert('âš ï¸ ì´ë¦„ê³¼ ì—­í• ì€ í•„ìˆ˜ ì…ë ¥ í•­ëª©ì…ë‹ˆë‹¤.');
                return;
            }
            
            const newStaff = {
                id: itStaffIdCounter++,
                name: name,
                role: role,
                yearsOfExperience: years,
                category: category,
                grade: grade,
                get hourlyRate() { return gradeRates[this.grade].hourlyRate; },
                get dailyRate() { return gradeRates[this.grade].dailyRate; },
                get monthlyRate() { return gradeRates[this.grade].monthlyRate; }
            };
            
            itStaff.push(newStaff);
            
            closeModal('addStaffModal');
            renderStaffList();
            
            alert(`âœ… ìƒˆ ì§ì›ì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤!\nì´ë¦„: ${name}\nì—­í• : ${role}\në“±ê¸‰: ${grade}\nëŒ€ë¶„ë¥˜: ${category}`);
        }

        // Delete Staff
        function deleteStaff(staffId) {
            const staff = itStaff.find(s => s.id === staffId);
            if (!staff) return;
            
            if (!confirm(`âš ï¸ ${staff.name} ì§ì›ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n\nì‚­ì œ í›„ì—ëŠ” ë³µêµ¬í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.`)) {
                return;
            }
            
            const index = itStaff.findIndex(s => s.id === staffId);
            itStaff.splice(index, 1);
            
            renderStaffList();
            alert(`âœ… ${staff.name} ì§ì›ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.`);
        }

        // Demo Data Auto-fill Functions
        const demoTickets = [
            {
                title: 'íšŒì›ê°€ì… ì˜¤ë¥˜ ìˆ˜ì •',
                description: 'íŠ¹ì • ì´ë©”ì¼ ë„ë©”ì¸(@company.com)ìœ¼ë¡œ íšŒì›ê°€ì… ì‹œ ì¸ì¦ ë©”ì¼ì´ ë°œì†¡ë˜ì§€ ì•ŠëŠ” ë¬¸ì œê°€ ìˆìŠµë‹ˆë‹¤. ê¸´ê¸‰í•˜ê²Œ í•´ê²°ì´ í•„ìš”í•©ë‹ˆë‹¤.',
                priority: 'ë†’ìŒ',
                daysFromNow: 5
            },
            {
                title: 'ëŒ€ì‹œë³´ë“œ ì„±ëŠ¥ ê°œì„ ',
                description: 'ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ ë¡œë”© ì†ë„ê°€ 10ì´ˆ ì´ìƒ ì†Œìš”ë©ë‹ˆë‹¤. ì¿¼ë¦¬ ìµœì í™” ë˜ëŠ” ìºì‹± ì ìš©ì´ í•„ìš”í•©ë‹ˆë‹¤.',
                priority: 'ë³´í†µ',
                daysFromNow: 14
            },
            {
                title: 'ëª¨ë°”ì¼ ì•± UI ê°œì„ ',
                description: 'ì‚¬ìš©ì í”¼ë“œë°±ì„ ë°˜ì˜í•˜ì—¬ ë©”ì¸ í™”ë©´ì˜ UI/UXë¥¼ ê°œì„ í•´ì£¼ì„¸ìš”. ì²¨ë¶€í•œ ë””ìì¸ ì‹œì•ˆì„ ì°¸ê³ í•´ì£¼ì„¸ìš”.',
                priority: 'ë³´í†µ',
                daysFromNow: 21
            },
            {
                title: 'ì£¼ê°„ ë³´ê³ ì„œ ìë™í™”',
                description: 'ë§¤ì£¼ ì›”ìš”ì¼ ìë™ìœ¼ë¡œ ì£¼ê°„ ì‹¤ì  ë³´ê³ ì„œê°€ ìƒì„±ë˜ë„ë¡ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‘ì„±í•´ì£¼ì„¸ìš”.',
                priority: 'ë‚®ìŒ',
                daysFromNow: 30
            },
            {
                title: 'ê²°ì œ ì‹œìŠ¤í…œ ì˜¤ë¥˜',
                description: 'ì¹´ë“œ ê²°ì œ ì‹œ ê°„í—ì ìœ¼ë¡œ 500 ì—ëŸ¬ê°€ ë°œìƒí•©ë‹ˆë‹¤. ë¡œê·¸ë¥¼ í™•ì¸í•˜ê³  ì›ì¸ì„ íŒŒì•…í•´ì£¼ì„¸ìš”.',
                priority: 'ë†’ìŒ',
                daysFromNow: 3
            }
        ];

        const demoSubtasks = [
            {
                title: 'API ì—”ë“œí¬ì¸íŠ¸ ê°œë°œ',
                description: 'RESTful API ì„¤ê³„ ë° êµ¬í˜„',
                assignee: 'ê¹€ê°œë°œ',
                startDaysFromNow: 0,
                endDaysFromNow: 3
            },
            {
                title: 'ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ ì„¤ê³„',
                description: 'í…Œì´ë¸” êµ¬ì¡° ì„¤ê³„ ë° ì¸ë±ìŠ¤ ìµœì í™”',
                assignee: 'ê¹€ê°œë°œ',
                startDaysFromNow: 0,
                endDaysFromNow: 2
            },
            {
                title: 'í”„ë¡ íŠ¸ì—”ë“œ ì»´í¬ë„ŒíŠ¸ ê°œë°œ',
                description: 'React ì»´í¬ë„ŒíŠ¸ êµ¬í˜„ ë° ìƒíƒœ ê´€ë¦¬',
                assignee: 'ì´í”„ë¡ íŠ¸',
                startDaysFromNow: 3,
                endDaysFromNow: 7
            },
            {
                title: 'UI/UX ë””ìì¸ ì‹œì•ˆ ì‘ì„±',
                description: 'Figmaë¡œ ë””ìì¸ ì‹œì•ˆ ì‘ì—…',
                assignee: 'ë°•ë””ìì¸',
                startDaysFromNow: 0,
                endDaysFromNow: 3
            },
            {
                title: 'ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ì‘ì„±',
                description: 'Jestë¥¼ ì´ìš©í•œ í…ŒìŠ¤íŠ¸ ì½”ë“œ ì‘ì„±',
                assignee: 'ì´í”„ë¡ íŠ¸',
                startDaysFromNow: 5,
                endDaysFromNow: 8
            },
            {
                title: 'ì„œë²„ ë°°í¬ ë° ëª¨ë‹ˆí„°ë§ ì„¤ì •',
                description: 'AWS ë°°í¬ ë° CloudWatch ì„¤ì •',
                assignee: 'ìµœì¸í”„ë¼',
                startDaysFromNow: 8,
                endDaysFromNow: 10
            },
            {
                title: 'ì‚¬ìš©ì ì‹œë‚˜ë¦¬ì˜¤ ë¬¸ì„œí™”',
                description: 'ê¸°íšì„œ ë° ì‚¬ìš©ì ë§¤ë‰´ì–¼ ì‘ì„±',
                assignee: 'ì •ê¸°íš',
                startDaysFromNow: 0,
                endDaysFromNow: 2
            },
            {
                title: 'í†µí•© í…ŒìŠ¤íŠ¸',
                description: 'ì „ì²´ ì‹œìŠ¤í…œ í†µí•© í…ŒìŠ¤íŠ¸ ìˆ˜í–‰',
                assignee: 'ê¹€ê°œë°œ',
                startDaysFromNow: 10,
                endDaysFromNow: 12
            }
        ];

        function fillDemoTicketData() {
            const randomTicket = demoTickets[Math.floor(Math.random() * demoTickets.length)];
            const form = document.getElementById('newTicketForm');
            
            form.title.value = randomTicket.title;
            form.description.value = randomTicket.description;
            form.priority.value = randomTicket.priority;
            
            // Calculate due date
            const dueDate = new Date();
            dueDate.setDate(dueDate.getDate() + randomTicket.daysFromNow);
            form.dueDate.value = dueDate.toISOString().split('T')[0];
        }

        function fillDemoSubtaskData() {
            const randomSubtask = demoSubtasks[Math.floor(Math.random() * demoSubtasks.length)];
            const form = document.getElementById('addSubtaskForm');
            
            form.title.value = randomSubtask.title;
            form.description.value = randomSubtask.description;
            form.assignee.value = randomSubtask.assignee;
            
            // Calculate start date
            const startDate = new Date();
            startDate.setDate(startDate.getDate() + randomSubtask.startDaysFromNow);
            form.startDate.value = startDate.toISOString().split('T')[0];
            
            // Calculate end date
            const endDate = new Date();
            endDate.setDate(endDate.getDate() + randomSubtask.endDaysFromNow);
            form.endDate.value = endDate.toISOString().split('T')[0];
        }

        // Quick Actions for Demo
        function quickAssignRandom(ticketId) {
            const ticket = tickets.find(t => t.id === ticketId);
            if (!ticket) return;
            
            const allAssignees = ['ê¹€ê°œë°œ', 'ì´í”„ë¡ íŠ¸', 'ë°•ë””ìì¸', 'ìµœì¸í”„ë¼', 'ì •ê¸°íš'];
            const randomCount = Math.floor(Math.random() * 2) + 1; // 1-2ëª… ëœë¤
            const shuffled = allAssignees.sort(() => 0.5 - Math.random());
            ticket.assignees = shuffled.slice(0, randomCount);
            
            renderAdminView();
            if (currentRole === 'user') {
                renderUserView();
            }
        }

        function addRandomSubtasks(ticketId, count = 3) {
            const ticket = tickets.find(t => t.id === ticketId);
            if (!ticket) return;
            
            const shuffled = [...demoSubtasks].sort(() => 0.5 - Math.random()).slice(0, count);
            
            shuffled.forEach(demo => {
                const startDate = new Date();
                startDate.setDate(startDate.getDate() + demo.startDaysFromNow);
                
                const endDate = new Date();
                endDate.setDate(endDate.getDate() + demo.endDaysFromNow);
                
                const subtask = {
                    id: 'st' + Date.now() + Math.random(),
                    title: demo.title,
                    description: demo.description,
                    assignee: demo.assignee,
                    startDate: startDate.toISOString().split('T')[0],
                    endDate: endDate.toISOString().split('T')[0],
                    status: Math.random() > 0.5 ? 'ì§„í–‰ì¤‘' : 'ì™„ë£Œ'
                };
                
                ticket.subtasks.push(subtask);
            });
            
            // Update ticket due date
            const maxEndDate = ticket.subtasks.reduce((max, st) => {
                const stEndDate = new Date(st.endDate);
                return stEndDate > max ? stEndDate : max;
            }, new Date());
            
            ticket.dueDate = maxEndDate.toISOString().split('T')[0];
            
            renderAdminView();
        }

        // Generate Bulk Demo Tickets
        function generateBulkDemoTickets() {
            if (!confirm('ì‹œì—°ìš© í‹°ì¼“ 5ê°œë¥¼ ìë™ìœ¼ë¡œ ìƒì„±í•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n(ë‹¤ì–‘í•œ ìƒíƒœì˜ í‹°ì¼“ë“¤ì´ ìƒì„±ë©ë‹ˆë‹¤)')) {
                return;
            }

            const requesters = ['í™ê¸¸ë™', 'ê¹€ì² ìˆ˜', 'ì´ì˜í¬', 'ë°•ë¯¼ìˆ˜', 'ì •ìˆ˜ì§„'];
            const departments = ['ìš´ì˜íŒ€', 'ë§ˆì¼€íŒ…íŒ€', 'ì¬ë¬´íŒ€', 'ì¸ì‚¬íŒ€', 'ì˜ì—…íŒ€'];
            const statuses = ['ìš”ì²­', 'ì ‘ìˆ˜', 'ì²˜ë¦¬ì¤‘', 'ì™„ë£Œ', 'ë³´ë¥˜'];
            const allAssignees = ['ê¹€ê°œë°œ', 'ì´í”„ë¡ íŠ¸', 'ë°•ë””ìì¸', 'ìµœì¸í”„ë¼', 'ì •ê¸°íš'];

            demoTickets.forEach((demoTicket, index) => {
                const randomRequester = requesters[index % requesters.length];
                const randomDepartment = departments[index % departments.length];
                const randomStatus = statuses[index % statuses.length];
                
                const dueDate = new Date();
                dueDate.setDate(dueDate.getDate() + demoTicket.daysFromNow);
                
                const createdDate = new Date();
                createdDate.setDate(createdDate.getDate() - Math.floor(Math.random() * 5));

                const newTicket = {
                    id: ticketIdCounter++,
                    ticketNumber: `TKT-2024-${String(ticketIdCounter).padStart(3, '0')}`,
                    title: demoTicket.title,
                    description: demoTicket.description,
                    requester: randomRequester,
                    department: randomDepartment,
                    status: randomStatus,
                    priority: demoTicket.priority,
                    assignees: [],
                    createdAt: createdDate.toISOString().split('T')[0],
                    dueDate: dueDate.toISOString().split('T')[0],
                    subtasks: []
                };

                // Add assignees for non-request status
                if (randomStatus !== 'ìš”ì²­') {
                    const assigneeCount = Math.floor(Math.random() * 2) + 1;
                    const shuffled = [...allAssignees].sort(() => 0.5 - Math.random());
                    newTicket.assignees = shuffled.slice(0, assigneeCount);

                    // Add subtasks for in-progress or completed tickets
                    if (randomStatus === 'ì²˜ë¦¬ì¤‘' || randomStatus === 'ì™„ë£Œ') {
                        const subtaskCount = Math.floor(Math.random() * 3) + 2;
                        const shuffledSubtasks = [...demoSubtasks].sort(() => 0.5 - Math.random()).slice(0, subtaskCount);
                        
                        shuffledSubtasks.forEach(demo => {
                            const startDate = new Date(createdDate);
                            startDate.setDate(startDate.getDate() + demo.startDaysFromNow);
                            
                            const endDate = new Date(createdDate);
                            endDate.setDate(endDate.getDate() + demo.endDaysFromNow);
                            
                            const subtask = {
                                id: 'st' + Date.now() + Math.random(),
                                title: demo.title,
                                description: demo.description,
                                assignee: demo.assignee,
                                startDate: startDate.toISOString().split('T')[0],
                                endDate: endDate.toISOString().split('T')[0],
                                status: randomStatus === 'ì™„ë£Œ' ? 'ì™„ë£Œ' : (Math.random() > 0.3 ? 'ì§„í–‰ì¤‘' : 'ì™„ë£Œ')
                            };
                            
                            newTicket.subtasks.push(subtask);
                        });
                    }
                }

                tickets.push(newTicket);
            });

            // Refresh views
            if (currentRole === 'user') {
                renderUserView();
            } else {
                renderAdminView();
            }

            alert('âœ… ì‹œì—°ìš© í‹°ì¼“ 5ê°œê°€ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤!\n\nê°ê° ë‹¤ë¥¸ ìƒíƒœ(ìš”ì²­/ì ‘ìˆ˜/ì²˜ë¦¬ì¤‘/ì™„ë£Œ/ë³´ë¥˜)ë¡œ ìƒì„±ë˜ì–´ ì¹¸ë°˜ ë³´ë“œì™€ ê°„íŠ¸ì°¨íŠ¸ì—ì„œ í™•ì¸í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
        }

        // Gantt Quick Edit Functions
        let currentEditSubtask = null;
        let currentEditTicket = null;

        function openSubtaskQuickEdit(ticketId, subtaskId) {
            const ticket = tickets.find(t => t.id === ticketId);
            if (!ticket) return;
            
            const subtask = ticket.subtasks.find(s => s.id === subtaskId);
            if (!subtask) return;
            
            currentEditTicket = ticket;
            currentEditSubtask = subtask;
            
            const content = document.getElementById('ganttQuickEditContent');
            content.innerHTML = `
                <div class="bg-blue-50 border border-blue-200 rounded-lg p-3 mb-4">
                    <div class="text-sm text-blue-800 font-semibold">${ticket.title}</div>
                    <div class="text-xs text-blue-600 mt-1">${ticket.ticketNumber}</div>
                </div>
                
                <div>
                    <label class="block text-sm font-semibold text-gray-700 mb-2">ì—…ë¬´ëª…</label>
                    <input type="text" id="quickEditTitle" value="${subtask.title}" 
                           class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                </div>
                
                <div>
                    <label class="block text-sm font-semibold text-gray-700 mb-2">ë‹´ë‹¹ì</label>
                    <select id="quickEditAssignee" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                        <option value="ê¹€ê°œë°œ" ${subtask.assignee === 'ê¹€ê°œë°œ' ? 'selected' : ''}>ê¹€ê°œë°œ</option>
                        <option value="ì´í”„ë¡ íŠ¸" ${subtask.assignee === 'ì´í”„ë¡ íŠ¸' ? 'selected' : ''}>ì´í”„ë¡ íŠ¸</option>
                        <option value="ë°•ë””ìì¸" ${subtask.assignee === 'ë°•ë””ìì¸' ? 'selected' : ''}>ë°•ë””ìì¸</option>
                        <option value="ìµœì¸í”„ë¼" ${subtask.assignee === 'ìµœì¸í”„ë¼' ? 'selected' : ''}>ìµœì¸í”„ë¼</option>
                        <option value="ì •ê¸°íš" ${subtask.assignee === 'ì •ê¸°íš' ? 'selected' : ''}>ì •ê¸°íš</option>
                    </select>
                </div>
                
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">ì‹œì‘ì¼</label>
                        <input type="date" id="quickEditStartDate" value="${subtask.startDate}" 
                               class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">ì¢…ë£Œì¼</label>
                        <input type="date" id="quickEditEndDate" value="${subtask.endDate}" 
                               class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                </div>
                
                <div>
                    <label class="block text-sm font-semibold text-gray-700 mb-2">
                        <i class="fas fa-clock text-blue-500 mr-1"></i>
                        ì‹¤ì œ ì†Œìš” ì‹œê°„ (ë§¨ë°ì´ ê³„ì‚°ìš©)
                    </label>
                    <div class="flex items-center space-x-2">
                        <input type="number" id="quickEditActualHours" value="${subtask.actualHours || 0}" min="0" step="0.5"
                               class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                        <span class="text-gray-600 font-semibold">ì‹œê°„</span>
                    </div>
                    ${subtask.actualHours && subtask.assignee ? (() => {
                        const staff = itStaff.find(s => s.name === subtask.assignee);
                        if (staff) {
                            const cost = subtask.actualHours * staff.hourlyRate;
                            return `
                                <div class="mt-2 text-sm text-blue-600 bg-blue-50 px-3 py-2 rounded">
                                    ğŸ’° ì˜ˆìƒ ë¹„ìš©: <strong>â‚©${cost.toLocaleString()}</strong> 
                                    (â‚©${staff.hourlyRate.toLocaleString()}/h Ã— ${subtask.actualHours}h)
                                </div>
                            `;
                        }
                        return '';
                    })() : ''}
                </div>
                
                <div>
                    <label class="block text-sm font-semibold text-gray-700 mb-2">ìƒíƒœ</label>
                    <div class="flex space-x-3">
                        <label class="flex items-center cursor-pointer">
                            <input type="radio" name="quickEditStatus" value="ì§„í–‰ì¤‘" ${subtask.status === 'ì§„í–‰ì¤‘' ? 'checked' : ''} 
                                   class="mr-2">
                            <span class="text-sm">ì§„í–‰ì¤‘</span>
                        </label>
                        <label class="flex items-center cursor-pointer">
                            <input type="radio" name="quickEditStatus" value="ì™„ë£Œ" ${subtask.status === 'ì™„ë£Œ' ? 'checked' : ''} 
                                   class="mr-2">
                            <span class="text-sm">ì™„ë£Œ</span>
                        </label>
                        <label class="flex items-center cursor-pointer">
                            <input type="radio" name="quickEditStatus" value="ë³´ë¥˜" ${subtask.status === 'ë³´ë¥˜' ? 'checked' : ''} 
                                   class="mr-2">
                            <span class="text-sm">ë³´ë¥˜</span>
                        </label>
                    </div>
                </div>
            `;
            
            openModal('ganttQuickEditModal');
        }

        function saveSubtaskQuickEdit() {
            if (!currentEditSubtask || !currentEditTicket) return;
            
            const title = document.getElementById('quickEditTitle').value;
            const assignee = document.getElementById('quickEditAssignee').value;
            const startDate = document.getElementById('quickEditStartDate').value;
            const endDate = document.getElementById('quickEditEndDate').value;
            const status = document.querySelector('input[name="quickEditStatus"]:checked').value;
            const actualHours = parseFloat(document.getElementById('quickEditActualHours').value) || 0;
            
            // Validation
            if (!title || !startDate || !endDate) {
                alert('ëª¨ë“  í•„ë“œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            if (new Date(startDate) > new Date(endDate)) {
                alert('ì¢…ë£Œì¼ì€ ì‹œì‘ì¼ë³´ë‹¤ ëŠ¦ì–´ì•¼ í•©ë‹ˆë‹¤.');
                return;
            }
            
            // Update subtask
            currentEditSubtask.title = title;
            currentEditSubtask.assignee = assignee;
            currentEditSubtask.startDate = startDate;
            currentEditSubtask.endDate = endDate;
            currentEditSubtask.status = status;
            currentEditSubtask.actualHours = actualHours;
            
            // Update ticket due date if needed
            const maxEndDate = currentEditTicket.subtasks.reduce((max, st) => {
                if (!st.endDate) return max;
                const stEndDate = new Date(st.endDate);
                return stEndDate > max ? stEndDate : max;
            }, new Date(currentEditTicket.dueDate || '2024-01-01'));
            
            currentEditTicket.dueDate = maxEndDate.toISOString().split('T')[0];
            
            // ğŸ¯ í‹°ì¼“ ìƒíƒœ ìë™ ì—…ë°ì´íŠ¸
            updateTicketStatusFromSubtasks(currentEditTicket.id);
            
            closeModal('ganttQuickEditModal');
            renderAdminView();
            
            alert('âœ… ì¼ì •ì´ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤!');
        }

        // Context Menu Functions
        let contextMenuTicketId = null;
        let contextMenuSubtaskId = null;

        function openSubtaskContextMenu(event, ticketId, subtaskId) {
            contextMenuTicketId = ticketId;
            contextMenuSubtaskId = subtaskId;
            
            const menu = document.getElementById('ganttContextMenu');
            menu.style.left = event.pageX + 'px';
            menu.style.top = event.pageY + 'px';
            menu.classList.remove('hidden');
            
            // Close menu when clicking outside
            setTimeout(() => {
                document.addEventListener('click', closeContextMenu);
            }, 0);
        }

        function closeContextMenu() {
            const menu = document.getElementById('ganttContextMenu');
            menu.classList.add('hidden');
            document.removeEventListener('click', closeContextMenu);
        }

        function contextMenuAction(action) {
            closeContextMenu();
            
            const ticket = tickets.find(t => t.id === contextMenuTicketId);
            if (!ticket) return;
            
            const subtask = ticket.subtasks.find(s => s.id === contextMenuSubtaskId);
            if (!subtask) return;
            
            switch(action) {
                case 'edit':
                    openSubtaskQuickEdit(contextMenuTicketId, contextMenuSubtaskId);
                    break;
                    
                case 'complete':
                    subtask.status = 'ì™„ë£Œ';
                    renderAdminView();
                    alert('âœ… ì—…ë¬´ê°€ ì™„ë£Œ ì²˜ë¦¬ë˜ì—ˆìŠµë‹ˆë‹¤!');
                    break;
                    
                case 'detail':
                    openTicketDetail(contextMenuTicketId);
                    break;
                    
                case 'delete':
                    if (confirm('ì´ í•˜ìœ„ ì—…ë¬´ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                        const index = ticket.subtasks.findIndex(s => s.id === contextMenuSubtaskId);
                        if (index > -1) {
                            ticket.subtasks.splice(index, 1);
                            renderAdminView();
                            alert('âœ… í•˜ìœ„ ì—…ë¬´ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤!');
                        }
                    }
                    break;
            }
        }

        // Link Ticket Functions
        let currentLinkingTicketId = null;
        let selectedLinkTickets = [];

        function openLinkTicketModal(ticketId) {
            currentLinkingTicketId = ticketId;
            selectedLinkTickets = [];
            document.getElementById('linkTicketSearch').value = '';
            document.getElementById('linkTicketCategoryFilter').value = '';
            searchLinkableTickets();
            openModal('linkTicketModal');
        }

        function searchLinkableTickets() {
            const searchTerm = document.getElementById('linkTicketSearch').value.toLowerCase();
            const categoryFilter = document.getElementById('linkTicketCategoryFilter').value;
            const currentTicket = tickets.find(t => t.id === currentLinkingTicketId);
            
            if (!currentTicket) return;
            
            // í˜„ì¬ í‹°ì¼“ê³¼ ì´ë¯¸ ì—°ê²°ëœ í‹°ì¼“ ì œì™¸
            const alreadyLinked = currentTicket.linkedTickets || [];
            
            const filteredTickets = tickets.filter(t => {
                if (t.id === currentLinkingTicketId) return false; // ìê¸° ìì‹  ì œì™¸
                if (alreadyLinked.includes(t.id)) return false; // ì´ë¯¸ ì—°ê²°ëœ í‹°ì¼“ ì œì™¸
                
                // ê²€ìƒ‰ì–´ í•„í„°
                const matchesSearch = !searchTerm || 
                    t.ticketNumber.toLowerCase().includes(searchTerm) ||
                    t.title.toLowerCase().includes(searchTerm) ||
                    (t.description && t.description.toLowerCase().includes(searchTerm));
                
                // ì¹´í…Œê³ ë¦¬ í•„í„°
                const matchesCategory = !categoryFilter || t.category === categoryFilter;
                
                return matchesSearch && matchesCategory;
            });
            
            const container = document.getElementById('linkableTicketsList');
            document.getElementById('linkTicketCount').textContent = `${filteredTickets.length}ê°œ`;
            
            if (filteredTickets.length === 0) {
                container.innerHTML = '<p class="text-center text-gray-500 py-8">ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤</p>';
                return;
            }
            
            container.innerHTML = filteredTickets.map(ticket => `
                <div class="border rounded-lg p-4 hover:bg-blue-50 transition cursor-pointer ${selectedLinkTickets.includes(ticket.id) ? 'bg-blue-100 border-blue-500' : 'border-gray-200'}" 
                     onclick="toggleLinkTicket(${ticket.id})">
                    <div class="flex items-start justify-between">
                        <div class="flex-1">
                            <div class="flex items-center gap-2 mb-2">
                                <span class="font-mono text-xs text-blue-600 font-semibold">${ticket.ticketNumber}</span>
                                <span class="status-badge status-${ticket.status}">${ticket.status}</span>
                                <span class="text-xs bg-gray-200 text-gray-700 px-2 py-1 rounded">${ticket.category || 'ë¯¸ë¶„ë¥˜'}</span>
                            </div>
                            <h4 class="font-semibold text-gray-800 mb-1">${ticket.title}</h4>
                            <p class="text-sm text-gray-600 line-clamp-2">${ticket.description}</p>
                            <div class="flex items-center gap-3 mt-2 text-xs text-gray-500">
                                <span><i class="fas fa-user mr-1"></i>${ticket.requester}</span>
                                <span><i class="fas fa-calendar mr-1"></i>${ticket.createdAt}</span>
                                ${ticket.assignees.length > 0 ? `
                                    <span><i class="fas fa-users mr-1"></i>${ticket.assignees.join(', ')}</span>
                                ` : ''}
                            </div>
                        </div>
                        <div class="ml-4" onclick="event.stopPropagation(); toggleLinkTicket(${ticket.id});">
                            <input type="checkbox" ${selectedLinkTickets.includes(ticket.id) ? 'checked' : ''} 
                                   class="w-5 h-5 text-blue-600 pointer-events-none">
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function toggleLinkTicket(ticketId) {
            console.log('í‹°ì¼“ í† ê¸€:', ticketId);
            console.log('í˜„ì¬ ì„ íƒëœ í‹°ì¼“ë“¤:', selectedLinkTickets);
            
            const index = selectedLinkTickets.indexOf(ticketId);
            if (index > -1) {
                selectedLinkTickets.splice(index, 1);
                console.log('í‹°ì¼“ ì„ íƒ í•´ì œ:', ticketId);
            } else {
                selectedLinkTickets.push(ticketId);
                console.log('í‹°ì¼“ ì„ íƒ:', ticketId);
            }
            
            console.log('ì—…ë°ì´íŠ¸ í›„ ì„ íƒëœ í‹°ì¼“ë“¤:', selectedLinkTickets);
            searchLinkableTickets(); // UI ì—…ë°ì´íŠ¸
        }

        function saveLinkTickets() {
            console.log('ì—°ê²° ì €ì¥ ì‹œë„');
            console.log('ì„ íƒëœ í‹°ì¼“ ìˆ˜:', selectedLinkTickets.length);
            console.log('ì„ íƒëœ í‹°ì¼“ IDs:', selectedLinkTickets);
            
            if (selectedLinkTickets.length === 0) {
                alert('ì—°ê²°í•  í‹°ì¼“ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');
                return;
            }
            
            const currentTicket = tickets.find(t => t.id === currentLinkingTicketId);
            if (!currentTicket) {
                console.error('í˜„ì¬ í‹°ì¼“ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤:', currentLinkingTicketId);
                return;
            }
            
            console.log('í˜„ì¬ í‹°ì¼“:', currentTicket);
            
            // ì–‘ë°©í–¥ ì—°ê²° (í˜„ì¬ í‹°ì¼“ â†’ ì„ íƒ í‹°ì¼“, ì„ íƒ í‹°ì¼“ â†’ í˜„ì¬ í‹°ì¼“)
            if (!currentTicket.linkedTickets) currentTicket.linkedTickets = [];
            
            selectedLinkTickets.forEach(linkedId => {
                // í˜„ì¬ í‹°ì¼“ì— ì—°ê²°
                if (!currentTicket.linkedTickets.includes(linkedId)) {
                    currentTicket.linkedTickets.push(linkedId);
                }
                
                // ì„ íƒëœ í‹°ì¼“ì—ë„ ì—­ë°©í–¥ ì—°ê²°
                const linkedTicket = tickets.find(t => t.id === linkedId);
                if (linkedTicket) {
                    if (!linkedTicket.linkedTickets) linkedTicket.linkedTickets = [];
                    if (!linkedTicket.linkedTickets.includes(currentLinkingTicketId)) {
                        linkedTicket.linkedTickets.push(currentLinkingTicketId);
                    }
                }
            });
            
            console.log('ì—°ê²° ì™„ë£Œ');
            closeModal('linkTicketModal');
            openTicketDetail(currentLinkingTicketId); // ìƒì„¸ í™”ë©´ ìƒˆë¡œê³ ì¹¨
            
            alert(`âœ… ${selectedLinkTickets.length}ê°œì˜ í‹°ì¼“ì´ ì—°ê²°ë˜ì—ˆìŠµë‹ˆë‹¤!`);
        }

        function unlinkTicket(ticketId, linkedId) {
            if (!confirm('ì´ í‹°ì¼“ì˜ ì—°ê²°ì„ í•´ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;
            
            const ticket = tickets.find(t => t.id === ticketId);
            const linkedTicket = tickets.find(t => t.id === linkedId);
            
            // ì–‘ë°©í–¥ ì—°ê²° í•´ì œ
            if (ticket && ticket.linkedTickets) {
                ticket.linkedTickets = ticket.linkedTickets.filter(id => id !== linkedId);
            }
            
            if (linkedTicket && linkedTicket.linkedTickets) {
                linkedTicket.linkedTickets = linkedTicket.linkedTickets.filter(id => id !== ticketId);
            }
            
            openTicketDetail(ticketId); // ìƒì„¸ í™”ë©´ ìƒˆë¡œê³ ì¹¨
            alert('âœ… í‹°ì¼“ ì—°ê²°ì´ í•´ì œë˜ì—ˆìŠµë‹ˆë‹¤!');
        }

        // Modal helpers
        function openModal(modalId) {
            document.getElementById(modalId).classList.add('active');
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
        }
        
        // Date helpers
        function getCurrentDate() {
            const now = new Date();
            const year = now.getFullYear();
            const month = String(now.getMonth() + 1).padStart(2, '0');
            const day = String(now.getDate()).padStart(2, '0');
            return `${year}-${month}-${day}`;
        }
        
        function getCurrentDateTime() {
            return new Date().toLocaleString('ko-KR', { 
                year: 'numeric', 
                month: '2-digit', 
                day: '2-digit',
                hour: '2-digit',
                minute: '2-digit'
            });
        }
        
        // Quick Request (ë¹ ë¥¸ ì‹ ì²­)
        function quickRequest(category) {
            openNewTicketModal();
            // ì¤‘ë¶„ë¥˜ ìë™ ì„ íƒ
            document.getElementById('ticket-category').value = category;
            onCategoryChange(); // ì†Œë¶„ë¥˜ ì—…ë°ì´íŠ¸
        }
        
        // ğŸ†• ì¹´í…Œê³ ë¦¬ ì„ íƒ ì‹œìŠ¤í…œ
        let selectedMainCategory = '';
        let selectedSubCategory = '';
        
        // On Category Change (ì¤‘ë¶„ë¥˜ ë³€ê²½ ì‹œ ì†Œë¶„ë¥˜ ì—…ë°ì´íŠ¸)
        function onCategoryChange() {
            const category = document.getElementById('ticket-category').value;
            const subCategorySelect = document.getElementById('ticket-subcategory');
            
            // ì†Œë¶„ë¥˜ ì´ˆê¸°í™”
            subCategorySelect.innerHTML = '<option value="">ì„ íƒí•˜ì„¸ìš”</option>';
            
            // ì¤‘ë¶„ë¥˜ë³„ ì†Œë¶„ë¥˜ ë§¤í•‘
            const subCategoryMap = {
                'ì¥ì• ì‹ ê³ ': ['ì‹œìŠ¤í…œì¥ì• ', 'ë„¤íŠ¸ì›Œí¬ì¥ì• ', 'í”„ë¡œê·¸ë¨ì˜¤ë¥˜', 'ë³´ì•ˆì´ìŠˆ'],
                'ê°œë°œìš”ì²­': ['ì‹ ê·œ', 'ê¸°ëŠ¥ê°œì„ ', 'ë²„ê·¸', 'APIì—°ë™', 'ë°ì´í„°ì¶”ì¶œ'],
                'ìš´ì˜/ë³€ê²½ìš”ì²­': ['ì„¤ì •ë³€ê²½', 'ì¸í”„ë¼ë³€ê²½', 'ë°°í¬ìš”ì²­', 'DBë³€ê²½', 'ê³„ì •ìƒì„±', 'í™ˆí˜ì´ì§€ìˆ˜ì •'],
                'í”„ë¡œì íŠ¸': ['ë§ˆì´ê·¸ë ˆì´ì…˜', 'ì—…ê·¸ë ˆì´ë“œ', 'í†µí•©', 'ì‹ ê·œì‹œìŠ¤í…œêµ¬ì¶•'],
                'ì§€ì›ë¬¸ì˜': ['ì›ê²©ì§€ì›', 'êµìœ¡ìš”ì²­', 'ì‚¬ìš©ë²•ë¬¸ì˜', 'ê¸°ìˆ ë¬¸ì˜'],
                'ë””ìì¸ìš”ì²­': ['ì˜¨ë¼ì¸ë°°ë„ˆ', 'ì˜¨ë¼ì¸ì½˜í…ì¸ ', 'ì˜¤í”„ë¼ì¸ë°°ë„ˆ', 'í™ˆí˜ì´ì§€']
            };
            
            // ì†Œë¶„ë¥˜ ì˜µì…˜ ì¶”ê°€
            if (subCategoryMap[category]) {
                subCategoryMap[category].forEach(sub => {
                    const option = document.createElement('option');
                    option.value = sub;
                    option.textContent = sub;
                    subCategorySelect.appendChild(option);
                });
            }
        }
        
        // Open Category Modal (ëŒ€ë¶„ë¥˜ ì„ íƒ)
        function openCategoryModal(mainCategory) {
            selectedMainCategory = mainCategory;
            document.getElementById('selected-main-category').textContent = mainCategory;
            openModal('subCategoryModal');
        }
        
        // Select Sub Category (ì¤‘ë¶„ë¥˜ ì„ íƒ)
        function selectSubCategory(subCategory) {
            selectedSubCategory = subCategory;
            closeModal('subCategoryModal');
            
            // í‹°ì¼“ ì‹ ì²­ ëª¨ë‹¬ ì—´ê¸°
            openNewTicketModal();
            
            // ëŒ€ë¶„ë¥˜/ì¤‘ë¶„ë¥˜ ìë™ ì…ë ¥
            document.getElementById('ticket-main-category').value = selectedMainCategory;
            document.getElementById('ticket-category').value = selectedSubCategory;
            
            // ì†Œë¶„ë¥˜ ì—…ë°ì´íŠ¸
            onCategoryChange();
        }
        
        // Quick Asset Request (ìì‚° ë¹ ë¥¸ ì‹ ì²­) ğŸ†•
        function quickAssetRequest() {
            openModal('assetTypeModal');
        }
        
        // Select Asset Type (ìì‚° ìœ í˜• ì„ íƒ)
        function selectAssetType(type) {
            closeModal('assetTypeModal');
            
            if (type === 'í•˜ë“œì›¨ì–´') {
                openAssetHardwareModal();
            } else if (type === 'ì†Œí”„íŠ¸ì›¨ì–´') {
                openAssetSoftwareModal();
            } else if (type === 'í´ë¼ìš°ë“œ') {
                openAssetCloudModal();
            }
        }
        
        // Open Asset Hardware Modal (í•˜ë“œì›¨ì–´ ìš”ì²­ ëª¨ë‹¬)
        function openAssetHardwareModal() {
            // ì‚¬ìš©ì ì´ë¦„ í‘œì‹œ
            const nameElement = document.getElementById('current-user-name-hw');
            if (nameElement) {
                nameElement.textContent = currentUser.name;
            }
            
            // ìš”ì²­ ìœ í˜• ì´ˆê¸°í™” (ì‹ ê·œ ì§€ê¸‰)
            document.getElementById('asset-hw-type-new').checked = true;
            
            // ì‹ ê·œ ì§€ê¸‰ ì„¹ì…˜ í‘œì‹œ
            document.getElementById('hw-new-section').style.display = 'block';
            document.getElementById('hw-fault-section').style.display = 'none';
            document.getElementById('hw-change-section').style.display = 'none';
            
            // ì‚¬ìš©ì ì •ë³´ ì´ˆê¸°í™”
            document.getElementById('asset-hw-user-self').checked = true;
            document.getElementById('asset-hw-user-other-section').style.display = 'none';
            document.getElementById('asset-hw-user-other').value = '';
            
            // ì§ê¸‰ ì„¤ì •
            document.getElementById('asset-hw-grade').value = currentUser.grade || 'ê³¼ì¥';
            
            // ì¶”ì²œ ì¥ë¹„ ì—…ë°ì´íŠ¸
            updateRecommendedAssets();
            
            // ì‚¬ìœ  ì´ˆê¸°í™”
            document.getElementById('asset-hw-reason').value = '';
            
            openModal('assetHardwareModal');
        }
        
        // Request Type Change (ìš”ì²­ ìœ í˜• ë³€ê²½)
        function onHwRequestTypeChange() {
            const requestType = document.querySelector('input[name="hwRequestType"]:checked').value;
            
            // ëª¨ë“  ì„¹ì…˜ ìˆ¨ê¸°ê¸°
            document.getElementById('hw-new-section').style.display = 'none';
            document.getElementById('hw-fault-section').style.display = 'none';
            document.getElementById('hw-change-section').style.display = 'none';
            
            if (requestType === 'ì§€ê¸‰') {
                // ì‹ ê·œ ì§€ê¸‰
                document.getElementById('hw-new-section').style.display = 'block';
                updateRecommendedAssets();
            } else if (requestType === 'ê³ ì¥') {
                // ê³ ì¥ ì‹ ê³  ğŸ†•
                document.getElementById('hw-fault-section').style.display = 'block';
                loadMyHardwareForFault();
            } else if (requestType === 'ë³€ê²½') {
                // ë³€ê²½ ìš”ì²­ ğŸ†•
                document.getElementById('hw-change-section').style.display = 'block';
                loadMyHardwareForChange();
            }
        }
        
        // Load My Hardware for Fault ğŸ†•
        function loadMyHardwareForFault() {
            const myAssets = assets.filter(a => 
                a.category === 'í•˜ë“œì›¨ì–´' && 
                a.currentUser === currentUser.name &&
                a.status === 'ì‚¬ìš©ì¤‘'
            );
            
            const container = document.getElementById('hw-fault-list');
            
            if (myAssets.length === 0) {
                container.innerHTML = '<p class="text-sm text-gray-500 text-center py-4">ë³´ìœ í•œ í•˜ë“œì›¨ì–´ê°€ ì—†ìŠµë‹ˆë‹¤.</p>';
                return;
            }
            
            container.innerHTML = myAssets.map(asset => `
                <label class="flex items-center p-4 border-2 border-gray-200 rounded-lg cursor-pointer hover:border-red-500 transition">
                    <input type="radio" name="faultAsset" value="${asset.id}" class="mr-3">
                    <div class="flex-1">
                        <div class="font-semibold text-gray-800">${asset.name}</div>
                        <div class="text-sm text-gray-600">${asset.code} | ${asset.specs || ''}</div>
                    </div>
                    <i class="fas fa-exclamation-circle text-red-500"></i>
                </label>
            `).join('');
        }
        
        // Load My Hardware for Change ğŸ†•
        function loadMyHardwareForChange() {
            const myAssets = assets.filter(a => 
                a.category === 'í•˜ë“œì›¨ì–´' && 
                a.currentUser === currentUser.name &&
                a.status === 'ì‚¬ìš©ì¤‘'
            );
            
            const container = document.getElementById('hw-change-list');
            
            if (myAssets.length === 0) {
                container.innerHTML = '<p class="text-sm text-gray-500 text-center py-4">ë³´ìœ í•œ í•˜ë“œì›¨ì–´ê°€ ì—†ìŠµë‹ˆë‹¤.</p>';
                return;
            }
            
            container.innerHTML = myAssets.map(asset => `
                <label class="flex items-center p-4 border-2 border-gray-200 rounded-lg cursor-pointer hover:border-blue-500 transition">
                    <input type="radio" name="changeAsset" value="${asset.id}" class="mr-3">
                    <div class="flex-1">
                        <div class="font-semibold text-gray-800">${asset.code}: ${asset.name}</div>
                        <div class="text-sm text-gray-600">${asset.specs || asset.type}</div>
                    </div>
                    <i class="fas fa-sync-alt text-blue-500"></i>
                </label>
            `).join('');
        }
        
        // Asset Owner Change (ì¥ë¹„ ì†Œìœ ì ë³€ê²½)
        function onAssetOwnerChange() {
            const owner = document.querySelector('input[name="hwAssetOwner"]:checked').value;
            
            if (owner === 'self') {
                document.getElementById('hw-other-user-search').style.display = 'none';
                loadMyAssets();
            } else {
                document.getElementById('hw-other-user-search').style.display = 'block';
                document.getElementById('user-assets-container').innerHTML = `
                    <div class="text-center py-4 text-gray-500">
                        <i class="fas fa-search mr-2"></i>
                        ì‚¬ìš©ì ì´ë¦„ì„ ì…ë ¥í•˜ê³  ê²€ìƒ‰ ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”
                    </div>
                `;
            }
        }
        
        // Load My Assets (ë‚´ ì¥ë¹„ ë¡œë“œ)
        function loadMyAssets() {
            const myAssets = assets.filter(a => 
                a.category === 'í•˜ë“œì›¨ì–´' && 
                a.currentUser === currentUser.name &&
                a.status === 'ì‚¬ìš©ì¤‘'
            );
            
            renderUserAssets(myAssets, currentUser.name);
        }
        
        // Search User Assets (ë‹¤ë¥¸ ì‚¬ìš©ì ì¥ë¹„ ê²€ìƒ‰)
        function searchUserAssets() {
            const userName = document.getElementById('hw-search-user-name').value.trim();
            
            if (!userName) {
                alert('ì‚¬ìš©ì ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            const userAssets = assets.filter(a => 
                a.category === 'í•˜ë“œì›¨ì–´' && 
                a.currentUser === userName &&
                a.status === 'ì‚¬ìš©ì¤‘'
            );
            
            if (userAssets.length === 0) {
                document.getElementById('user-assets-container').innerHTML = `
                    <div class="text-center py-4 text-orange-600 bg-orange-50 rounded-lg">
                        <i class="fas fa-exclamation-circle mr-2"></i>
                        "${userName}" ì‚¬ìš©ìì˜ ì‚¬ìš©ì¤‘ì¸ ì¥ë¹„ê°€ ì—†ìŠµë‹ˆë‹¤
                    </div>
                `;
            } else {
                renderUserAssets(userAssets, userName);
            }
        }
        
        // Render User Assets (ì‚¬ìš©ì ì¥ë¹„ ëª©ë¡ ë Œë”ë§)
        function renderUserAssets(assetList, userName) {
            const container = document.getElementById('user-assets-container');
            
            if (assetList.length === 0) {
                container.innerHTML = `
                    <div class="text-center py-4 text-gray-500 bg-gray-50 rounded-lg">
                        <i class="fas fa-info-circle mr-2"></i>
                        ${userName}ë‹˜ì´ ì‚¬ìš©ì¤‘ì¸ ì¥ë¹„ê°€ ì—†ìŠµë‹ˆë‹¤
                    </div>
                `;
                return;
            }
            
            container.innerHTML = assetList.map(asset => `
                <div class="border-2 border-gray-200 rounded-lg p-4 cursor-pointer hover:border-purple-500 hover:bg-purple-50 transition"
                     onclick="selectUserAsset('${asset.id}')">
                    <div class="flex items-start justify-between">
                        <div class="flex-1">
                            <div class="flex items-center space-x-2 mb-2">
                                <i class="fas fa-laptop text-purple-600"></i>
                                <h5 class="font-bold text-gray-800">${asset.name}</h5>
                                <span class="text-xs px-2 py-1 bg-gray-100 text-gray-600 rounded">${asset.code}</span>
                            </div>
                            <div class="text-sm text-gray-600 space-y-1">
                                <div><i class="fas fa-building mr-2"></i>${asset.manufacturer}</div>
                                <div><i class="fas fa-user mr-2"></i>ì‚¬ìš©ì: ${asset.currentUser}</div>
                                ${asset.specs ? `
                                    <div class="text-xs mt-2 text-gray-500">
                                        ${asset.specs.cpu || ''} / ${asset.specs.ram || ''} / ${asset.specs.storage || ''}
                                    </div>
                                ` : ''}
                            </div>
                        </div>
                        <i class="fas fa-chevron-right text-gray-400"></i>
                    </div>
                </div>
            `).join('');
        }
        
        // Select User Asset (ì‚¬ìš©ì ì¥ë¹„ ì„ íƒ)
        function selectUserAsset(assetId) {
            const asset = assets.find(a => a.id == assetId);
            if (!asset) return;
            
            document.getElementById('asset-hw-selected-id').value = assetId;
            document.getElementById('asset-hw-selected-name').textContent = asset.name;
            document.getElementById('asset-hw-selected-info').textContent = 
                `${asset.code} | ${asset.manufacturer} | ì‚¬ìš©ì: ${asset.currentUser}`;
            document.getElementById('asset-hw-selected-display').style.display = 'block';
        }
        
        // Open Asset Software Modal (ì†Œí”„íŠ¸ì›¨ì–´ ìš”ì²­ ëª¨ë‹¬)
        function openAssetSoftwareModal() {
            // ìš”ì²­ ìœ í˜• ë³€ê²½ ì´ë²¤íŠ¸ ğŸ†•
            document.querySelectorAll('input[name="swRequestType"]').forEach(radio => {
                radio.onchange = function() {
                    const requestType = this.value;
                    // ì„¹ì…˜ í‘œì‹œ/ìˆ¨ê¹€ë§Œ ì²˜ë¦¬, ì‚¬ìœ ëŠ” ê³µí†µ
                    document.getElementById('sw-renewal-section').style.display = requestType === 'ê°±ì‹ ìš”ì²­' ? 'block' : 'none';
                    
                    if (requestType === 'ê°±ì‹ ìš”ì²­') {
                        loadMySoftwareForRenewal();
                    } else if (requestType === 'ì¶”ê°€ë¼ì´ì„ ìŠ¤') {
                        alert('ì¶”ê°€ ë¼ì´ì„ ìŠ¤ ê¸°ëŠ¥ì€ ì¶”í›„ ì—…ë°ì´íŠ¸ ì˜ˆì •ì…ë‹ˆë‹¤.');
                        document.querySelector('input[name="swRequestType"][value="ì‹ ê·œë°œê¸‰"]').checked = true;
                        document.getElementById('sw-renewal-section').style.display = 'none';
                    }
                };
            });
            
            // ê¸°íƒ€ ì„ íƒ ì‹œ ì…ë ¥ë€ í‘œì‹œ
            document.getElementById('asset-sw-name').onchange = function() {
                document.getElementById('asset-sw-other-section').style.display = 
                    this.value === 'ê¸°íƒ€' ? 'block' : 'none';
            };
            
            // íƒ€ì¸ ì„ íƒ ì‹œ ì…ë ¥ë€ í‘œì‹œ
            document.querySelectorAll('input[name="swUser"]').forEach(radio => {
                radio.onchange = function() {
                    document.getElementById('asset-sw-user-other-section').style.display = 
                        this.value === 'other' ? 'block' : 'none';
                };
            });
            
            openModal('assetSoftwareModal');
        }
        
        // Load My Software for Renewal ğŸ†•
        function loadMySoftwareForRenewal() {
            const mySoftware = assets.filter(a => 
                a.category === 'ì†Œí”„íŠ¸ì›¨ì–´' && 
                a.currentUser && a.currentUser.includes(currentUser.name) &&
                a.status === 'í™œì„±'
            );
            
            const container = document.getElementById('sw-renewal-list');
            
            if (mySoftware.length === 0) {
                container.innerHTML = `
                    <div class="text-center py-6 text-gray-500">
                        <i class="fas fa-inbox text-3xl mb-2"></i>
                        <p>ì‚¬ìš©ì¤‘ì¸ ì†Œí”„íŠ¸ì›¨ì–´ê°€ ì—†ìŠµë‹ˆë‹¤</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = mySoftware.map(asset => `
                <label class="flex items-center p-4 border-2 border-gray-200 rounded-lg cursor-pointer hover:border-orange-500 transition">
                    <input type="checkbox" name="renewalSW" value="${asset.id}" class="mr-3">
                    <div class="flex-1">
                        <div class="font-semibold text-gray-800">${asset.code}: ${asset.name}</div>
                        <div class="text-sm text-gray-600">${asset.manufacturer || ''}</div>
                        <div class="text-xs text-gray-500 mt-1">ë§Œë£Œì¼: ${asset.expiryDate || 'ì—†ìŒ'}</div>
                    </div>
                </label>
            `).join('');
        }
        
        // Submit Asset Software Request
        function submitAssetSoftwareRequest(event) {
            event.preventDefault();
            
            const requestType = document.querySelector('input[name="swRequestType"]:checked').value;
            const reason = document.getElementById('asset-sw-reason').value.trim(); // ğŸ†• ê³µí†µ ì‚¬ìœ 
            
            if (!reason) {
                alert('ì‚¬ìœ ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            let targetUser, softwareData;
            
            if (requestType === 'ê°±ì‹ ìš”ì²­') {
                // ê°±ì‹  ìš”ì²­ ğŸ†•
                const checkedBoxes = document.querySelectorAll('input[name="renewalSW"]:checked');
                if (checkedBoxes.length === 0) {
                    alert('ê°±ì‹ í•  ì†Œí”„íŠ¸ì›¨ì–´ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.');
                    return;
                }
                
                const selectedIds = Array.from(checkedBoxes).map(cb => cb.value);
                const selectedAssets = assets.filter(a => selectedIds.includes(String(a.id)));
                
                targetUser = currentUser.name;
                
                softwareData = {
                    type: 'ê°±ì‹ ìš”ì²­',
                    items: selectedAssets.map(a => ({ id: a.id, name: a.name, code: a.code })),
                    names: selectedAssets.map(a => a.name).join(', ')
                };
            } else {
                // ì‹ ê·œ ë°œê¸‰
                const swName = document.getElementById('asset-sw-name').value;
                const swOtherName = document.getElementById('asset-sw-other-name').value;
                const userType = document.querySelector('input[name="swUser"]:checked').value;
                targetUser = userType === 'self' ? currentUser.name : document.getElementById('asset-sw-user-other').value.trim();
                
                const finalSwName = swName === 'ê¸°íƒ€' ? swOtherName : swName;
                
                if (!finalSwName) {
                    alert('ì†Œí”„íŠ¸ì›¨ì–´ë¥¼ ì„ íƒí•˜ê±°ë‚˜ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                    return;
                }
                
                if (userType === 'other' && !targetUser) {
                    alert('íƒ€ì¸ì„ ì„ íƒí•œ ê²½ìš° ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                    return;
                }
                
                softwareData = {
                    type: 'ì‹ ê·œë°œê¸‰',
                    name: finalSwName
                };
            }
            
            // ìì‚° í‹°ì¼“ ìƒì„±
            const ticket = {
                id: ticketIdCounter++,
                ticketNumber: `AST-SW-${new Date().getFullYear()}-${String(ticketIdCounter).padStart(3, '0')}`,
                ticketType: 'ìì‚°',
                
                // ìì‚° ì •ë³´
                assetCategory: 'ì†Œí”„íŠ¸ì›¨ì–´',
                assetRequestType: requestType,
                softwareName: softwareData.names || softwareData.name,
                softwareData: softwareData, // ğŸ†• ìƒì„¸ ë°ì´í„°
                
                // ê¸°ë³¸ í‹°ì¼“ ì •ë³´
                title: `[ì†Œí”„íŠ¸ì›¨ì–´-${requestType}] ${targetUser} - ${softwareData.names || softwareData.name}`,
                description: reason,
                requester: currentUser.name,
                targetUser: targetUser,
                department: currentUser.department,
                category: 'ê¸°íƒ€',
                
                // ìƒíƒœ
                status: 'ìš”ì²­',
                priority: 'ë³´í†µ',
                assignees: [],
                
                // ê¸°íƒ€
                createdAt: new Date().toLocaleDateString('ko-KR'),
                dueDate: '',
                linkedTickets: [],
                comments: [],
                subtasks: []
            };
            
            tickets.push(ticket);
            
            closeModal('assetSoftwareModal');
            
            alert(`âœ… ì†Œí”„íŠ¸ì›¨ì–´ ${requestType} ìš”ì²­ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!\n\ní‹°ì¼“ ë²ˆí˜¸: ${ticket.ticketNumber}\nì†Œí”„íŠ¸ì›¨ì–´: ${softwareData.names || softwareData.name}\nëŒ€ìƒì: ${targetUser}`);
            
            // í™”ë©´ ìƒˆë¡œê³ ì¹¨
            if (currentView === 'user') {
                renderUserView();
            } else {
                renderAdminView();
            }
        }
        
        // Open Asset Cloud Modal (í´ë¼ìš°ë“œ ìš”ì²­ ëª¨ë‹¬)
        function openAssetCloudModal() {
            // ìš”ì²­ ìœ í˜• ë³€ê²½ ì´ë²¤íŠ¸ ğŸ†•
            document.querySelectorAll('input[name="cloudRequestType"]').forEach(radio => {
                radio.onchange = function() {
                    const requestType = this.value;
                    // ì„¹ì…˜ í‘œì‹œ/ìˆ¨ê¹€ë§Œ ì²˜ë¦¬, ì‚¬ìœ ëŠ” ê³µí†µ
                    document.getElementById('cloud-expansion-section').style.display = requestType === 'ìš©ëŸ‰ì¦ì„¤' ? 'block' : 'none';
                    
                    if (requestType === 'ìš©ëŸ‰ì¦ì„¤') {
                        loadCloudForExpansion();
                    } else if (requestType === 'ì„œë¹„ìŠ¤ì¶”ê°€') {
                        alert('ì„œë¹„ìŠ¤ ì¶”ê°€ ê¸°ëŠ¥ì€ ì¶”í›„ ì—…ë°ì´íŠ¸ ì˜ˆì •ì…ë‹ˆë‹¤.');
                        document.querySelector('input[name="cloudRequestType"][value="ê³„ì •ë°œê¸‰"]').checked = true;
                        document.getElementById('cloud-expansion-section').style.display = 'none';
                    }
                };
            });
            
            // ê¸°íƒ€ ì„ íƒ ì‹œ ì…ë ¥ë€ í‘œì‹œ
            document.getElementById('asset-cloud-service').onchange = function() {
                document.getElementById('asset-cloud-other-section').style.display = 
                    this.value === 'ê¸°íƒ€' ? 'block' : 'none';
            };
            
            openModal('assetCloudModal');
        }
        
        // Load Cloud for Expansion ğŸ†•
        function loadCloudForExpansion() {
            const cloudAssets = assets.filter(a => 
                a.category === 'í´ë¼ìš°ë“œ' &&
                a.status === 'í™œì„±'
            );
            
            const container = document.getElementById('cloud-expansion-list');
            
            if (cloudAssets.length === 0) {
                container.innerHTML = `
                    <div class="text-center py-6 text-gray-500">
                        <i class="fas fa-inbox text-3xl mb-2"></i>
                        <p>ë“±ë¡ëœ í´ë¼ìš°ë“œ ì„œë¹„ìŠ¤ê°€ ì—†ìŠµë‹ˆë‹¤</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = cloudAssets.map(asset => `
                <label class="flex items-center p-4 border-2 border-gray-200 rounded-lg cursor-pointer hover:border-purple-500 transition">
                    <input type="radio" name="expansionCloud" value="${asset.id}" class="mr-3">
                    <div class="flex-1">
                        <div class="font-semibold text-gray-800">${asset.code}: ${asset.name}</div>
                        <div class="text-sm text-gray-600">í˜„ì¬: ${asset.specs || ''}</div>
                        <div class="text-xs text-gray-500 mt-1">ë‹´ë‹¹: ${asset.currentUser || ''} | ì›”ë¹„ìš©: â‚©${asset.monthlyFee?.toLocaleString() || '0'}</div>
                    </div>
                </label>
            `).join('');
        }
        
        // Submit Asset Cloud Request
        function submitAssetCloudRequest(event) {
            event.preventDefault();
            
            const requestType = document.querySelector('input[name="cloudRequestType"]:checked').value;
            const reason = document.getElementById('asset-cloud-reason').value.trim(); // ğŸ†• ê³µí†µ ì‚¬ìœ 
            
            if (!reason) {
                alert('ì‚¬ìœ ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            let serviceName, capacity, cloudData, selectedAssetId;
            
            if (requestType === 'ìš©ëŸ‰ì¦ì„¤') {
                // ìš©ëŸ‰ ì¦ì„¤ ğŸ†•
                const selectedRadio = document.querySelector('input[name="expansionCloud"]:checked');
                if (!selectedRadio) {
                    alert('ì¦ì„¤í•  í´ë¼ìš°ë“œ ì„œë¹„ìŠ¤ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.');
                    return;
                }
                
                selectedAssetId = selectedRadio.value;
                const selectedAsset = assets.find(a => a.id == selectedAssetId);
                
                const expansionAmount = document.getElementById('asset-cloud-expansion-amount').value.trim();
                
                if (!expansionAmount) {
                    alert('ì¦ì„¤ ìš©ëŸ‰/ì‚¬ì–‘ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                    return;
                }
                
                cloudData = {
                    type: 'ìš©ëŸ‰ì¦ì„¤',
                    assetId: selectedAssetId,
                    assetCode: selectedAsset.code,
                    assetName: selectedAsset.name,
                    currentSpecs: selectedAsset.specs,
                    expansionAmount: expansionAmount
                };
                
                serviceName = selectedAsset.name;
                capacity = `í˜„ì¬: ${selectedAsset.specs} â†’ ì¦ì„¤: ${expansionAmount}`;
            } else {
                // ê³„ì • ë°œê¸‰
                const serviceSelect = document.getElementById('asset-cloud-service').value;
                const serviceOtherName = document.getElementById('asset-cloud-other-name').value;
                capacity = document.getElementById('asset-cloud-capacity').value.trim();
                const cost = document.getElementById('asset-cloud-cost').value;
                const duration = document.getElementById('asset-cloud-duration').value;
                
                serviceName = serviceSelect === 'ê¸°íƒ€' ? serviceOtherName : serviceSelect;
                
                if (!serviceName) {
                    alert('ì„œë¹„ìŠ¤ë¥¼ ì„ íƒí•˜ê±°ë‚˜ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                    return;
                }
                
                cloudData = {
                    type: 'ê³„ì •ë°œê¸‰',
                    serviceName: serviceName,
                    capacity: capacity,
                    cost: cost,
                    duration: duration
                };
            }
            
            // ìì‚° í‹°ì¼“ ìƒì„±
            const ticket = {
                id: ticketIdCounter++,
                ticketNumber: `AST-CL-${new Date().getFullYear()}-${String(ticketIdCounter).padStart(3, '0')}`,
                ticketType: 'ìì‚°',
                
                // ìì‚° ì •ë³´
                assetCategory: 'í´ë¼ìš°ë“œ',
                assetRequestType: requestType,
                cloudServiceName: serviceName,
                cloudCapacity: capacity,
                cloudData: cloudData, // ğŸ†• ìƒì„¸ ë°ì´í„°
                requestedAssetId: selectedAssetId || null,
                
                // ê¸°ë³¸ í‹°ì¼“ ì •ë³´
                title: `[í´ë¼ìš°ë“œ-${requestType}] ${serviceName} - ${capacity}`,
                description: reason,
                requester: currentUser.name,
                targetUser: currentUser.name,
                department: currentUser.department,
                category: 'ê¸°íƒ€',
                
                // ìƒíƒœ
                status: 'ìš”ì²­',
                priority: 'ë³´í†µ',
                assignees: [],
                
                // ê¸°íƒ€
                createdAt: new Date().toLocaleDateString('ko-KR'),
                dueDate: '',
                linkedTickets: [],
                comments: [],
                subtasks: []
            };
            
            tickets.push(ticket);
            
            closeModal('assetCloudModal');
            
            alert(`âœ… í´ë¼ìš°ë“œ ${requestType} ìš”ì²­ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!\n\ní‹°ì¼“ ë²ˆí˜¸: ${ticket.ticketNumber}\nì„œë¹„ìŠ¤: ${serviceName}\nìš©ëŸ‰: ${capacity}`);
            
            // í™”ë©´ ìƒˆë¡œê³ ì¹¨
            if (currentView === 'user') {
                renderUserView();
            } else {
                renderAdminView();
            }
        }
        
        // ==========================================
        // ğŸ†• Step 2: ìì‚° ì²˜ë¦¬ í•¨ìˆ˜ë“¤
        // ==========================================
        
        // ìì‚° ìŠ¹ì¸ ëŒ€ê¸°ë¡œ ë³€ê²½
        function setAssetApprovalPending(ticketId) {
            const ticket = tickets.find(t => t.id === ticketId);
            if (!ticket) return;
            
            ticket.status = 'ìŠ¹ì¸ëŒ€ê¸°';
            ticket.requireApproval = true;
            ticket.approved = null;
            
            ticket.comments.push({
                author: currentUser.name,
                content: `ìì‚° ìš”ì²­ì„ ìŠ¹ì¸ ëŒ€ê¸°ë¡œ ë³€ê²½í–ˆìŠµë‹ˆë‹¤. ì„ì› ìŠ¹ì¸ í›„ ì²˜ë¦¬ë©ë‹ˆë‹¤.`,
                timestamp: new Date().toLocaleString('ko-KR')
            });
            
            alert(`âœ… ìì‚° ìš”ì²­ì´ ìŠ¹ì¸ ëŒ€ê¸°ë¡œ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤!\n\nì„ì› ìŠ¹ì¸ í›„ ì²˜ë¦¬ê°€ ì§„í–‰ë©ë‹ˆë‹¤.`);
            
            renderAdminView();
        }
        
        // ìì‚° ë°”ë¡œ ì ‘ìˆ˜
        function acceptAssetDirectly(ticketId) {
            const ticket = tickets.find(t => t.id === ticketId);
            if (!ticket) return;
            
            if (!confirm('ìŠ¹ì¸ ì—†ì´ ë°”ë¡œ ì ‘ìˆ˜í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;
            
            ticket.status = 'ì ‘ìˆ˜';
            ticket.requireApproval = false;
            ticket.approved = true;
            ticket.approvedBy = currentUser.name;
            ticket.approvedAt = new Date().toLocaleString('ko-KR');
            
            ticket.comments.push({
                author: currentUser.name,
                content: `ìì‚° ìš”ì²­ì„ ë°”ë¡œ ì ‘ìˆ˜í–ˆìŠµë‹ˆë‹¤. (ìŠ¹ì¸ ì—†ì´ ì²˜ë¦¬)`,
                timestamp: new Date().toLocaleString('ko-KR')
            });
            
            alert(`âœ… ìì‚° ìš”ì²­ì´ ì ‘ìˆ˜ë˜ì—ˆìŠµë‹ˆë‹¤!\n\nì²˜ë¦¬ë¥¼ ì§„í–‰í•´ì£¼ì„¸ìš”.`);
            
            renderAdminView();
        }
        
        // ìì‚° ë°˜ë ¤ ëª¨ë‹¬ ì—´ê¸°
        function openRejectAssetModal(ticketId) {
            document.getElementById('reject-asset-ticket-id').value = ticketId;
            document.getElementById('reject-asset-reason').value = '';
            openModal('rejectAssetModal');
        }
        
        // ìì‚° ë°˜ë ¤ ì œì¶œ
        function submitRejectAsset(event) {
            event.preventDefault();
            
            const ticketId = parseInt(document.getElementById('reject-asset-ticket-id').value);
            const reason = document.getElementById('reject-asset-reason').value.trim();
            
            const ticket = tickets.find(t => t.id === ticketId);
            if (!ticket) return;
            
            ticket.status = 'ë°˜ë ¤';
            ticket.rejectedReason = reason;
            ticket.rejectedBy = currentUser.name;
            ticket.rejectedAt = new Date().toLocaleString('ko-KR');
            
            ticket.comments.push({
                author: currentUser.name,
                content: `ìì‚° ìš”ì²­ì„ ë°˜ë ¤í–ˆìŠµë‹ˆë‹¤.\në°˜ë ¤ ì‚¬ìœ : ${reason}`,
                timestamp: new Date().toLocaleString('ko-KR')
            });
            
            closeModal('rejectAssetModal');
            
            alert(`âœ… ìì‚° ìš”ì²­ì´ ë°˜ë ¤ë˜ì—ˆìŠµë‹ˆë‹¤!\n\në°˜ë ¤ ì‚¬ìœ ê°€ ì‹ ì²­ìì—ê²Œ ì „ë‹¬ë©ë‹ˆë‹¤.`);
            
            renderAdminView();
        }
        
        // ìì‚° ì²˜ë¦¬ ì™„ë£Œ ëª¨ë‹¬ ì—´ê¸°
        function openAssetProcessingModal(ticketId) {
            const ticket = tickets.find(t => t.id === ticketId);
            if (!ticket) return;
            
            document.getElementById('processing-ticket-id').value = ticketId;
            document.getElementById('processing-asset-category').value = ticket.assetCategory;
            
            // ì„¹ì…˜ ì´ˆê¸°í™”
            document.getElementById('processing-hardware-section').style.display = 'none';
            document.getElementById('processing-software-section').style.display = 'none';
            
            // ì¹´í…Œê³ ë¦¬ë³„ ì„¹ì…˜ í‘œì‹œ
            if (ticket.assetCategory === 'í•˜ë“œì›¨ì–´') {
                document.getElementById('processing-hardware-section').style.display = 'block';
                // ì˜¤ëŠ˜ ë‚ ì§œ ê¸°ë³¸ê°’
                document.getElementById('processing-hw-date').value = new Date().toISOString().split('T')[0];
            } else {
                document.getElementById('processing-software-section').style.display = 'block';
            }
            
            openModal('assetProcessingModal');
        }
        
        // ìì‚° ì²˜ë¦¬ ì™„ë£Œ ì œì¶œ
        function submitAssetProcessing(event) {
            event.preventDefault();
            
            const ticketId = parseInt(document.getElementById('processing-ticket-id').value);
            const category = document.getElementById('processing-asset-category').value;
            
            const ticket = tickets.find(t => t.id === ticketId);
            if (!ticket) return;
            
            // ì²˜ë¦¬ ì •ë³´ ì €ì¥
            if (category === 'í•˜ë“œì›¨ì–´') {
                const method = document.getElementById('processing-hw-method').value;
                const description = document.getElementById('processing-hw-description').value.trim();
                const date = document.getElementById('processing-hw-date').value;
                
                ticket.processingInfo = {
                    type: 'í•˜ë“œì›¨ì–´',
                    method: method,
                    description: description,
                    completedAt: date
                };
                
                ticket.comments.push({
                    author: currentUser.name,
                    content: `í•˜ë“œì›¨ì–´ ì²˜ë¦¬ ì™„ë£Œ\në°©ë²•: ${method}\në‚´ìš©: ${description}\nì™„ë£Œì¼: ${date}`,
                    timestamp: new Date().toLocaleString('ko-KR')
                });
                
            } else {
                const link = document.getElementById('processing-sw-link').value.trim();
                const fileInput = document.getElementById('processing-sw-file');
                const fileName = fileInput.files.length > 0 ? fileInput.files[0].name : '';
                const guide = document.getElementById('processing-sw-guide').value.trim();
                const license = document.getElementById('processing-sw-license').value.trim();
                
                ticket.processingInfo = {
                    type: 'ì†Œí”„íŠ¸ì›¨ì–´',
                    downloadLink: link,
                    fileAttachment: fileName,
                    installGuide: guide,
                    licenseKey: license
                };
                
                ticket.comments.push({
                    author: currentUser.name,
                    content: `ì†Œí”„íŠ¸ì›¨ì–´ ì²˜ë¦¬ ì™„ë£Œ\n${link ? `ë‹¤ìš´ë¡œë“œ: ${link}\n` : ''}${fileName ? `íŒŒì¼: ${fileName}\n` : ''}ê°€ì´ë“œ:\n${guide}`,
                    timestamp: new Date().toLocaleString('ko-KR')
                });
            }
            
            // ìƒíƒœ ë³€ê²½: ê²€ìˆ˜ ëŒ€ê¸°
            ticket.status = 'ê²€ìˆ˜ ëŒ€ê¸°';
            ticket.processingCompletedAt = new Date().toLocaleString('ko-KR');
            ticket.processingCompletedBy = currentUser.name;
            
            closeModal('assetProcessingModal');
            
            alert(`âœ… ${category} ì²˜ë¦¬ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!\n\nì‹ ì²­ìì˜ ê²€ìˆ˜ë¥¼ ê¸°ë‹¤ë¦½ë‹ˆë‹¤.`);
            
            // í™”ë©´ ì¦‰ì‹œ ì—…ë°ì´íŠ¸ ğŸ†•
            if (currentView === 'admin') {
                renderAdminView();
            } else {
                renderUserView();
            }
        }
        
        // ==========================================
        // ğŸ†• Step 3: ìì‚° ê´€ë¦¬ í•¨ìˆ˜ë“¤
        // ==========================================
        
        // ìì‚° ê´€ë¦¬ ë Œë”ë§
        function renderAssetManagement() {
            renderAssetsList();
        }
        
        // ìì‚° ëª©ë¡ ë Œë”ë§
        function renderAssetsList() {
            const tbody = document.getElementById('assets-list');
            const filteredAssets = getFilteredAssets();
            
            if (filteredAssets.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="9" class="text-center py-8 text-gray-500">
                            <i class="fas fa-inbox text-4xl mb-2"></i>
                            <p>ë“±ë¡ëœ ìì‚°ì´ ì—†ìŠµë‹ˆë‹¤</p>
                        </td>
                    </tr>
                `;
                return;
            }
            
            tbody.innerHTML = filteredAssets.map(asset => {
                const statusColor = asset.status === 'ì‚¬ìš©ì¤‘' ? 'green' : 
                                  asset.status === 'ëŒ€ê¸°' ? 'blue' : 
                                  asset.status === 'ê³ ì¥' ? 'red' : 
                                  asset.status === 'ìˆ˜ë¦¬ì¤‘' ? 'orange' : 'gray';
                
                const categoryIcon = asset.category === 'í•˜ë“œì›¨ì–´' ? 'laptop' :
                                   asset.category === 'ì†Œí”„íŠ¸ì›¨ì–´' ? 'code' : 'cloud';
                
                const categoryColor = asset.category === 'í•˜ë“œì›¨ì–´' ? 'purple' :
                                    asset.category === 'ì†Œí”„íŠ¸ì›¨ì–´' ? 'blue' : 'cyan';
                
                // ê¸ˆì•¡ ì •ë³´
                let priceInfo = '';
                if (asset.purchasePrice) {
                    priceInfo = `â‚©${asset.purchasePrice.toLocaleString()}`;
                } else if (asset.monthlyFee) {
                    priceInfo = `â‚©${asset.monthlyFee.toLocaleString()}/ì›”`;
                }
                
                // êµ¬ë§¤/ì‹œì‘ ë…„ë„
                const year = asset.purchaseDate ? new Date(asset.purchaseDate).getFullYear() : 
                            asset.startDate ? new Date(asset.startDate).getFullYear() : '-';
                
                return `
                    <tr>
                        <td class="font-mono text-sm font-semibold">${asset.code}</td>
                        <td>
                            <span class="inline-flex items-center px-2 py-1 bg-${categoryColor}-100 text-${categoryColor}-700 text-xs rounded-full font-semibold">
                                <i class="fas fa-${categoryIcon} mr-1"></i>${asset.category}
                            </span>
                        </td>
                        <td class="font-semibold">${asset.name}</td>
                        <td class="text-gray-600">${asset.manufacturer || '-'}</td>
                        <td class="text-center">${year}</td>
                        <td class="text-right font-semibold">${priceInfo}</td>
                        <td>
                            <span class="status-badge status-badge-${statusColor}">
                                ${asset.status}
                            </span>
                        </td>
                        <td class="text-gray-600">${asset.currentUser || '-'}</td>
                        <td>
                            <div class="flex items-center space-x-2">
                                <button onclick="openEditAssetModal(${asset.id})" 
                                        class="text-blue-600 hover:text-blue-700 text-sm font-semibold">
                                    <i class="fas fa-edit mr-1"></i>ìˆ˜ì •
                                </button>
                                <button onclick="confirmDeleteAsset(${asset.id})" 
                                        class="text-red-600 hover:text-red-700 text-sm font-semibold">
                                    <i class="fas fa-trash mr-1"></i>ì‚­ì œ
                                </button>
                            </div>
                        </td>
                    </tr>
                `;
            }).join('');
        }
        
        // ìì‚° í•„í„°ë§
        function getFilteredAssets() {
            const categoryFilter = document.getElementById('asset-filter-category')?.value || '';
            const statusFilter = document.getElementById('asset-filter-status')?.value || '';
            const searchTerm = document.getElementById('asset-search')?.value.toLowerCase() || '';
            
            return assets.filter(asset => {
                const matchesCategory = !categoryFilter || asset.category === categoryFilter;
                const matchesStatus = !statusFilter || asset.status === statusFilter;
                const matchesSearch = !searchTerm || 
                    asset.name.toLowerCase().includes(searchTerm) ||
                    asset.code.toLowerCase().includes(searchTerm) ||
                    (asset.currentUser && asset.currentUser.toLowerCase().includes(searchTerm)) ||
                    (asset.manufacturer && asset.manufacturer.toLowerCase().includes(searchTerm));
                
                return matchesCategory && matchesStatus && matchesSearch;
            });
        }
        
        // í•„í„° ì ìš©
        function filterAssets() {
            renderAssetsList();
        }
        
        // ìì‚° ë“±ë¡ ëª¨ë‹¬ ì—´ê¸°
        function openAddAssetModal() {
            alert('ğŸ”§ ìì‚° ë“±ë¡ ëª¨ë‹¬ì€ ë‹¤ìŒ ë‹¨ê³„ì—ì„œ êµ¬í˜„ë©ë‹ˆë‹¤!\n\ní˜„ì¬ëŠ” í…ŒìŠ¤íŠ¸ ë°ì´í„°ë¡œ ìì‚° ê´€ë¦¬ í™”ë©´ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
        }
        
        // ìì‚° ìˆ˜ì • ëª¨ë‹¬ ì—´ê¸°
        function openEditAssetModal(assetId) {
            alert(`ğŸ”§ ìì‚° ìˆ˜ì • ê¸°ëŠ¥ì€ ë‹¤ìŒ ë‹¨ê³„ì—ì„œ êµ¬í˜„ë©ë‹ˆë‹¤!\n\nìì‚° ID: ${assetId}`);
        }
        
        // ìì‚° ì‚­ì œ í™•ì¸
        function confirmDeleteAsset(assetId) {
            const asset = assets.find(a => a.id === assetId);
            if (!asset) return;
            
            if (asset.status === 'ì‚¬ìš©ì¤‘') {
                if (!confirm(`âš ï¸ ê²½ê³ : ì‚¬ìš©ì¤‘ì¸ ìì‚°ì…ë‹ˆë‹¤!\n\nìì‚°: ${asset.name}\nì‚¬ìš©ì: ${asset.currentUser}\n\nì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
                    return;
                }
            } else {
                if (!confirm(`ìì‚°ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n\n${asset.code}: ${asset.name}`)) {
                    return;
                }
            }
            
            // ìì‚° ì‚­ì œ
            const index = assets.findIndex(a => a.id === assetId);
            if (index > -1) {
                assets.splice(index, 1);
                alert('âœ… ìì‚°ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤!');
                renderAssetsList();
            }
        }
        
        // Update Recommended Assets (ì¶”ì²œ ì¥ë¹„ ì—…ë°ì´íŠ¸)
        function updateRecommendedAssets() {
            const grade = document.getElementById('asset-hw-grade').value;
            const container = document.getElementById('recommended-assets-container');
            
            // í•´ë‹¹ ì§ê¸‰ì˜ ì¶”ì²œ ì¥ë¹„ í•„í„°ë§ (ëŒ€ê¸° ìƒíƒœë§Œ)
            const recommended = assets.filter(asset => 
                asset.category === 'í•˜ë“œì›¨ì–´' && 
                asset.recommendedGrade === grade &&
                asset.status === 'ëŒ€ê¸°'
            );
            
            if (recommended.length === 0) {
                container.innerHTML = `
                    <div class="text-center py-4 text-orange-50 border border-orange-200 rounded-lg">
                        <i class="fas fa-info-circle text-orange-500 mr-2"></i>
                        <span class="text-orange-700">í˜„ì¬ ëŒ€ê¸° ì¤‘ì¸ ${grade}ê¸‰ ì¶”ì²œ ì¥ë¹„ê°€ ì—†ìŠµë‹ˆë‹¤</span>
                    </div>
                `;
            } else {
                // ì¥ë¹„ ìœ í˜•ë³„ë¡œ ê·¸ë£¹í™”
                const typeGroups = {};
                recommended.forEach(asset => {
                    if (!typeGroups[asset.type]) {
                        typeGroups[asset.type] = [];
                    }
                    typeGroups[asset.type].push(asset);
                });
                
                container.innerHTML = Object.entries(typeGroups).map(([type, items]) => `
                    <div class="mb-4">
                        <h5 class="font-bold text-gray-700 mb-2">
                            <i class="fas fa-${type === 'ë…¸íŠ¸ë¶' ? 'laptop' : type === 'PC' ? 'desktop' : 'tv'} mr-2"></i>
                            ${type} (${items.length}ê°œ)
                        </h5>
                        <div class="space-y-2">
                            ${items.map(asset => `
                                <label class="flex items-center p-4 border-2 border-green-300 bg-green-50 rounded-lg cursor-pointer hover:bg-green-100 hover:border-green-400 transition">
                                    <input type="checkbox" name="newAsset" value="${asset.id}" class="mr-3 w-5 h-5">
                                    <div class="flex-1">
                                        <div class="flex items-center space-x-2 mb-2">
                                            <h6 class="font-bold text-gray-800">${asset.name}</h6>
                                            <span class="text-xs px-2 py-1 bg-gray-100 text-gray-600 rounded">${asset.code}</span>
                                        </div>
                                        <div class="text-sm text-gray-600 space-y-1">
                                            <div><i class="fas fa-building mr-2 text-gray-400"></i>${asset.manufacturer}</div>
                                            <div><i class="fas fa-tag mr-2 text-gray-400"></i>â‚©${asset.purchasePrice?.toLocaleString() || 'ë¬¸ì˜'}</div>
                                            ${asset.specs ? `
                                                <div class="text-xs mt-2 px-3 py-1 bg-white rounded border border-green-200 text-gray-600">
                                                    ğŸ’» ${asset.specs.cpu || ''} / ğŸ§  ${asset.specs.ram || ''} / ğŸ’¾ ${asset.specs.storage || asset.specs.size || ''}
                                                    </div>
                                                ` : ''}
                                        </div>
                                    </div>
                                    <span class="text-xs px-3 py-1 bg-green-200 text-green-800 rounded-full font-semibold">ì¶”ì²œ</span>
                                </label>
                            `).join('')}
                        </div>
                    </div>
                `).join('');
            }
        }
        
        // Toggle Other User Section (íƒ€ì¸ ì„ íƒ í† ê¸€)
        function toggleOtherUserSection() {
            const isSelf = document.getElementById('asset-hw-user-self').checked;
            document.getElementById('asset-hw-user-other-section').style.display = isSelf ? 'none' : 'block';
        }
        
        // Clear Selected Asset (ì„ íƒëœ ì¥ë¹„ ì´ˆê¸°í™”)
        // Clear File Input (íŒŒì¼ ì…ë ¥ í´ë¦¬ì–´) ğŸ†•
        function clearFile(inputId) {
            const fileInput = document.getElementById(inputId);
            if (fileInput) {
                fileInput.value = '';
            }
        }
        
        // Submit Asset Hardware Request (í•˜ë“œì›¨ì–´ ìš”ì²­ ì œì¶œ)
        function submitAssetHardwareRequest(event) {
            event.preventDefault();
            
            const requestType = document.querySelector('input[name="hwRequestType"]:checked').value;
            const reason = document.getElementById('asset-hw-reason').value.trim(); // ê³µí†µ ì‚¬ìœ 
            
            if (!reason) {
                alert('ì‚¬ìœ ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            let targetUser, selectedAssets = [], grade;
            
            if (requestType === 'ê³ ì¥') {
                // ê³ ì¥ ì‹ ê³  ğŸ†•
                const selectedRadio = document.querySelector('input[name="faultAsset"]:checked');
                if (!selectedRadio) {
                    alert('ê³ ì¥ë‚œ í•˜ë“œì›¨ì–´ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.');
                    return;
                }
                selectedAssets = [assets.find(a => a.id == selectedRadio.value)];
                targetUser = currentUser.name;
            } else if (requestType === 'ë³€ê²½') {
                // ë³€ê²½ ìš”ì²­
                const selectedRadio = document.querySelector('input[name="changeAsset"]:checked');
                if (!selectedRadio) {
                    alert('ë³€ê²½í•  í•˜ë“œì›¨ì–´ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.');
                    return;
                }
                selectedAssets = [assets.find(a => a.id == selectedRadio.value)];
                targetUser = currentUser.name;
            } else {
                // ì‹ ê·œ ì§€ê¸‰ (ë‹¤ì¤‘ ì„ íƒ) ğŸ†•
                const userType = document.querySelector('input[name="hwUser"]:checked').value;
                targetUser = userType === 'self' ? currentUser.name : document.getElementById('asset-hw-user-other').value.trim();
                grade = document.getElementById('asset-hw-grade').value;
                
                const checkedBoxes = document.querySelectorAll('input[name="newAsset"]:checked');
                if (checkedBoxes.length === 0) {
                    alert('ì¥ë¹„ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.');
                    return;
                }
                
                selectedAssets = Array.from(checkedBoxes).map(cb => assets.find(a => a.id == cb.value));
                
                if (userType === 'other' && !targetUser) {
                    alert('íƒ€ì¸ì„ ì„ íƒí•œ ê²½ìš° ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                    return;
                }
            }
            
            // ìì‚° í‹°ì¼“ ìƒì„±
            const assetNames = selectedAssets.map(a => a.name).join(', ');
            const ticket = {
                id: ticketIdCounter++,
                ticketNumber: `AST-HW-${new Date().getFullYear()}-${String(ticketIdCounter).padStart(3, '0')}`,
                ticketType: 'ìì‚°',
                
                // ìì‚° ì •ë³´
                assetCategory: 'í•˜ë“œì›¨ì–´',
                assetRequestType: requestType,
                
                // ê¸°ë³¸ í‹°ì¼“ ì •ë³´
                title: `[í•˜ë“œì›¨ì–´-${requestType}] ${targetUser} - ${assetNames}`,
                description: reason,
                requester: currentUser.name,
                targetUser: targetUser,
                department: currentUser.department,
                category: 'ê¸°íƒ€',
                
                // ìì‚° ìƒì„¸
                requestedAssets: selectedAssets.map(a => ({ id: a.id, name: a.name, code: a.code })),
                requestedAssetId: selectedAssets.length === 1 ? selectedAssets[0].id : null,
                recommendedGrade: grade,
                
                // ìƒíƒœ
                status: 'ìš”ì²­',
                priority: requestType === 'ê³ ì¥' ? 'ë†’ìŒ' : 'ë³´í†µ',
                assignees: [],
                
                // ìŠ¹ì¸
                requireApproval: false,
                approved: false,
                
                // ê¸°íƒ€
                createdAt: new Date().toLocaleDateString('ko-KR'),
                dueDate: '',
                linkedTickets: [],
                comments: [],
                subtasks: []
            };
            
            tickets.push(ticket);
            
            closeModal('assetHardwareModal');
            
            alert(`âœ… í•˜ë“œì›¨ì–´ ${requestType} ìš”ì²­ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!\n\ní‹°ì¼“ ë²ˆí˜¸: ${ticket.ticketNumber}\nëŒ€ìƒì: ${targetUser}`);
            
            // í™”ë©´ ìƒˆë¡œê³ ì¹¨
            if (currentView === 'user') {
                renderUserView();
            } else {
                renderAdminView();
            }
        }
        
        // Render Active Requests (ì§„í–‰ ì¤‘ì¸ ìš”ì²­)
        function renderActiveRequests(activeTickets) {
            const section = document.getElementById('active-requests-section');
            const container = document.getElementById('active-requests-container');
            
            if (activeTickets.length === 0) {
                section.style.display = 'none';
                return;
            }
            
            section.style.display = 'block';
            
            container.innerHTML = activeTickets.map(ticket => {
                const statusColor = {
                    'ìš”ì²­': 'gray',
                    'ê²¬ì í™•ì¸': 'cyan',
                    'ìŠ¹ì¸ëŒ€ê¸°': 'yellow',
                    'ì ‘ìˆ˜': 'green',
                    'ì²˜ë¦¬ì¤‘': 'blue',
                    'ì¬ê²€ìˆ˜ì¤‘': 'orange',
                    'ê²€ìˆ˜ ëŒ€ê¸°': 'purple'
                };
                const color = statusColor[ticket.status] || 'gray';
                const progress = calculateProgress(ticket);
                
                return `
                    <div onclick="openTicketDetail(${ticket.id})" 
                         class="bg-white border-2 border-${color}-200 rounded-lg p-4 cursor-pointer hover:shadow-md transition">
                        <div class="flex items-center justify-between mb-2">
                            <div class="flex items-center space-x-3">
                                <span class="font-mono text-sm font-bold text-${color}-600">${ticket.ticketNumber}</span>
                                <span class="status-badge status-${ticket.status}">${ticket.status}</span>
                                ${ticket.requireEstimateConfirmation && ticket.status === 'ê²¬ì í™•ì¸' ? `
                                    <span class="px-2 py-1 bg-red-100 text-red-700 text-xs rounded-full font-semibold animate-pulse">
                                        <i class="fas fa-exclamation-circle mr-1"></i>í™•ì¸ í•„ìš”
                                    </span>
                                ` : ''}
                            </div>
                            <span class="priority-badge priority-${ticket.priority}">${ticket.priority}</span>
                        </div>
                        <h3 class="font-semibold text-gray-800 mb-2">${ticket.title}</h3>
                        <div class="flex items-center justify-between text-sm text-gray-600">
                            <div class="flex items-center space-x-4">
                                <span><i class="fas fa-folder text-${color}-500 mr-1"></i>${ticket.category}</span>
                                ${ticket.assignees.length > 0 ? `
                                    <span><i class="fas fa-user text-blue-500 mr-1"></i>${ticket.assignees.join(', ')}</span>
                                ` : ''}
                            </div>
                            <div class="flex items-center space-x-2">
                                <div class="w-24 bg-gray-200 rounded-full h-2">
                                    <div class="bg-${color}-500 h-2 rounded-full transition-all" style="width: ${progress}%"></div>
                                </div>
                                <span class="text-xs font-semibold text-${color}-600">${progress}%</span>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }
        
        function openNewTicketModal() {
            openModal('newTicketModal');
        }
        
        // ì‚¬ìš©ì ìµœì¢… ìŠ¹ì¸ (ê²€ìˆ˜ ëŒ€ê¸° â†’ ì™„ë£Œ)
        function approveCompletion(ticketId) {
            const ticket = tickets.find(t => t.id === ticketId);
            if (!ticket) return;
            
            // ë§ˆìŠ¤í„°ëŠ” ëª¨ë“  í‹°ì¼“ ìŠ¹ì¸ ê°€ëŠ¥, ì¼ë°˜ ì‚¬ìš©ìëŠ” ë³¸ì¸ í‹°ì¼“ë§Œ
            if (currentUser.role !== 'master' && ticket.requester !== currentUser.name) {
                alert('â›” ë³¸ì¸ì´ ìš”ì²­í•œ í‹°ì¼“ë§Œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
                return;
            }
            
            // í‰ê°€ ì ìˆ˜ ìˆ˜ì§‘ (ì„ íƒì‚¬í•­)
            const timeScore = parseInt(document.getElementById(`evaluation-time-${ticketId}`)?.value) || 0;
            const qualityScore = parseInt(document.getElementById(`evaluation-quality-${ticketId}`)?.value) || 0;
            const commScore = parseInt(document.getElementById(`evaluation-communication-${ticketId}`)?.value) || 0;
            const expertiseScore = parseInt(document.getElementById(`evaluation-expertise-${ticketId}`)?.value) || 0;
            const totalScore = timeScore + qualityScore + commScore + expertiseScore;
            
            // í”¼ë“œë°± (ì„ íƒì‚¬í•­)
            const feedbackElement = document.getElementById(`userFeedback-${ticketId}`);
            const feedback = feedbackElement?.value.trim() || '';
            
            // ìµœì¢… í™•ì¸ ë‹¤ì´ì–¼ë¡œê·¸
            const confirmMessage = `
âœ… ì‘ì—… ê²°ê³¼ ìµœì¢… í™•ì¸

í‹°ì¼“: ${ticket.ticketNumber}
ì œëª©: ${ticket.title}
ë‹´ë‹¹ì: ${ticket.assignees?.join(', ') || 'ë¯¸ë°°ì •'}

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ“‹ í™•ì¸ ì‚¬í•­:
â€¢ ì‘ì—… ê²°ê³¼ë¬¼ì„ í™•ì¸í•˜ì…¨ìŠµë‹ˆê¹Œ?
â€¢ ìš”ì²­í•˜ì‹  ë‚´ìš©ì´ ì •ìƒì ìœ¼ë¡œ ì™„ë£Œë˜ì—ˆìŠµë‹ˆê¹Œ?

ğŸ’° ë¹„ìš© ì§‘í–‰:
â€¢ ìµœì¢… í™•ì¸ ì‹œì ì´ ë¹„ìš© ì§‘í–‰ì˜ ê·¼ê±°ê°€ ë©ë‹ˆë‹¤
â€¢ í™•ì¸ ì™„ë£Œ í›„ ì™„ë£Œ ìƒíƒœë¡œ ì „í™˜ë©ë‹ˆë‹¤
${totalScore > 0 ? `\nğŸ“Š í’ˆì§ˆ í‰ê°€: ${totalScore}/12ì 
   â€¢ ì†Œìš”ì‹œê°„: ${timeScore}/3ì 
   â€¢ ì™„ì„±ë„: ${qualityScore}/3ì 
   â€¢ ì»¤ë®¤ë‹ˆì¼€ì´ì…˜: ${commScore}/3ì 
   â€¢ ì „ë¬¸ì„±: ${expertiseScore}/3ì ` : ''}
${feedback ? '\nğŸ’¬ ì˜ê²¬: ' + feedback.substring(0, 50) + (feedback.length > 50 ? '...' : '') : ''}

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ì •ë§ë¡œ ìµœì¢… í™•ì¸í•˜ì‹œê² ìŠµë‹ˆê¹Œ?
            `.trim();
            
            if (!confirm(confirmMessage)) {
                return;
            }
            
            // í‹°ì¼“ ì™„ë£Œ ì²˜ë¦¬
            ticket.status = 'ì™„ë£Œ';
            ticket.evaluationScore = totalScore > 0 ? {
                time: timeScore,
                quality: qualityScore,
                communication: commScore,
                expertise: expertiseScore,
                total: totalScore
            } : null;
            ticket.satisfactionRating = totalScore > 0 ? totalScore : null; // í•˜ìœ„í˜¸í™˜
            ticket.userFeedback = feedback || null;
            ticket.userApprovedAt = new Date().toLocaleString('ko-KR', {
                year: 'numeric',
                month: '2-digit',
                day: '2-digit',
                hour: '2-digit',
                minute: '2-digit'
            });
            ticket.userApprovedBy = currentUser.name;
            
            // ì½”ë©˜íŠ¸ ì¶”ê°€
            let commentContent = `[ìµœì¢… í™•ì¸ ì™„ë£Œ]`;
            
            if (totalScore > 0) {
                commentContent += `\nğŸ“Š í’ˆì§ˆ í‰ê°€: ${totalScore}/12ì `;
                commentContent += `\nâ€¢ ì†Œìš”ì‹œê°„: ${timeScore}/3ì `;
                commentContent += `\nâ€¢ ì™„ì„±ë„: ${qualityScore}/3ì `;
                commentContent += `\nâ€¢ ì»¤ë®¤ë‹ˆì¼€ì´ì…˜: ${commScore}/3ì `;
                commentContent += `\nâ€¢ ì „ë¬¸ì„±: ${expertiseScore}/3ì `;
            }
            
            if (feedback) {
                commentContent += `\nì˜ê²¬: ${feedback}`;
            }
            
            ticket.comments.push({
                id: `cmt${Date.now()}`,
                author: currentUser.name,
                content: commentContent,
                createdAt: ticket.userApprovedAt
            });
            
            closeModal('ticketDetailModal');
            
            // í˜„ì¬ ë³´ê³  ìˆëŠ” í™”ë©´ì— ë§ê²Œ ë Œë”ë§
            if (currentRole === 'user') {
                renderUserView();
            } else {
                renderAdminView();
            }
            
            alert(`âœ… ì‘ì—… ê²°ê³¼ê°€ ìµœì¢… í™•ì¸ë˜ì—ˆìŠµë‹ˆë‹¤!\n\ní‹°ì¼“: ${ticket.ticketNumber}\ní™•ì¸ ì‹œê°„: ${ticket.userApprovedAt}\ní™•ì¸ì: ${currentUser.name}\n\nğŸ’° ë³¸ í™•ì¸ì„ ê·¼ê±°ë¡œ ë¹„ìš©ì´ ì§‘í–‰ë©ë‹ˆë‹¤.`);
        }

        // í‰ê°€ ì ìˆ˜ ì„ íƒ í•¨ìˆ˜
        function selectScore(ticketId, category, score) {
            // í•´ë‹¹ ì¹´í…Œê³ ë¦¬ì˜ ëª¨ë“  ë²„íŠ¼ ì´ˆê¸°í™”
            for (let i = 1; i <= 3; i++) {
                const btn = document.getElementById(`score-${category}-${i}-${ticketId}`);
                if (btn) {
                    btn.classList.remove('bg-blue-500', 'text-white', 'border-blue-500');
                    btn.classList.add('border-gray-300');
                }
            }
            
            // ì„ íƒí•œ ë²„íŠ¼ í•˜ì´ë¼ì´íŠ¸
            const selectedBtn = document.getElementById(`score-${category}-${score}-${ticketId}`);
            if (selectedBtn) {
                selectedBtn.classList.remove('border-gray-300');
                selectedBtn.classList.add('bg-blue-500', 'text-white', 'border-blue-500');
            }
            
            // ì ìˆ˜ ì €ì¥
            const input = document.getElementById(`evaluation-${category}-${ticketId}`);
            if (input) {
                input.value = score;
            }
            
            // ì´ì  ê³„ì‚° ë° í‘œì‹œ
            const timeScore = parseInt(document.getElementById(`evaluation-time-${ticketId}`)?.value) || 0;
            const qualityScore = parseInt(document.getElementById(`evaluation-quality-${ticketId}`)?.value) || 0;
            const commScore = parseInt(document.getElementById(`evaluation-communication-${ticketId}`)?.value) || 0;
            const expertiseScore = parseInt(document.getElementById(`evaluation-expertise-${ticketId}`)?.value) || 0;
            const totalScore = timeScore + qualityScore + commScore + expertiseScore;
            
            const totalDisplay = document.getElementById(`total-score-${ticketId}`);
            if (totalDisplay) {
                totalDisplay.textContent = `${totalScore} / 12ì `;
                
                // ì´ì ì— ë”°ë¼ ìƒ‰ìƒ ë³€ê²½
                totalDisplay.classList.remove('text-red-600', 'text-yellow-600', 'text-green-600', 'text-blue-600');
                if (totalScore >= 10) {
                    totalDisplay.classList.add('text-green-600');
                } else if (totalScore >= 7) {
                    totalDisplay.classList.add('text-blue-600');
                } else if (totalScore >= 4) {
                    totalDisplay.classList.add('text-yellow-600');
                } else if (totalScore > 0) {
                    totalDisplay.classList.add('text-red-600');
                }
            }
        }
        
        // ì¬ê²€ìˆ˜ ìš”ì²­ (ê²€ìˆ˜ ëŒ€ê¸°/ì™„ë£Œ â†’ ì²˜ë¦¬ì¤‘)
        function requestRework(ticketId) {
            const ticket = tickets.find(t => t.id === ticketId);
            if (!ticket) return;
            
            // ë§ˆìŠ¤í„°ëŠ” ëª¨ë“  í‹°ì¼“ ì¬ê²€ìˆ˜ ìš”ì²­ ê°€ëŠ¥, ì¼ë°˜ ì‚¬ìš©ìëŠ” ë³¸ì¸ í‹°ì¼“ë§Œ
            if (currentUser.role !== 'master' && ticket.requester !== currentUser.name) {
                alert('â›” ë³¸ì¸ì´ ìš”ì²­í•œ í‹°ì¼“ë§Œ ì¬ê²€ìˆ˜ ìš”ì²­í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
                return;
            }
            
            // ìƒíƒœë³„ ì•ˆë‚´ ë©”ì‹œì§€
            const statusMessage = ticket.status === 'ì™„ë£Œ' 
                ? '\nâš ï¸ ì™„ë£Œëœ í‹°ì¼“ì…ë‹ˆë‹¤. ì¬ê²€ìˆ˜ ìš”ì²­ ì‹œ ì¬ê²€ìˆ˜ì¤‘ ìƒíƒœë¡œ ë³€ê²½ë©ë‹ˆë‹¤.'
                : '\nì¬ì‘ì—…ì´ í•„ìš”í•œ êµ¬ì²´ì ì¸ ì‚¬ìœ ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.';
            
            const reason = prompt(`ğŸ”„ ì¬ê²€ìˆ˜ ìš”ì²­ ì‚¬ìœ  ì…ë ¥${statusMessage}\n\nì‚¬ìœ  (í•„ìˆ˜):`);
            
            // ì…ë ¥ ê²€ì¦ ê°•í™”
            if (reason === null) {
                // ì·¨ì†Œ ë²„íŠ¼ í´ë¦­
                return;
            }
            
            if (!reason.trim()) {
                alert('â›” ì¬ê²€ìˆ˜ ì‚¬ìœ ë¥¼ ë°˜ë“œì‹œ ì…ë ¥í•´ì£¼ì„¸ìš”.\n\nì¬ê²€ìˆ˜ ì‚¬ìœ ëŠ” ì‘ì—… ì´ë ¥ ë° ë¹„ìš© ì‚°ì •ì˜ ê·¼ê±°ë¡œ í™œìš©ë©ë‹ˆë‹¤.');
                return;
            }
            
            if (reason.trim().length < 5) {
                alert('â›” ì¬ê²€ìˆ˜ ì‚¬ìœ ë¥¼ 5ì ì´ìƒ êµ¬ì²´ì ìœ¼ë¡œ ì…ë ¥í•´ì£¼ì„¸ìš”.\n\nì˜ˆì‹œ:\n- ë¡œê·¸ì¸ ì‹œ ì—¬ì „íˆ ì˜¤ë¥˜ ë°œìƒ\n- ì†ë„ê°€ ê°œì„ ë˜ì§€ ì•ŠìŒ\n- ì¶”ê°€ ê¸°ëŠ¥ í•„ìš”');
                return;
            }
            
            // ì™„ë£Œ ìƒíƒœì—ì„œ ì¬ê²€ìˆ˜ ìš”ì²­ ì‹œ ì¶”ê°€ í™•ì¸
            if (ticket.status === 'ì™„ë£Œ') {
                const confirmRework = confirm(
                    `âš ï¸ ì™„ë£Œ í‹°ì¼“ ì¬ê²€ìˆ˜ í™•ì¸\n\n` +
                    `í‹°ì¼“: ${ticket.ticketNumber}\n` +
                    `ë§Œì¡±ë„: ${'â­'.repeat(ticket.satisfactionRating || 0)}\n` +
                    `ì™„ë£Œ ì‹œê°„: ${ticket.userApprovedAt}\n\n` +
                    `ì¬ê²€ìˆ˜ ì‚¬ìœ : ${reason.trim()}\n\n` +
                    `ì •ë§ë¡œ ì¬ê²€ìˆ˜ë¥¼ ìš”ì²­í•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n` +
                    `(í‹°ì¼“ì´ ì¬ê²€ìˆ˜ì¤‘ ìƒíƒœë¡œ ë³€ê²½ë©ë‹ˆë‹¤)`
                );
                
                if (!confirmRework) {
                    return;
                }
            }
            
            const previousStatus = ticket.status;
            ticket.status = 'ì¬ê²€ìˆ˜ì¤‘';  // ì²˜ë¦¬ì¤‘ ëŒ€ì‹  ì¬ê²€ìˆ˜ì¤‘ìœ¼ë¡œ ë³€ê²½
            
            const commentPrefix = previousStatus === 'ì™„ë£Œ' 
                ? '[ì™„ë£Œ í›„ ì¬ê²€ìˆ˜ ìš”ì²­]' 
                : '[ì¬ê²€ìˆ˜ ìš”ì²­]';
            
            ticket.comments.push({
                id: `cmt${Date.now()}`,
                author: currentUser.name,
                content: `${commentPrefix} ${reason.trim()}`,
                createdAt: new Date().toLocaleString('ko-KR', {
                    year: 'numeric',
                    month: '2-digit',
                    day: '2-digit',
                    hour: '2-digit',
                    minute: '2-digit'
                })
            });
            
            closeModal('ticketDetailModal');
            
            // í˜„ì¬ ë³´ê³  ìˆëŠ” í™”ë©´ì— ë§ê²Œ ë Œë”ë§
            if (currentRole === 'user') {
                renderUserView();
            } else {
                renderAdminView();
            }
            
            const successMessage = previousStatus === 'ì™„ë£Œ'
                ? `âœ… ì™„ë£Œ í‹°ì¼“ì— ëŒ€í•œ ì¬ê²€ìˆ˜ê°€ ìš”ì²­ë˜ì—ˆìŠµë‹ˆë‹¤.\n\ní‹°ì¼“: ${ticket.ticketNumber}\nì´ì „ ìƒíƒœ: ì™„ë£Œ â†’ ì¬ê²€ìˆ˜ì¤‘\n\në‹´ë‹¹ìê°€ ì¬ì‘ì—…ì„ ì§„í–‰í•©ë‹ˆë‹¤.`
                : `âœ… ì¬ê²€ìˆ˜ê°€ ìš”ì²­ë˜ì—ˆìŠµë‹ˆë‹¤.\n\ní‹°ì¼“: ${ticket.ticketNumber}\nìƒíƒœ: ${previousStatus} â†’ ì¬ê²€ìˆ˜ì¤‘`;
            
            alert(successMessage);
        }

        // ì™„ë£Œ ì½”ë©˜íŠ¸ ëª¨ë‹¬ ì—´ê¸°
        let currentCompletionTicketId = null;
        
        function openCompletionModal(ticketId) {
            currentCompletionTicketId = ticketId;
            const ticket = tickets.find(t => t.id === ticketId);
            if (!ticket) return;
            
            document.getElementById('completionTicketNumber').textContent = ticket.ticketNumber;
            document.getElementById('completionTicketTitle').textContent = ticket.title;
            document.getElementById('completionComment').value = '';
            document.getElementById('completionLinks').value = '';
            
            closeModal('ticketDetailModal');
            openModal('completionModal');
        }
        
        function saveCompletion() {
            if (!currentCompletionTicketId) return;
            
            const ticket = tickets.find(t => t.id === currentCompletionTicketId);
            if (!ticket) return;
            
            const comment = document.getElementById('completionComment').value.trim();
            const links = document.getElementById('completionLinks').value.trim();
            
            if (!comment) {
                alert('ì™„ë£Œ ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            // í‹°ì¼“ ìƒíƒœë¥¼ ê²€ìˆ˜ ëŒ€ê¸°ë¡œ ë³€ê²½
            ticket.status = 'ê²€ìˆ˜ ëŒ€ê¸°';
            ticket.completionComment = comment;
            ticket.completionLinks = links ? links.split('\n').filter(l => l.trim()) : [];
            ticket.completedBy = currentUser.name;
            ticket.completedAt = new Date().toLocaleString('ko-KR', {
                year: 'numeric',
                month: '2-digit',
                day: '2-digit',
                hour: '2-digit',
                minute: '2-digit'
            });
            
            closeModal('completionModal');
            renderAdminView();
            
            alert(`âœ… ì‘ì—…ì´ ì™„ë£Œë˜ì–´ ì‚¬ìš©ì ê²€ìˆ˜ ìš”ì²­ë˜ì—ˆìŠµë‹ˆë‹¤.\ní‹°ì¼“: ${ticket.ticketNumber}`);
        }

        // Initialize on page load
        // ==========================================
        // ğŸ†• ê²Œì‹œíŒ í•¨ìˆ˜ë“¤
        // ==========================================
        
        function openUserBoardView() {
            document.getElementById('user-board-section').style.display = 'block';
            document.querySelectorAll('.grid.grid-cols-4').forEach(el => el.style.display = 'none');
            document.getElementById('active-requests-section').style.display = 'none';
            document.querySelector('.bg-white.rounded-xl.shadow-sm.border.overflow-hidden').style.display = 'none';
            renderUserBoard();
        }
        
        function renderUserBoard() {
            const container = document.getElementById('user-board-content');
            container.innerHTML = `
                <div class="mb-6 flex items-center justify-between">
                    <h2 class="text-2xl font-bold text-gray-800">
                        <i class="fas fa-clipboard-list text-teal-500 mr-2"></i>ê²Œì‹œíŒ
                    </h2>
                    <button onclick="closeUserBoard()" class="px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition">
                        <i class="fas fa-arrow-left mr-2"></i>ëŒì•„ê°€ê¸°
                    </button>
                </div>
                ${renderBoardList(false)}
            `;
        }
        
        function closeUserBoard() {
            document.getElementById('user-board-section').style.display = 'none';
            document.querySelectorAll('.grid.grid-cols-4').forEach(el => el.style.display = 'grid');
            document.getElementById('active-requests-section').style.display = 'block';
            document.querySelector('.bg-white.rounded-xl.shadow-sm.border.overflow-hidden').style.display = 'block';
        }
        
        function renderAdminBoard() {
            const container = document.getElementById('board-content');
            container.innerHTML = renderBoardList(true);
        }
        
        function renderBoardList(isAdmin) {
            const categories = ['ì˜¤ì•„ì‹œìŠ¤', 'GMS', 'ë¶€ë™ì‚°', 'ì¸í”„ë¼', 'ERP', 'HR', 'ê¸°íƒ€'];
            let html = isAdmin ? `
                <div class="mb-6 flex justify-end">
                    <button onclick="openModal('boardCreateModal')" class="px-6 py-3 bg-teal-600 text-white rounded-lg hover:bg-teal-700 transition font-semibold">
                        <i class="fas fa-plus mr-2"></i>ê²Œì‹œê¸€ ë“±ë¡
                    </button>
                </div>` : '';
            
            html += '<div class="space-y-6">';
            categories.forEach(category => {
                const categoryPosts = boardPosts.filter(p => p.mainCategory === category);
                if (categoryPosts.length > 0) {
                    html += `
                        <div class="bg-white rounded-xl shadow-sm border overflow-hidden">
                            <div class="bg-gradient-to-r from-teal-50 to-teal-100 px-6 py-4 border-b">
                                <h3 class="text-lg font-bold text-teal-900">
                                    <i class="fas fa-folder text-teal-600 mr-2"></i>${category}
                                </h3>
                            </div>
                            <div class="overflow-x-auto">
                                <table class="w-full">
                                    <thead class="bg-gray-50 border-b">
                                        <tr>
                                            <th class="px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase">êµ¬ë¶„</th>
                                            <th class="px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase">ì œëª©</th>
                                            <th class="px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase">ë“±ë¡ì¼</th>
                                            <th class="px-6 py-3 text-center text-xs font-semibold text-gray-600 uppercase">ì¡°íšŒìˆ˜</th>
                                            <th class="px-6 py-3 text-center text-xs font-semibold text-gray-600 uppercase">ì•¡ì…˜</th>
                                        </tr>
                                    </thead>
                                    <tbody class="divide-y divide-gray-200">`;
                    
                    categoryPosts.forEach(post => {
                        html += `
                            <tr class="hover:bg-gray-50 transition">
                                <td class="px-6 py-4">
                                    <span class="px-3 py-1 text-xs font-semibold rounded-full ${post.type === 'ë§¤ë‰´ì–¼' ? 'bg-blue-100 text-blue-700' : 'bg-green-100 text-green-700'}">
                                        ${post.type}
                                    </span>
                                </td>
                                <td class="px-6 py-4">
                                    <div class="font-semibold text-gray-800">${post.title}</div>
                                    ${post.files.length > 0 ? `<div class="text-xs text-gray-500 mt-1"><i class="fas fa-paperclip mr-1"></i>${post.files.length}ê°œ íŒŒì¼</div>` : ''}
                                </td>
                                <td class="px-6 py-4 text-sm text-gray-600">${post.createdAt}</td>
                                <td class="px-6 py-4 text-center text-sm text-gray-600">
                                    <i class="fas fa-eye text-gray-400 mr-1"></i>${post.views}
                                </td>
                                <td class="px-6 py-4 text-center">
                                    <button onclick="viewBoardPost(${post.id})" class="px-3 py-1 text-sm bg-teal-100 text-teal-700 rounded hover:bg-teal-200 transition mr-2">
                                        <i class="fas fa-eye mr-1"></i>ìì„¸íˆ
                                    </button>
                                    ${post.files.length > 0 ? `
                                    <button onclick="downloadAllFiles(${post.id})" class="px-3 py-1 text-sm bg-blue-100 text-blue-700 rounded hover:bg-blue-200 transition">
                                        <i class="fas fa-download mr-1"></i>ë‹¤ìš´ë¡œë“œ
                                    </button>` : ''}
                                    ${isAdmin ? `
                                    <button onclick="deleteBoardPost(${post.id})" class="px-3 py-1 text-sm bg-red-100 text-red-700 rounded hover:bg-red-200 transition ml-2">
                                        <i class="fas fa-trash mr-1"></i>ì‚­ì œ
                                    </button>` : ''}
                                </td>
                            </tr>`;
                    });
                    html += '</tbody></table></div></div>';
                }
            });
            html += '</div>';
            
            if (boardPosts.length === 0) {
                html = `
                    <div class="bg-white rounded-xl shadow-sm border p-12 text-center">
                        <i class="fas fa-clipboard-list text-gray-300 text-6xl mb-4"></i>
                        <p class="text-gray-500 text-lg">ë“±ë¡ëœ ê²Œì‹œê¸€ì´ ì—†ìŠµë‹ˆë‹¤</p>
                        ${isAdmin ? '<p class="text-gray-400 text-sm mt-2">ìƒë‹¨ì˜ [ê²Œì‹œê¸€ ë“±ë¡] ë²„íŠ¼ì„ í´ë¦­í•˜ì—¬ ì²« ê²Œì‹œê¸€ì„ ë“±ë¡í•˜ì„¸ìš”</p>' : ''}
                    </div>`;
            }
            return html;
        }
        
        function viewBoardPost(postId) {
            const post = boardPosts.find(p => p.id === postId);
            if (!post) return;
            post.views++;
            
            const html = `
                <div class="space-y-6">
                    <div class="border-b pb-4">
                        <div class="flex items-center justify-between mb-2">
                            <span class="px-3 py-1 text-sm font-semibold rounded-full ${post.type === 'ë§¤ë‰´ì–¼' ? 'bg-blue-100 text-blue-700' : 'bg-green-100 text-green-700'}">
                                ${post.type}
                            </span>
                            <span class="text-sm text-gray-500">
                                <i class="fas fa-folder text-teal-600 mr-1"></i>${post.mainCategory}
                            </span>
                        </div>
                        <h2 class="text-2xl font-bold text-gray-800 mb-3">${post.title}</h2>
                        <div class="flex items-center text-sm text-gray-600 space-x-4">
                            <span><i class="fas fa-calendar mr-1"></i>${post.createdAt}</span>
                            <span><i class="fas fa-eye mr-1"></i>${post.views} ì¡°íšŒ</span>
                        </div>
                    </div>
                    <div class="prose max-w-none">
                        <div class="text-gray-700 whitespace-pre-wrap">${post.content}</div>
                    </div>
                    ${post.url ? `
                    <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                        <div class="text-sm font-semibold text-blue-800 mb-2">
                            <i class="fas fa-link mr-2"></i>ê´€ë ¨ ë§í¬
                        </div>
                        <a href="${post.url}" target="_blank" class="text-blue-600 hover:text-blue-800 underline break-all">
                            ${post.url}
                        </a>
                    </div>` : ''}
                    ${post.files.length > 0 ? `
                    <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                        <div class="text-sm font-semibold text-gray-800 mb-3">
                            <i class="fas fa-paperclip mr-2"></i>ì²¨ë¶€íŒŒì¼ (${post.files.length}ê°œ)
                        </div>
                        <div class="space-y-2">
                            ${post.files.map((file, index) => `
                                <div class="flex items-center justify-between p-3 bg-white border rounded-lg hover:bg-gray-50 transition">
                                    <div class="flex items-center space-x-3">
                                        <i class="fas fa-file text-teal-600"></i>
                                        <span class="text-sm text-gray-700">${file}</span>
                                    </div>
                                    <button onclick="downloadFile(${postId}, ${index})" class="px-3 py-1 text-sm bg-teal-600 text-white rounded hover:bg-teal-700 transition">
                                        <i class="fas fa-download mr-1"></i>ë‹¤ìš´ë¡œë“œ
                                    </button>
                                </div>
                            `).join('')}
                        </div>
                        <div class="mt-3 pt-3 border-t">
                            <button onclick="downloadAllFiles(${postId})" class="w-full px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition font-semibold">
                                <i class="fas fa-download mr-2"></i>ì „ì²´ íŒŒì¼ ë‹¤ìš´ë¡œë“œ
                            </button>
                        </div>
                    </div>` : ''}
                </div>
            `;
            
            document.getElementById('board-detail-content').innerHTML = html;
            openModal('boardDetailModal');
            
            if (currentRole === 'admin' || currentRole === 'master') renderAdminBoard();
            else renderUserBoard();
        }
        
        function submitBoardPost(event) {
            event.preventDefault();
            
            const fileInput = document.getElementById('board-files');
            const files = [];
            for (let i = 0; i < fileInput.files.length && i < 5; i++) {
                files.push(fileInput.files[i].name);
            }
            
            const post = {
                id: boardPostIdCounter++,
                mainCategory: document.getElementById('board-main-category').value,
                type: document.querySelector('input[name="boardType"]:checked').value,
                title: document.getElementById('board-title').value.trim(),
                content: document.getElementById('board-content').value.trim(),
                url: document.getElementById('board-url').value.trim(),
                files: files,
                views: 0,
                createdAt: new Date().toLocaleString('ko-KR'),
                createdBy: currentUser.name
            };
            
            boardPosts.unshift(post);
            closeModal('boardCreateModal');
            document.getElementById('boardCreateForm').reset();
            alert('âœ… ê²Œì‹œê¸€ì´ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤!');
            renderAdminBoard();
        }
        
        function deleteBoardPost(postId) {
            if (!confirm('ì •ë§ ì´ ê²Œì‹œê¸€ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;
            const index = boardPosts.findIndex(p => p.id === postId);
            if (index !== -1) {
                boardPosts.splice(index, 1);
                alert('âœ… ê²Œì‹œê¸€ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
                renderAdminBoard();
            }
        }
        
        function downloadFile(postId, fileIndex) {
            const post = boardPosts.find(p => p.id === postId);
            if (!post) return;
            alert(`ğŸ“¥ "${post.files[fileIndex]}" ë‹¤ìš´ë¡œë“œë¥¼ ì‹œì‘í•©ë‹ˆë‹¤.`);
        }
        
        function downloadAllFiles(postId) {
            const post = boardPosts.find(p => p.id === postId);
            if (!post) return;
            alert(`ğŸ“¥ ${post.files.length}ê°œ íŒŒì¼ ë‹¤ìš´ë¡œë“œë¥¼ ì‹œì‘í•©ë‹ˆë‹¤.`);
        }
        
        window.addEventListener('DOMContentLoaded', function() {
            console.log('âœ… í˜ì´ì§€ ë¡œë“œ ì™„ë£Œ');
            
            // ë¡œê·¸ì¸ í¼ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë“±ë¡
            const loginForm = document.getElementById('loginForm');
            if (loginForm) {
                loginForm.addEventListener('submit', handleLogin);
                console.log('âœ… ë¡œê·¸ì¸ í¼ ì´ë²¤íŠ¸ ë“±ë¡ ì™„ë£Œ');
            } else {
                console.error('âŒ ë¡œê·¸ì¸ í¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤!');
            }
            
            // ë°ëª¨ ë°ì´í„° ì´ˆê¸°í™”
            initializeDemoData();
            console.log('âœ… ë°ëª¨ ë°ì´í„° ì´ˆê¸°í™” ì™„ë£Œ');
            console.log('âœ… ê³„ì • ì •ë³´:', demoAccounts);
            
            // ê²Œì‹œíŒ ë°ëª¨ ë°ì´í„° ğŸ†•
            boardPosts = [
                {
                    id: boardPostIdCounter++,
                    mainCategory: 'ì˜¤ì•„ì‹œìŠ¤',
                    type: 'ë§¤ë‰´ì–¼',
                    title: 'ì˜¤ì•„ì‹œìŠ¤ ì‹œìŠ¤í…œ ì‚¬ìš©ì ë§¤ë‰´ì–¼',
                    content: 'ì˜¤ì•„ì‹œìŠ¤ ì‹œìŠ¤í…œì˜ ê¸°ë³¸ ì‚¬ìš© ë°©ë²•ì„ ì•ˆë‚´í•©ë‹ˆë‹¤.\n\n1. ë¡œê·¸ì¸ ë°©ë²•\n2. ì£¼ìš” ê¸°ëŠ¥ ì†Œê°œ\n3. ë¬¸ì œ í•´ê²° ê°€ì´ë“œ',
                    url: 'https://docs.oasis.com/manual',
                    files: ['ì˜¤ì•„ì‹œìŠ¤_ë§¤ë‰´ì–¼_v1.0.pdf', 'ë¹ ë¥¸ì‹œì‘_ê°€ì´ë“œ.pdf'],
                    views: 45,
                    createdAt: '2024-11-15 09:00:00',
                    createdBy: 'IT ë§ˆìŠ¤í„°'
                },
                {
                    id: boardPostIdCounter++,
                    mainCategory: 'GMS',
                    type: 'íŒŒì¼',
                    title: 'GMS í´ë¼ì´ì–¸íŠ¸ ì„¤ì¹˜ íŒŒì¼',
                    content: 'GMS í´ë¼ì´ì–¸íŠ¸ ìµœì‹  ë²„ì „(v3.2.1) ì„¤ì¹˜ íŒŒì¼ì…ë‹ˆë‹¤.\n\nì„¤ì¹˜ ìš”êµ¬ì‚¬í•­:\n- Windows 10 ì´ìƒ\n- .NET Framework 4.8',
                    url: '',
                    files: ['GMS_Client_v3.2.1.exe', 'GMS_ì„¤ì¹˜ê°€ì´ë“œ.pdf'],
                    views: 123,
                    createdAt: '2024-11-20 14:30:00',
                    createdBy: 'IT ë§ˆìŠ¤í„°'
                },
                {
                    id: boardPostIdCounter++,
                    mainCategory: 'ì¸í”„ë¼',
                    type: 'ë§¤ë‰´ì–¼',
                    title: 'VPN ì ‘ì† ê°€ì´ë“œ',
                    content: 'ì¬íƒê·¼ë¬´ ì‹œ VPN ì ‘ì† ë°©ë²•ì„ ì•ˆë‚´í•©ë‹ˆë‹¤.\n\n- ì ‘ì† ì£¼ì†Œ: vpn.company.com\n- ì¸ì¦ì„œ ì„¤ì¹˜ í•„ìˆ˜\n- ë¬¸ì˜: ITíŒ€ ë‚´ì„  1234',
                    url: 'https://vpn.company.com/guide',
                    files: ['VPN_ì ‘ì†ê°€ì´ë“œ.pdf', 'VPN_ì¸ì¦ì„œ.crt'],
                    views: 89,
                    createdAt: '2024-12-01 10:15:00',
                    createdBy: 'IT ë§ˆìŠ¤í„°'
                },
                {
                    id: boardPostIdCounter++,
                    mainCategory: 'ERP',
                    type: 'ë§¤ë‰´ì–¼',
                    title: 'ERP ê²°ì¬ í”„ë¡œì„¸ìŠ¤ ë§¤ë‰´ì–¼',
                    content: 'ERP ì‹œìŠ¤í…œì˜ ì „ìê²°ì¬ í”„ë¡œì„¸ìŠ¤ë¥¼ ì„¤ëª…í•©ë‹ˆë‹¤.\n\n1. ê²°ì¬ ìš”ì²­\n2. ê²°ì¬ì„  ì§€ì •\n3. ê²°ì¬ ìŠ¹ì¸/ë°˜ë ¤',
                    url: '',
                    files: ['ERP_ê²°ì¬_ë§¤ë‰´ì–¼.pdf'],
                    views: 67,
                    createdAt: '2024-12-05 11:00:00',
                    createdBy: 'IT ë§ˆìŠ¤í„°'
                },
                {
                    id: boardPostIdCounter++,
                    mainCategory: 'HR',
                    type: 'íŒŒì¼',
                    title: 'HR ì‹œìŠ¤í…œ ì—…ë°ì´íŠ¸ íŒŒì¼',
                    content: 'HR ì‹œìŠ¤í…œ 12ì›” ì •ê¸° ì—…ë°ì´íŠ¸ íŒŒì¼ì…ë‹ˆë‹¤.\n\nì£¼ìš” ë³€ê²½ì‚¬í•­:\n- ì—°ì°¨ ê´€ë¦¬ ê¸°ëŠ¥ ê°œì„ \n- UI ê°œì„ \n- ë²„ê·¸ ìˆ˜ì •',
                    url: '',
                    files: ['HR_Update_Dec2024.zip', 'ì—…ë°ì´íŠ¸_ê°€ì´ë“œ.pdf'],
                    views: 34,
                    createdAt: '2024-12-10 16:00:00',
                    createdBy: 'IT ë§ˆìŠ¤í„°'
                }
            ];
            console.log('âœ… ê²Œì‹œíŒ ë°ëª¨ ë°ì´í„° ì´ˆê¸°í™” ì™„ë£Œ');
        });
    </script>
</body>
</html>
